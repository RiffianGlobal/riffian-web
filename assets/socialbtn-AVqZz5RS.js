import{T as g,b as p,a as w}from"./index-3ABFJoPQ.js";import{w as y,a as x}from"./dialog-77DgYyuD.js";import{a as f,e as u,V as $,x as l,n as d,q as j,G as k,h,d as L,c as b}from"./vendor-oB3DPz4D.js";import"./icon-BZ04ptiP.js";const V="li.header{margin-bottom:.5rem;--tw-text-opacity: 1;color:#a3a3a3;color:rgba(163,163,163,var(--tw-text-opacity));border-bottom:1px solid rgba(255,255,255,.12)}li.item:hover{background-color:#ffffff0d}@media (min-width: 500px){.name{font-size:1rem;line-height:1.5rem}}.icon{font-size:1.25rem;line-height:1.75rem}@media (max-width: 500px){.icon{font-size:1.5rem;line-height:2rem}}";var T=Object.defineProperty,_=Object.getOwnPropertyDescriptor,r=(e,t,s,o)=>{for(var i=o>1?void 0:o?_(t,s):t,n=e.length-1,c;n>=0;n--)(c=e[n])&&(i=(o?c(t,s,i):c(i))||i);return o&&i&&T(t,s,i),i};let a=class extends g(V){constructor(){super(...arguments),this.bindBridge=new f(this,p),this.weekly=!1,this.showAlbumVote=!1,this.albumToVote={id:"",supply:0,url:"",name:"",creator:{address:""},uri:"",image:""},this.pending=!1,this.prompt=!1,this.promptMessage="",this.fetch=async()=>{this.pending=!0;try{let s=this.weekly?await y(10,await w()):await x(10);this.subjectList=this.weekly?s.subjectWeeklyVotes:s.subjects}catch(s){console.error(s),this.promptMessage=s,this.prompt=!0;return}this.pending=!1;let e=["https://cdn.shopify.com/app-store/listing_images/a82167e02b45cadf681efc6c17c35f3a/icon/CMmMjb30lu8CEAE=.jpg"];for(var t=0;t<this.subjectList.length;t++){if(this.weekly){let s=this.subjectList[t];this.subjectList[t]=s.subject,this.subjectList[t].volumeTotal=s.volumeTotal}(!this.subjectList[t].image||!this.subjectList[t].image.startsWith("http"))&&(this.subjectList[t].image=e[0])}},this.close=()=>{this.showAlbumVote=!1,this.fetch()},this.go2=e=>{this.disabled?u.emit("connect-wallet"):(this.albumToVote=e,$(`/track/${e.id}`))}}get disabled(){return!p.bridge.account}async connectedCallback(){super.connectedCallback(),await this.fetch(),u.on("toplist-fetch",this.fetch)}getRandomInt(e){return Math.floor(Math.random()*e)}static dayChange(e){if(e.voteLogs.length==0)return"New";{let t=e.voteLogs[0].supply,s=e.supply,o=Math.abs(t-s),i=(o*100/t).toFixed(1);return t>s?l`<p class="text-red-500">-${i}%</p>`:l`<p class="text-green-500">+${i}%</p>`}}render(){return l`<div>${d(this.pending&&!this.subjectList,()=>l`<div name="Loading" class="doc-intro"><div class="flex flex-col gap-8 m-8"><loading-skeleton num="3"></loading-skeleton><loading-skeleton num="3"></loading-skeleton><loading-skeleton num="3"></loading-skeleton></div></div>`)} ${d(this.subjectList,()=>l`<ul role="list" class="ui-list hover gap-2"><li class="flex header"><div class="w-10">Rank</div><div class="flex-shrink">Collection</div><div class="flex-auto"></div><div class="num flex-auto w-32">${this.weekly?"Volume":l`Price`}</div></li>${j(this.subjectList,(e,t)=>l`<li class="item flex items-center"><div class="flex-none w-10 pl-2 text-sm font-light opacity-70">${t+1}</div><div class="flex-shrink"><img-loader @click="${()=>this.go2(e)}" .src="${e.image}" class="w-[3.75rem] h-[3.75rem] rounded-lg cursor-pointer"></img-loader></div><div class="flex-auto truncate"><p class="name truncate cursor-pointer" @click="${()=>this.go2(e)}">${e.name}</p><span class="icon mt-1"><i class="mdi mdi-play-circle-outline"></i></span></div><div class="num flex-initial flex flex-col !w-18 text-sm items-end"><span>${this.weekly?k(e.volumeTotal,18):(Number(e.supply)+1)/10}</span> <span class="text-xs" style="color:#34c77b">${a.dayChange(e)}</span></div></li>`)}</ul>${d(this.showAlbumVote,()=>l`<vote-album-dialog album="${this.albumToVote.id}" url="${this.albumToVote.image}" name="${this.albumToVote.name}" votes="${this.albumToVote.supply}" author="${this.albumToVote.creator.address}" @close="${this.close}"></vote-album-dialog>`)}`)}</div>${d(this.prompt,()=>l`<p class="text-center text-orange-600">${this.promptMessage}</p>`)}`}};r([L({type:Boolean})],a.prototype,"weekly",2);r([h()],a.prototype,"subjectList",2);r([h()],a.prototype,"showAlbumVote",2);r([h()],a.prototype,"albumToVote",2);r([h()],a.prototype,"pending",2);r([h()],a.prototype,"prompt",2);r([h()],a.prototype,"promptMessage",2);a=r([b("top-album")],a);var C=Object.defineProperty,M=Object.getOwnPropertyDescriptor,v=(e,t,s,o)=>{for(var i=o>1?void 0:o?M(t,s):t,n=e.length-1,c;n>=0;n--)(c=e[n])&&(i=(o?c(t,s,i):c(i))||i);return o&&i&&C(t,s,i),i};let m=class extends g(""){constructor(){super(...arguments),this.bindBridge=new f(this,p),this.dialog=!1,this.open=()=>{this.disabled?u.emit("connect-wallet"):this.dialog=!0},this.close=()=>this.dialog=!1}get disabled(){return!p.bridge.account}render(){return l`<ui-button icon @click="${this.open}" title="Bind Social"><i class="i mdi mdi-twitter"></i></ui-button>${d(this.dialog,()=>l`<create-social-dialog @close="${this.close}"></create-social-dialog>`)}`}};v([h()],m.prototype,"dialog",2);m=v([b("bind-social-btn")],m);
