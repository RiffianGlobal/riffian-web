import{T as w,b as c,w as x}from"./index-4Y4c3ejC.js";import{w as j,a as _}from"./dialog-LgBw_VA5.js";import{_ as L,$ as k,c as d,e as h,a0 as M,x as o,d as C,n as g,q as P,K as V,h as p,a as O,b as T}from"./vendor-aecOC4Ab.js";import"./icon-C9bbqVue.js";const y=[{ext:"gif",mediaType:"image",mimeType:"image/gif"},{ext:"jpg",mediaType:"image",mimeType:"image/jpeg"},{ext:"jpeg",mediaType:"image",mimeType:"image/jpeg"},{ext:"png",mediaType:"image",mimeType:"image/png"},{ext:"svg",mediaType:"image",mimeType:"image/svg+xml"},{ext:"webp",mediaType:"image",mimeType:"image/webp"}],A=y.map(e=>e.ext);y.map(e=>e.mimeType);const f=[{ext:"mp4",mediaType:"video",mimeType:"video/mp4"},{ext:"webm",mediaType:"video",mimeType:"video/webm"}];f.map(e=>e.ext);f.map(e=>e.mimeType);const b=[{ext:"gltf",mediaType:"threed",mimeType:"model/gltf-binary"},{ext:"glb",mediaType:"threed",mimeType:"model/gltf-binary"}];b.map(e=>e.ext);b.map(e=>e.mimeType);const v=[{ext:"mp3",mediaType:"audio",mimeType:"audio/mpeg"},{ext:"ogg",mediaType:"audio",mimeType:"audio/ogg"},{ext:"wav",mediaType:"audio",mimeType:"audio/wav"}];v.map(e=>e.ext);v.map(e=>e.mimeType);const B=[...y,...f,...v,...b],E=(e="")=>A.includes(L(e))||S(k(e))==="image",S=e=>{var t;return(t=B.find(i=>i.mimeType===e))==null?void 0:t.mediaType},D="@media (min-width: 500px){.name{font-size:1rem;line-height:1.5rem}}.icon{font-size:1.25rem;line-height:1.75rem}@media (max-width: 500px){.icon{font-size:1.5rem;line-height:2rem}}";var I=Object.defineProperty,z=Object.getOwnPropertyDescriptor,m=(e,t,i,a)=>{for(var s=a>1?void 0:a?z(t,i):t,r=e.length-1,n;r>=0;r--)(n=e[r])&&(s=(a?n(t,i,s):n(s))||s);return a&&s&&I(t,i,s),s};let l=class extends w(D){constructor(){super(...arguments),this.bindBridge=new d(this,c),this.bindWeekly=new d(this,x),this.weekly=!1,this.showAlbumVote=!1,this.albumToVote={id:"",supply:0,url:"",name:"",creator:{address:""},uri:"",image:""},this.pending=!1,this.prompt=!1,this.promptMessage="",this.fetch=async()=>{this.pending=!0;try{let i=this.weekly?await j(10,await x.getLatest()):await _(10);this.subjectList=this.weekly?i.subjectWeeklyVotes:i.subjects}catch(i){console.error(i),this.promptMessage=i,this.prompt=!0;return}finally{this.pending=!1}let e=["https://cdn.shopify.com/app-store/listing_images/a82167e02b45cadf681efc6c17c35f3a/icon/CMmMjb30lu8CEAE=.jpg"];for(var t=0;t<this.subjectList.length;t++){if(this.weekly){let i=this.subjectList[t];this.subjectList[t]=i.subject,this.subjectList[t].volumeTotal=i.volumeTotal}(!this.subjectList[t].image||!E(this.subjectList[t].image)&&!this.subjectList[t].image.startsWith("http"))&&(this.subjectList[t].image=e[0])}},this.close=()=>{this.showAlbumVote=!1,this.fetch()},this.go2=e=>{this.disabled?h.emit("connect-wallet"):(this.albumToVote=e,M(`/track/${e.id}`))}}get disabled(){return!c.bridge.account}async connectedCallback(){super.connectedCallback(),await this.fetch(),h.on("toplist-fetch",this.fetch)}getRandomInt(e){return Math.floor(Math.random()*e)}static dayChange(e){if(e.voteLogs.length==0)return"New";{let t=e.voteLogs[0].supply,i=e.supply,a=Math.abs(t-i),s=(a*100/t).toFixed(1);return t>i?o`<p class="text-red-500">-${s}%</p>`:o`<p class="text-green-500">+${s}%</p>`}}render(){return o`<div role="list" class="ui-list gap-2 ${C(this.$c([this.pending?"loading":"hover"]))}"><div class="flex header border-bottom"><div class="w-8 md_w-10">Rank</div><div class="flex-shrink">Collection</div><div class="flex-auto"></div><div class="num flex-auto w-32">${this.weekly?"Volume":o`Price`}</div></div>${g(this.pending&&!this.subjectList,()=>o`<div name="loading" class="doc-intro"></div><loading-skeleton num="4"></loading-skeleton>`,()=>o`${P(this.subjectList,(e,t)=>o`<div class="item flex items-center"><div class="flex-none w-8 md_pl-3 text-sm font-light opacity-70">${t+1}</div><div class="flex-shrink"><img-loader @click="${()=>this.go2(e)}" .src="${e.image}" class="w-[3rem] h-[3rem] md_w-[3.75rem] md_h-[3.75rem] rounded-lg cursor-pointer"></img-loader></div><div class="flex-auto truncate"><p class="name truncate cursor-pointer" @click="${()=>this.go2(e)}">${e.name}</p><a href="${e.uri}" target="_blank"><span class="icon mt-1"><i class="mdi mdi-play-circle-outline"></i></span></a></div><div class="num flex-initial flex flex-col !w-18 text-sm items-end"><span>${this.weekly?V(e.volumeTotal,18):(Number(e.supply)+1)/10}</span> <span class="text-xs" style="color:#34c77b">${l.dayChange(e)}</span></div></div>`)}`)}</div>${g(this.prompt,()=>o`<p class="text-center text-orange-600">${this.promptMessage}</p>`)}`}};m([O({type:Boolean})],l.prototype,"weekly",2);m([p()],l.prototype,"subjectList",2);m([p()],l.prototype,"showAlbumVote",2);m([p()],l.prototype,"albumToVote",2);m([p()],l.prototype,"pending",2);m([p()],l.prototype,"prompt",2);m([p()],l.prototype,"promptMessage",2);l=m([T("top-album")],l);var N=Object.defineProperty,R=Object.getOwnPropertyDescriptor,$=(e,t,i,a)=>{for(var s=a>1?void 0:a?R(t,i):t,r=e.length-1,n;r>=0;r--)(n=e[r])&&(s=(a?n(t,i,s):n(s))||s);return a&&s&&N(t,i,s),s};let u=class extends w(""){constructor(){super(...arguments),this.bindBridge=new d(this,c),this.dialog=!1,this.open=()=>{this.disabled?h.emit("connect-wallet"):this.dialog=!0},this.close=()=>this.dialog=!1}get disabled(){return!c.bridge.account}render(){return o`<ui-button icon @click="${this.open}" title="Bind Social"><i class="i mdi mdi-twitter"></i></ui-button>${g(this.dialog,()=>o`<create-social-dialog @close="${this.close}"></create-social-dialog>`)}`}};$([p()],u.prototype,"dialog",2);u=$([T("bind-social-btn")],u);
