import{g as m,T as p}from"./index-sZWoJgnr.js";import"./socialbtn-vvlZUwsE.js";import{h as f,g as x}from"./claim-b2AVud_-.js";import{x as o,n as c,q as w,G as y,h as v,d as b,c as h,a as _,u as g,M as $}from"./vendor-sWZXFYo9.js";import"./dialog-DDtyrpgl.js";const S=async s=>{let l=`{
      voteLogs(first: ${s}, orderBy: time, orderDirection:desc) {
        id
        voter{
          address
        }
        time
        value
      }
    }`;return await m("MediaBoard",l)},V=".text-highlight{color:var(--colorHighlight)}svg{display:inline-flex;align-items:center;overflow:hidden;border-radius:9999px;background:#c81444}svg svg{height:100%;width:100%}li.header{margin-bottom:.5rem;--tw-text-opacity: 1;color:#a3a3a3;color:rgba(163,163,163,var(--tw-text-opacity));border-bottom:1px solid rgba(255,255,255,.12)}";var D=Object.defineProperty,O=Object.getOwnPropertyDescriptor,d=(s,l,i,t)=>{for(var e=t>1?void 0:t?O(l,i):l,r=s.length-1,a;r>=0;r--)(a=s[r])&&(e=(t?a(l,i,e):a(e))||e);return t&&e&&D(l,i,e),e};let n=class extends p(V){constructor(){super(...arguments),this.weekly=!1,this.latestVotes=[],this.albumToVote={id:"",voter:0,time:0,value:0},this.pending=!1,this.init=async()=>{this.pending=!0;try{let s=await S(14);this.latestVotes=s.voteLogs}catch(s){console.error(s)}this.pending=!1},this.timeAgo=async function*(s){for(;;){let l=BigInt(new Date().getTime())/1000n,i=l-s,t=i/86400n,e="";if(t>0&&(e+=t<2?`${t.toString()}d `:t>14?"2 weeks ":t<7?`${t.toString()} days `:"7 days "),t<7){const r=(i-t*86400n)/3600n,a=(i-t*86400n-r*3600n)/60n;r>0&&t<2&&(e+=+r.toString()+"h "),a>0&&t<2&&(e+=a.toString()+"m ")}e?e+="ago":e="<1m",yield e,await new Promise(r=>setTimeout(r,1e3))}}}connectedCallback(){super.connectedCallback(),this.init()}render(){return o`${c(this.pending&&this.latestVotes.length==0,()=>o`<loading-skeleton num="4"></loading-skeleton>`)} ${c(!this.pending,()=>o`<ul role="ui-list hover gap-2"><li class="flex header p-1 lg_mt-4"><div class="w-16">Bidders</div></li>${w(this.latestVotes,(s,l)=>o`<li class="py-2 justify-start"><div class="flex items-top justify-between space-x-2"><ui-link href="${`/user/${s.voter.address}`}"><ui-address class="text-2xl" .address="${s.voter.address}" avatar hideAddr></ui-address></ui-link><div class="flex flex-col justify-center items-end"><p class="opacity-95 text-base">${y(s.value,18)}</p><p class="text-left text-xs text-neutral-400">${f(this.timeAgo(BigInt(s.time)))}</p></div></div></li>`)}</ul>`)}`}};d([b({type:Boolean})],n.prototype,"weekly",2);d([v()],n.prototype,"latestVotes",2);d([v()],n.prototype,"albumToVote",2);d([v()],n.prototype,"pending",2);n=d([h("latest-votes")],n);const P=".text-highlight{color:var(--colorHighlight)}";var j=Object.defineProperty,k=Object.getOwnPropertyDescriptor,C=(s,l,i,t)=>{for(var e=t>1?void 0:t?k(l,i):l,r=s.length-1,a;r>=0;r--)(a=s[r])&&(e=(t?a(l,i,e):a(e))||e);return t&&e&&j(l,i,e),e};let u=class extends p(P){constructor(){super(...arguments),this.bindScreen=new _(this,g)}get isSmall(){return g.screen.lg}connectedCallback(){super.connectedCallback()}async weekRange(){return x().then(s=>{const l=7n*24n*60n*60n;let i=s+l,t=new Date(Number(s*1000n)),e=new Date(Number(i*1000n));return console.log(s,t),t.toLocaleString("en-US",{month:"short"})+t.getDate()+(t.getFullYear()==e.getFullYear()?"":", "+t.getFullYear())+" - "+(t.getMonth()==e.getMonth()?"":e.toLocaleString("en-us",{month:"short"}))+e.getDate()+", "+e.getFullYear()})}render(){return o`<div class="flex flex-col lg_flex-row px-8 lg_space-x-12 place-content-center"><div class="lg_flex-initial w-full lg_w-[30rem]"><div class="flex justify-between h-20 lg_mt-8"><div><div class="text-2xl">Weekly</div><div class="text-neutral-400 mt-2">${$(this.weekRange())}</div></div><div class="flex flex-row-reverse"><claim-rewards></claim-rewards></div></div><div class="mt-3"><top-album weekly></top-album></div></div>${c(!this.isSmall,()=>o`<div class="flex-initial w-full lg_w-[30rem]"><div class="h-20 pt-1 lg_mt-8"><div class="text-xl">Top 10</div></div><div class="mt-3"><top-album></top-album></div></div><div class="flex-initial w-full lg_w-32"><div class="h-20 pt-1 lg_mt-8"><div class="text-xl">Votes</div></div><latest-votes></latest-votes></div>`)}</div>`}};u=C([h("view-home")],u);export{u as ViewHome};
