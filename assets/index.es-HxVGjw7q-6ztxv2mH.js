import{_ as ib}from"./index-4Y4c3ejC.js";import{V as sb,q as ob,W as ab,K as cb,J as ub,Y as hb,Z as lb,a as fb,Q as pb,b as db,s as Kr,d as it,r as jr,f as Ri,w as gb,g as Of,o as qo,$ as $c,i as yb,_ as vb,O as zc,t as Rf,v as Af,j as Nf,G as mb,k as Cf,l as wb,m as No,n as bb}from"./index-bXDZ1sRF.js";import"./vendor-aecOC4Ab.js";var _b={};function kc(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Tf(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?kc(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Oc(i,e){e||(e=i.reduce((a,h)=>a+h.length,0));const r=Tf(e);let s=0;for(const a of i)r.set(a,s),s+=a.length;return kc(r)}const rl={...sb,...ob,...ab,...cb,...ub,...hb,...lb,...fb,...pb,...db};function xf(i,e,r,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:r},decoder:{decode:s}}}const nl=xf("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),hc=xf("ascii","a",i=>{let e="a";for(let r=0;r<i.length;r++)e+=String.fromCharCode(i[r]);return e},i=>{i=i.substring(1);const e=Tf(i.length);for(let r=0;r<i.length;r++)e[r]=i.charCodeAt(r);return e}),jf={utf8:nl,"utf-8":nl,hex:rl.base16,latin1:hc,ascii:hc,binary:hc,...rl};function gr(i,e="utf8"){const r=jf[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?kc(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}function sr(i,e="utf8"){const r=jf[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):r.encoder.encode(i).substring(1)}var il=function(i,e,r){if(r||arguments.length===2)for(var s=0,a=e.length,h;s<a;s++)(h||!(s in e))&&(h||(h=Array.prototype.slice.call(e,0,s)),h[s]=e[s]);return i.concat(h||Array.prototype.slice.call(e))},Eb=function(){function i(e,r,s){this.name=e,this.version=r,this.os=s,this.type="browser"}return i}(),Ib=function(){function i(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return i}(),Sb=function(){function i(e,r,s,a){this.name=e,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return i}(),Pb=function(){function i(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return i}(),Ob=function(){function i(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return i}(),Rb=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ab=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,sl=3,Nb=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Rb]],ol=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Cb(i){return i?al(i):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Ob:typeof navigator<"u"?al(navigator.userAgent):jb()}function Tb(i){return i!==""&&Nb.reduce(function(e,r){var s=r[0],a=r[1];if(e)return e;var h=a.exec(i);return!!h&&[s,h]},!1)}function al(i){var e=Tb(i);if(!e)return null;var r=e[0],s=e[1];if(r==="searchbot")return new Pb;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<sl&&(a=il(il([],a,!0),Lb(sl-a.length),!0)):a=[];var h=a.join("."),f=xb(i),g=Ab.exec(i);return g&&g[1]?new Sb(r,h,f,g[1]):new Eb(r,h,f)}function xb(i){for(var e=0,r=ol.length;e<r;e++){var s=ol[e],a=s[0],h=s[1],f=h.exec(i);if(f)return a}return null}function jb(){var i=typeof process<"u"&&process.version;return i?new Ib(process.version.slice(1)):null}function Lb(i){for(var e=[],r=0;r<i;r++)e.push("0");return e}const qb={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},Db=":";function Mb(i){const[e,r]=i.split(Db);return{namespace:e,reference:r}}function Ub(i,e=[]){const r=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const a=i[s];r.push(...a.accounts)}),r}function Lf(i,e){return i.includes(":")?[i]:e.chains||[]}const qf="base10",ir="base16",Rc="base64pad",Hc="utf8",Df=0,Yn=1,$b=0,cl=1,Ac=12,Kc=32;function zb(){const i=Nf.generateKeyPair();return{privateKey:sr(i.secretKey,ir),publicKey:sr(i.publicKey,ir)}}function Nc(){const i=qo.randomBytes(Kc);return sr(i,ir)}function kb(i,e){const r=Nf.sharedKey(gr(i,ir),gr(e,ir),!0),s=new mb(zc.SHA256,r).expand(Kc);return sr(s,ir)}function Hb(i){const e=zc.hash(gr(i,ir));return sr(e,ir)}function Si(i){const e=zc.hash(gr(i,Hc));return sr(e,ir)}function Kb(i){return gr(`${i}`,qf)}function us(i){return Number(sr(i,qf))}function Vb(i){const e=Kb(typeof i.type<"u"?i.type:Df);if(us(e)===Yn&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof i.senderPublicKey<"u"?gr(i.senderPublicKey,ir):void 0,s=typeof i.iv<"u"?gr(i.iv,ir):qo.randomBytes(Ac),a=new Cf.ChaCha20Poly1305(gr(i.symKey,ir)).seal(s,gr(i.message,Hc));return Bb({type:e,sealed:a,iv:s,senderPublicKey:r})}function Wb(i){const e=new Cf.ChaCha20Poly1305(gr(i.symKey,ir)),{sealed:r,iv:s}=Co(i.encoded),a=e.open(s,r);if(a===null)throw new Error("Failed to decrypt");return sr(a,Hc)}function Bb(i){if(us(i.type)===Yn){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(Oc([i.type,i.senderPublicKey,i.iv,i.sealed]),Rc)}return sr(Oc([i.type,i.iv,i.sealed]),Rc)}function Co(i){const e=gr(i,Rc),r=e.slice($b,cl),s=cl;if(us(r)===Yn){const g=s+Kc,b=g+Ac,y=e.slice(s,g),E=e.slice(g,b),R=e.slice(b);return{type:r,sealed:R,iv:E,senderPublicKey:y}}const a=s+Ac,h=e.slice(s,a),f=e.slice(a);return{type:r,sealed:f,iv:h}}function Fb(i,e){const r=Co(i);return Mf({type:us(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?sr(r.senderPublicKey,ir):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Mf(i){const e=(i==null?void 0:i.type)||Df;if(e===Yn){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function ul(i){return i.type===Yn&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var Gb=Object.defineProperty,hl=Object.getOwnPropertySymbols,Jb=Object.prototype.hasOwnProperty,Qb=Object.prototype.propertyIsEnumerable,ll=(i,e,r)=>e in i?Gb(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,fl=(i,e)=>{for(var r in e||(e={}))Jb.call(e,r)&&ll(i,r,e[r]);if(hl)for(var r of hl(e))Qb.call(e,r)&&ll(i,r,e[r]);return i};const Yb="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Zb="js";function Vc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ai(){return!wb()&&!!Rf()&&navigator.product===Yb}function Ni(){return!Vc()&&!!Rf()}function hs(){return Ai()?Er.reactNative:Vc()?Er.node:Ni()?Er.browser:Er.unknown}function Xb(){var i;try{return Ai()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function t_(i,e){let r=No.parse(i);return r=fl(fl({},r),e),i=No.stringify(r),i}function e_(){return yb()||{name:"",description:"",url:"",icons:[""]}}function r_(){if(hs()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const i=Cb();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function n_(){var i;const e=hs();return e===Er.browser?[e,((i=bb())==null?void 0:i.host)||"unknown"].join(":"):e}function i_(i,e,r){const s=r_(),a=n_();return[[i,e].join("-"),[Zb,r].join("-"),s,a].join("/")}function s_({protocol:i,version:e,relayUrl:r,sdkVersion:s,auth:a,projectId:h,useOnCloseEvent:f,bundleId:g}){const b=r.split("?"),y=i_(i,e,s),E={auth:a,ua:y,projectId:h,useOnCloseEvent:f||void 0,origin:g||void 0},R=t_(b[1]||"",E);return b[0]+"?"+R}function Jn(i,e){return i.filter(r=>e.includes(r)).length===i.length}function Uf(i){return Object.fromEntries(i.entries())}function $f(i){return new Map(Object.entries(i))}function Ei(i=it.FIVE_MINUTES,e){const r=it.toMiliseconds(i||it.FIVE_MINUTES);let s,a,h;return{resolve:f=>{h&&s&&(clearTimeout(h),s(f))},reject:f=>{h&&a&&(clearTimeout(h),a(f))},done:()=>new Promise((f,g)=>{h=setTimeout(()=>{g(new Error(e))},r),s=f,a=g})}}function cs(i,e,r){return new Promise(async(s,a)=>{const h=setTimeout(()=>a(new Error(r)),e);try{const f=await i;s(f)}catch(f){a(f)}clearTimeout(h)})}function zf(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function o_(i){return zf("topic",i)}function a_(i){return zf("id",i)}function kf(i){const[e,r]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")s.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return s}function kr(i,e){return it.fromMiliseconds((e||Date.now())+it.toMiliseconds(i))}function Cn(i){return Date.now()>=it.toMiliseconds(i)}function Le(i,e){return`${i}${e?`:${e}`:""}`}function lc(i=[],e=[]){return[...new Set([...i,...e])]}async function c_({id:i,topic:e,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${i}&sessionTopic=${e}`,f=hs();f===Er.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):f===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(s){console.error(s)}}async function u_(i,e){try{return await i.getItem(e)||(Ni()?localStorage.getItem(e):void 0)}catch(r){console.error(r)}}const h_="irn";function Cc(i){return(i==null?void 0:i.relay)||{protocol:h_}}function Po(i){const e=qb[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var l_=Object.defineProperty,pl=Object.getOwnPropertySymbols,f_=Object.prototype.hasOwnProperty,p_=Object.prototype.propertyIsEnumerable,dl=(i,e,r)=>e in i?l_(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,d_=(i,e)=>{for(var r in e||(e={}))f_.call(e,r)&&dl(i,r,e[r]);if(pl)for(var r of pl(e))p_.call(e,r)&&dl(i,r,e[r]);return i};function g_(i,e="-"){const r={},s="relay"+e;return Object.keys(i).forEach(a=>{if(a.startsWith(s)){const h=a.replace(s,""),f=i[a];r[h]=f}}),r}function gl(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),r=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),a=i.substring(e+1,r).split("@"),h=typeof r<"u"?i.substring(r):"",f=No.parse(h);return{protocol:s,topic:y_(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:g_(f)}}function y_(i){return i.startsWith("//")?i.substring(2):i}function v_(i,e="-"){const r="relay",s={};return Object.keys(i).forEach(a=>{const h=r+e+a;i[a]&&(s[h]=i[a])}),s}function m_(i){return`${i.protocol}:${i.topic}@${i.version}?`+No.stringify(d_({symKey:i.symKey},v_(i.relay)))}function Ci(i){const e=[];return i.forEach(r=>{const[s,a]=r.split(":");e.push(`${s}:${a}`)}),e}function w_(i){const e=[];return Object.values(i).forEach(r=>{e.push(...Ci(r.accounts))}),e}function b_(i,e){const r=[];return Object.values(i).forEach(s=>{Ci(s.accounts).includes(e)&&r.push(...s.methods)}),r}function __(i,e){const r=[];return Object.values(i).forEach(s=>{Ci(s.accounts).includes(e)&&r.push(...s.events)}),r}function E_(i,e){const r=Oo(i,e);if(r)throw new Error(r.message);const s={};for(const[a,h]of Object.entries(i))s[a]={methods:h.methods,events:h.events,chains:h.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function Wc(i){return i.includes(":")}function is(i){return Wc(i)?i.split(":")[0]:i}const I_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},S_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(i,e){const{message:r,code:s}=S_[i];return{message:e?`${r} ${e}`:r,code:s}}function Ie(i,e){const{message:r,code:s}=I_[i];return{message:e?`${r} ${e}`:r,code:s}}function Zr(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Pi(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function nr(i){return typeof i>"u"}function He(i,e){return e&&nr(i)?!0:typeof i=="string"&&!!i.trim().length}function Bc(i,e){return e&&nr(i)?!0:typeof i=="number"&&!isNaN(i)}function P_(i,e){const{requiredNamespaces:r}=e,s=Object.keys(i.namespaces),a=Object.keys(r);let h=!0;return Jn(a,s)?(s.forEach(f=>{const{accounts:g,methods:b,events:y}=i.namespaces[f],E=Ci(g),R=r[f];(!Jn(Lf(f,R),E)||!Jn(R.methods,b)||!Jn(R.events,y))&&(h=!1)}),h):!1}function To(i){return He(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function O_(i){if(He(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&To(r)}}return!1}function R_(i){if(He(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function A_(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function N_(i){return i==null?void 0:i.topic}function C_(i,e){let r=null;return He(i==null?void 0:i.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function yl(i){let e=!0;return Zr(i)?i.length&&(e=i.every(r=>He(r,!1))):e=!1,e}function T_(i,e,r){let s=null;return Zr(e)&&e.length?e.forEach(a=>{s||To(a)||(s=Ie("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):To(i)||(s=Ie("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function x_(i,e,r){let s=null;return Object.entries(i).forEach(([a,h])=>{if(s)return;const f=T_(a,Lf(a,h),`${e} ${r}`);f&&(s=f)}),s}function j_(i,e){let r=null;return Zr(i)?i.forEach(s=>{r||O_(s)||(r=Ie("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=Ie("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function L_(i,e){let r=null;return Object.values(i).forEach(s=>{if(r)return;const a=j_(s==null?void 0:s.accounts,`${e} namespace`);a&&(r=a)}),r}function q_(i,e){let r=null;return yl(i==null?void 0:i.methods)?yl(i==null?void 0:i.events)||(r=Ie("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ie("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Hf(i,e){let r=null;return Object.values(i).forEach(s=>{if(r)return;const a=q_(s,`${e}, namespace`);a&&(r=a)}),r}function D_(i,e,r){let s=null;if(i&&Pi(i)){const a=Hf(i,e);a&&(s=a);const h=x_(i,e,r);h&&(s=h)}else s=J("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return s}function Oo(i,e){let r=null;if(i&&Pi(i)){const s=Hf(i,e);s&&(r=s);const a=L_(i,e);a&&(r=a)}else r=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Kf(i){return He(i.protocol,!0)}function M_(i,e){let r=!1;return e&&!i?r=!0:i&&Zr(i)&&i.length&&i.forEach(s=>{r=Kf(s)}),r}function U_(i){return typeof i=="number"}function dr(i){return typeof i<"u"&&typeof i!==null}function $_(i){return!(!i||typeof i!="object"||!i.code||!Bc(i.code,!1)||!i.message||!He(i.message,!1))}function z_(i){return!(nr(i)||!He(i.method,!1))}function k_(i){return!(nr(i)||nr(i.result)&&nr(i.error)||!Bc(i.id,!1)||!He(i.jsonrpc,!1))}function H_(i){return!(nr(i)||!He(i.name,!1))}function vl(i,e){return!(!To(e)||!w_(i).includes(e))}function K_(i,e,r){return He(r,!1)?b_(i,e).includes(r):!1}function V_(i,e,r){return He(r,!1)?__(i,e).includes(r):!1}function ml(i,e,r){let s=null;const a=W_(i),h=B_(e),f=Object.keys(a),g=Object.keys(h),b=wl(Object.keys(i)),y=wl(Object.keys(e)),E=b.filter(R=>!y.includes(R));return E.length&&(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(e).toString()}`)),Jn(f,g)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(e).forEach(R=>{if(!R.includes(":")||s)return;const x=Ci(e[R].accounts);x.includes(R)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${R}
        Required: ${R}
        Approved: ${x.toString()}`))}),f.forEach(R=>{s||(Jn(a[R].methods,h[R].methods)?Jn(a[R].events,h[R].events)||(s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${R}`)):s=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${R}`))}),s}function W_(i){const e={};return Object.keys(i).forEach(r=>{var s;r.includes(":")?e[r]=i[r]:(s=i[r].chains)==null||s.forEach(a=>{e[a]={methods:i[r].methods,events:i[r].events}})}),e}function wl(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function B_(i){const e={};return Object.keys(i).forEach(r=>{if(r.includes(":"))e[r]=i[r];else{const s=Ci(i[r].accounts);s==null||s.forEach(a=>{e[a]={accounts:i[r].accounts.filter(h=>h.includes(`${a}:`)),methods:i[r].methods,events:i[r].events}})}}),e}function F_(i,e){return Bc(i,!1)&&i<=e.max&&i>=e.min}function bl(){const i=hs();return new Promise(e=>{switch(i){case Er.browser:e(G_());break;case Er.reactNative:e(J_());break;case Er.node:e(Q_());break;default:e(!0)}})}function G_(){return Ni()&&(navigator==null?void 0:navigator.onLine)}async function J_(){if(Ai()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function Q_(){return!0}function Y_(i){switch(hs()){case Er.browser:Z_(i);break;case Er.reactNative:X_(i);break}}function Z_(i){!Ai()&&Ni()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function X_(i){Ai()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const fc={};let wo=class{static get(i){return fc[i]}static set(i,e){fc[i]=e}static delete(i){delete fc[i]}};const t0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,e0=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,r0=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function n0(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){i0(i);return}return e}function i0(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function bo(i,e={}){if(typeof i!="string")return i;const r=i.trim();if(i[0]==='"'&&i.at(-1)==='"'&&!i.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!r0.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(t0.test(i)||e0.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,n0)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function s0(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function ke(i,...e){try{return s0(i(...e))}catch(r){return Promise.reject(r)}}function o0(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function a0(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Ro(i){if(o0(i))return String(i);if(a0(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Ro(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Vf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Tc="base64:";function c0(i){if(typeof i=="string")return i;Vf();const e=Buffer.from(i).toString("base64");return Tc+e}function u0(i){return typeof i!="string"||!i.startsWith(Tc)?i:(Vf(),Buffer.from(i.slice(Tc.length),"base64"))}function pr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function h0(...i){return pr(i.join(":"))}function _o(i){return i=pr(i),i?i+":":""}const l0="memory",f0=()=>{const i=new Map;return{name:l0,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,r){i.set(e,r)},setItemRaw(e,r){i.set(e,r)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function p0(i={}){const e={mounts:{"":i.driver||f0()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const E of e.mountpoints)if(y.startsWith(E))return{base:E,relativeKey:y.slice(E.length),driver:e.mounts[E]};return{base:"",relativeKey:y,driver:e.mounts[""]}},s=(y,E)=>e.mountpoints.filter(R=>R.startsWith(y)||E&&y.startsWith(R)).map(R=>({relativeBase:y.length>R.length?y.slice(R.length):void 0,mountpoint:R,driver:e.mounts[R]})),a=(y,E)=>{if(e.watching){E=pr(E);for(const R of e.watchListeners)R(y,E)}},h=async()=>{if(!e.watching){e.watching=!0;for(const y in e.mounts)e.unwatch[y]=await _l(e.mounts[y],a,y)}},f=async()=>{if(e.watching){for(const y in e.unwatch)await e.unwatch[y]();e.unwatch={},e.watching=!1}},g=(y,E,R)=>{const x=new Map,$=C=>{let W=x.get(C.base);return W||(W={driver:C.driver,base:C.base,items:[]},x.set(C.base,W)),W};for(const C of y){const W=typeof C=="string",tt=pr(W?C:C.key),yt=W?void 0:C.value,pt=W||!C.options?E:{...E,...C.options},ut=r(tt);$(ut).items.push({key:tt,value:yt,relativeKey:ut.relativeKey,options:pt})}return Promise.all([...x.values()].map(C=>R(C))).then(C=>C.flat())},b={hasItem(y,E={}){y=pr(y);const{relativeKey:R,driver:x}=r(y);return ke(x.hasItem,R,E)},getItem(y,E={}){y=pr(y);const{relativeKey:R,driver:x}=r(y);return ke(x.getItem,R,E).then($=>bo($))},getItems(y,E){return g(y,E,R=>R.driver.getItems?ke(R.driver.getItems,R.items.map(x=>({key:x.relativeKey,options:x.options})),E).then(x=>x.map($=>({key:h0(R.base,$.key),value:bo($.value)}))):Promise.all(R.items.map(x=>ke(R.driver.getItem,x.relativeKey,x.options).then($=>({key:x.key,value:bo($)})))))},getItemRaw(y,E={}){y=pr(y);const{relativeKey:R,driver:x}=r(y);return x.getItemRaw?ke(x.getItemRaw,R,E):ke(x.getItem,R,E).then($=>u0($))},async setItem(y,E,R={}){if(E===void 0)return b.removeItem(y);y=pr(y);const{relativeKey:x,driver:$}=r(y);$.setItem&&(await ke($.setItem,x,Ro(E),R),$.watch||a("update",y))},async setItems(y,E){await g(y,E,async R=>{R.driver.setItems&&await ke(R.driver.setItems,R.items.map(x=>({key:x.relativeKey,value:Ro(x.value),options:x.options})),E),R.driver.setItem&&await Promise.all(R.items.map(x=>ke(R.driver.setItem,x.relativeKey,Ro(x.value),x.options)))})},async setItemRaw(y,E,R={}){if(E===void 0)return b.removeItem(y,R);y=pr(y);const{relativeKey:x,driver:$}=r(y);if($.setItemRaw)await ke($.setItemRaw,x,E,R);else if($.setItem)await ke($.setItem,x,c0(E),R);else return;$.watch||a("update",y)},async removeItem(y,E={}){typeof E=="boolean"&&(E={removeMeta:E}),y=pr(y);const{relativeKey:R,driver:x}=r(y);x.removeItem&&(await ke(x.removeItem,R,E),(E.removeMeta||E.removeMata)&&await ke(x.removeItem,R+"$",E),x.watch||a("remove",y))},async getMeta(y,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),y=pr(y);const{relativeKey:R,driver:x}=r(y),$=Object.create(null);if(x.getMeta&&Object.assign($,await ke(x.getMeta,R,E)),!E.nativeOnly){const C=await ke(x.getItem,R+"$",E).then(W=>bo(W));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign($,C))}return $},setMeta(y,E,R={}){return this.setItem(y+"$",E,R)},removeMeta(y,E={}){return this.removeItem(y+"$",E)},async getKeys(y,E={}){y=_o(y);const R=s(y,!0);let x=[];const $=[];for(const C of R){const W=(await ke(C.driver.getKeys,C.relativeBase,E)).map(tt=>C.mountpoint+pr(tt)).filter(tt=>!x.some(yt=>tt.startsWith(yt)));$.push(...W),x=[C.mountpoint,...x.filter(tt=>!tt.startsWith(C.mountpoint))]}return y?$.filter(C=>C.startsWith(y)&&!C.endsWith("$")):$.filter(C=>!C.endsWith("$"))},async clear(y,E={}){y=_o(y),await Promise.all(s(y,!1).map(async R=>{if(R.driver.clear)return ke(R.driver.clear,R.relativeBase,E);if(R.driver.removeItem){const x=await R.driver.getKeys(R.relativeBase||"",E);return Promise.all(x.map($=>R.driver.removeItem($,E)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(y=>El(y)))},async watch(y){return await h(),e.watchListeners.push(y),async()=>{e.watchListeners=e.watchListeners.filter(E=>E!==y),e.watchListeners.length===0&&await f()}},async unwatch(){e.watchListeners=[],await f()},mount(y,E){if(y=_o(y),y&&e.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(e.mountpoints.push(y),e.mountpoints.sort((R,x)=>x.length-R.length)),e.mounts[y]=E,e.watching&&Promise.resolve(_l(E,a,y)).then(R=>{e.unwatch[y]=R}).catch(console.error),b},async unmount(y,E=!0){y=_o(y),!(!y||!e.mounts[y])&&(e.watching&&y in e.unwatch&&(e.unwatch[y](),delete e.unwatch[y]),E&&await El(e.mounts[y]),e.mountpoints=e.mountpoints.filter(R=>R!==y),delete e.mounts[y])},getMount(y=""){y=pr(y)+":";const E=r(y);return{driver:E.driver,base:E.base}},getMounts(y="",E={}){return y=pr(y),s(y,E.parents).map(R=>({driver:R.driver,base:R.mountpoint}))}};return b}function _l(i,e,r){return i.watch?i.watch((s,a)=>e(s,r+a)):()=>{}}async function El(i){typeof i.dispose=="function"&&await ke(i.dispose)}function Zn(i){return new Promise((e,r)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>r(i.error)})}function Wf(i,e){const r=indexedDB.open(i);r.onupgradeneeded=()=>r.result.createObjectStore(e);const s=Zn(r);return(a,h)=>s.then(f=>h(f.transaction(e,a).objectStore(e)))}let pc;function ls(){return pc||(pc=Wf("keyval-store","keyval")),pc}function Il(i,e=ls()){return e("readonly",r=>Zn(r.get(i)))}function d0(i,e,r=ls()){return r("readwrite",s=>(s.put(e,i),Zn(s.transaction)))}function g0(i,e=ls()){return e("readwrite",r=>(r.delete(i),Zn(r.transaction)))}function y0(i=ls()){return i("readwrite",e=>(e.clear(),Zn(e.transaction)))}function v0(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Zn(i.transaction)}function m0(i=ls()){return i("readonly",e=>{if(e.getAllKeys)return Zn(e.getAllKeys());const r=[];return v0(e,s=>r.push(s.key)).then(()=>r)})}const w0=i=>JSON.stringify(i,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),b0=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=i.replace(e,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function fs(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return b0(i)}catch{return i}}function Qn(i){return typeof i=="string"?i:w0(i)||""}const _0="idb-keyval";var E0=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",r=a=>e+a;let s;return i.dbName&&i.storeName&&(s=Wf(i.dbName,i.storeName)),{name:_0,options:i,async hasItem(a){return!(typeof await Il(r(a),s)>"u")},async getItem(a){return await Il(r(a),s)??null},setItem(a,h){return d0(r(a),h,s)},removeItem(a){return g0(r(a),s)},getKeys(){return m0(s)},clear(){return y0(s)}}};const I0="WALLET_CONNECT_V2_INDEXED_DB",S0="keyvaluestorage";let P0=class{constructor(){this.indexedDb=p0({driver:E0({dbName:I0,storeName:S0})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const e=await this.indexedDb.getItem(i);if(e!==null)return e}async setItem(i,e){await this.indexedDb.setItem(i,Qn(e))}async removeItem(i){await this.indexedDb.removeItem(i)}};var dc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ao={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},i.prototype.setItem=function(r,s){this[r]=String(s)},i.prototype.removeItem=function(r){delete this[r]},i.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},i.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof dc<"u"&&dc.localStorage?Ao.exports=dc.localStorage:typeof window<"u"&&window.localStorage?Ao.exports=window.localStorage:Ao.exports=new e})();function O0(i){var e;return[i[0],fs((e=i[1])!=null?e:"")]}class R0{constructor(){this.localStorage=Ao.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(O0)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return fs(r)}async setItem(e,r){this.localStorage.setItem(e,Qn(r))}async removeItem(e){this.localStorage.removeItem(e)}}const A0="wc_storage_version",Sl=1,N0=async(i,e,r)=>{const s=A0,a=await e.getItem(s);if(a&&a>=Sl){r(e);return}const h=await i.getKeys();if(!h.length){r(e);return}const f=[];for(;h.length;){const g=h.shift();if(!g)continue;const b=g.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const y=await i.getItem(g);await e.setItem(g,y),f.push(g)}}await e.setItem(s,Sl),r(e),C0(i,f)},C0=async(i,e)=>{e.length&&e.forEach(async r=>{await i.removeItem(r)})};let T0=class{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const i=new R0;this.storage=i;try{const e=new P0;N0(i,e,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,e){return await this.initialize(),this.storage.setItem(i,e)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const e=setInterval(()=>{this.initialized&&(clearInterval(e),i())},20)})}};var Ti={},Yi={},Pl={},Zi={};let Xn=class{};const x0=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Xn},Symbol.toStringTag,{value:"Module"})),j0=vb(x0);var Ol;function L0(){if(Ol)return Zi;Ol=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.IHeartBeat=void 0;const i=j0;class e extends i.IEvents{constructor(s){super()}}return Zi.IHeartBeat=e,Zi}var Rl;function Bf(){return Rl||(Rl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ri.__exportStar(L0(),i)}(Pl)),Pl}var Al={},Gn={},Nl;function q0(){if(Nl)return Gn;Nl=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.HEARTBEAT_EVENTS=Gn.HEARTBEAT_INTERVAL=void 0;const i=it;return Gn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,Gn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Gn}var Cl;function Ff(){return Cl||(Cl=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Ri.__exportStar(q0(),i)}(Al)),Al}var Tl;function D0(){if(Tl)return Yi;Tl=1,Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.HeartBeat=void 0;const i=Ri,e=jr,r=it,s=Bf(),a=Ff();class h extends s.IHeartBeat{constructor(g){super(g),this.events=new e.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return i.__awaiter(this,void 0,void 0,function*(){const b=new h(g);return yield b.init(),b})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,b){this.events.on(g,b)}once(g,b){this.events.once(g,b)}off(g,b){this.events.off(g,b)}removeListener(g,b){this.events.removeListener(g,b)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Yi.HeartBeat=h,Yi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ri;e.__exportStar(D0(),i),e.__exportStar(Bf(),i),e.__exportStar(Ff(),i)})(Ti);var Ct={},gc,xl;function M0(){if(xl)return gc;xl=1;function i(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}gc=e;function e(r,s,a){var h=a&&a.stringify||i,f=1;if(typeof r=="object"&&r!==null){var g=s.length+f;if(g===1)return r;var b=new Array(g);b[0]=h(r);for(var y=1;y<g;y++)b[y]=h(s[y]);return b.join(" ")}if(typeof r!="string")return r;var E=s.length;if(E===0)return r;for(var R="",x=1-f,$=-1,C=r&&r.length||0,W=0;W<C;){if(r.charCodeAt(W)===37&&W+1<C){switch($=$>-1?$:0,r.charCodeAt(W+1)){case 100:case 102:if(x>=E||s[x]==null)break;$<W&&(R+=r.slice($,W)),R+=Number(s[x]),$=W+2,W++;break;case 105:if(x>=E||s[x]==null)break;$<W&&(R+=r.slice($,W)),R+=Math.floor(Number(s[x])),$=W+2,W++;break;case 79:case 111:case 106:if(x>=E||s[x]===void 0)break;$<W&&(R+=r.slice($,W));var tt=typeof s[x];if(tt==="string"){R+="'"+s[x]+"'",$=W+2,W++;break}if(tt==="function"){R+=s[x].name||"<anonymous>",$=W+2,W++;break}R+=h(s[x]),$=W+2,W++;break;case 115:if(x>=E)break;$<W&&(R+=r.slice($,W)),R+=String(s[x]),$=W+2,W++;break;case 37:$<W&&(R+=r.slice($,W)),R+="%",$=W+2,W++,x--;break}++x}++W}return $===-1?r:($<C&&(R+=r.slice($)),R)}return gc}var yc,jl;function U0(){if(jl)return yc;jl=1;const i=M0();yc=a;const e=lt().console||{},r={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:C,res:C,err:x};function s(q,H){return Array.isArray(q)?q.filter(function(G){return G!=="!stdSerializers.err"}):q===!0?Object.keys(H):!1}function a(q){q=q||{},q.browser=q.browser||{};const H=q.browser.transmit;if(H&&typeof H.send!="function")throw Error("pino: transmit option must have a send function");const G=q.browser.write||e;q.browser.write&&(q.browser.asObject=!0);const wt=q.serializers||{},nt=s(q.browser.serialize,wt);let st=q.browser.serialize;Array.isArray(q.browser.serialize)&&q.browser.serialize.indexOf("!stdSerializers.err")>-1&&(st=!1);const qt=["error","fatal","warn","info","debug","trace"];typeof G=="function"&&(G.error=G.fatal=G.warn=G.info=G.debug=G.trace=G),q.enabled===!1&&(q.level="silent");const Dt=q.level||"info",m=Object.create(G);m.log||(m.log=tt),Object.defineProperty(m,"levelVal",{get:Y}),Object.defineProperty(m,"level",{get:dt,set:B});const S={transmit:H,serialize:nt,asObject:q.browser.asObject,levels:qt,timestamp:$(q)};m.levels=a.levels,m.level=Dt,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=tt,m.serializers=wt,m._serialize=nt,m._stdErrSerialize=st,m.child=k,H&&(m._logEvent=R());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function dt(){return this._level}function B(V){if(V!=="silent"&&!this.levels.values[V])throw Error("unknown level "+V);this._level=V,h(S,m,"error","log"),h(S,m,"fatal","error"),h(S,m,"warn","error"),h(S,m,"info","log"),h(S,m,"debug","log"),h(S,m,"trace","log")}function k(V,F){if(!V)throw new Error("missing bindings for child Pino");F=F||{},nt&&V.serializers&&(F.serializers=V.serializers);const Jt=F.serializers;if(nt&&Jt){var Kt=Object.assign({},wt,Jt),Vr=q.browser.serialize===!0?Object.keys(Kt):nt;delete V.serializers,b([V],Vr,Kt,this._stdErrSerialize)}function It(Se){this._childLevel=(Se._childLevel|0)+1,this.error=y(Se,V,"error"),this.fatal=y(Se,V,"fatal"),this.warn=y(Se,V,"warn"),this.info=y(Se,V,"info"),this.debug=y(Se,V,"debug"),this.trace=y(Se,V,"trace"),Kt&&(this.serializers=Kt,this._serialize=Vr),H&&(this._logEvent=R([].concat(Se._logEvent.bindings,V)))}return It.prototype=this,new It(this)}return m}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:yt,epochTime:pt,unixTime:ut,isoTime:ht});function h(q,H,G,wt){const nt=Object.getPrototypeOf(H);H[G]=H.levelVal>H.levels.values[G]?tt:nt[G]?nt[G]:e[G]||e[wt]||tt,f(q,H,G)}function f(q,H,G){!q.transmit&&H[G]===tt||(H[G]=function(wt){return function(){const nt=q.timestamp(),st=new Array(arguments.length),qt=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var Dt=0;Dt<st.length;Dt++)st[Dt]=arguments[Dt];if(q.serialize&&!q.asObject&&b(st,this._serialize,this.serializers,this._stdErrSerialize),q.asObject?wt.call(qt,g(this,G,st,nt)):wt.apply(qt,st),q.transmit){const m=q.transmit.level||H.level,S=a.levels.values[m],Y=a.levels.values[G];if(Y<S)return;E(this,{ts:nt,methodLevel:G,methodValue:Y,transmitLevel:m,transmitValue:a.levels.values[q.transmit.level||H.level],send:q.transmit.send,val:H.levelVal},st)}}}(H[G]))}function g(q,H,G,wt){q._serialize&&b(G,q._serialize,q.serializers,q._stdErrSerialize);const nt=G.slice();let st=nt[0];const qt={};wt&&(qt.time=wt),qt.level=a.levels.values[H];let Dt=(q._childLevel|0)+1;if(Dt<1&&(Dt=1),st!==null&&typeof st=="object"){for(;Dt--&&typeof nt[0]=="object";)Object.assign(qt,nt.shift());st=nt.length?i(nt.shift(),nt):void 0}else typeof st=="string"&&(st=i(nt.shift(),nt));return st!==void 0&&(qt.msg=st),qt}function b(q,H,G,wt){for(const nt in q)if(wt&&q[nt]instanceof Error)q[nt]=a.stdSerializers.err(q[nt]);else if(typeof q[nt]=="object"&&!Array.isArray(q[nt]))for(const st in q[nt])H&&H.indexOf(st)>-1&&st in G&&(q[nt][st]=G[st](q[nt][st]))}function y(q,H,G){return function(){const wt=new Array(1+arguments.length);wt[0]=H;for(var nt=1;nt<wt.length;nt++)wt[nt]=arguments[nt-1];return q[G].apply(this,wt)}}function E(q,H,G){const wt=H.send,nt=H.ts,st=H.methodLevel,qt=H.methodValue,Dt=H.val,m=q._logEvent.bindings;b(G,q._serialize||Object.keys(q.serializers),q.serializers,q._stdErrSerialize===void 0?!0:q._stdErrSerialize),q._logEvent.ts=nt,q._logEvent.messages=G.filter(function(S){return m.indexOf(S)===-1}),q._logEvent.level.label=st,q._logEvent.level.value=qt,wt(st,q._logEvent,Dt),q._logEvent=R(m)}function R(q){return{ts:0,messages:[],bindings:q||[],level:{label:"",value:0}}}function x(q){const H={type:q.constructor.name,msg:q.message,stack:q.stack};for(const G in q)H[G]===void 0&&(H[G]=q[G]);return H}function $(q){return typeof q.timestamp=="function"?q.timestamp:q.timestamp===!1?yt:pt}function C(){return{}}function W(q){return q}function tt(){}function yt(){return!1}function pt(){return Date.now()}function ut(){return Math.round(Date.now()/1e3)}function ht(){return new Date(Date.now()).toISOString()}function lt(){function q(H){return typeof H<"u"&&H}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return q(self)||q(window)||q(this)||{}}}return yc}var _i={},Ll;function Gf(){return Ll||(Ll=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.PINO_CUSTOM_CONTEXT_KEY=_i.PINO_LOGGER_DEFAULTS=void 0,_i.PINO_LOGGER_DEFAULTS={level:"info"},_i.PINO_CUSTOM_CONTEXT_KEY="custom_context"),_i}var rr={},ql;function $0(){if(ql)return rr;ql=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const i=Gf();function e(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||i.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=e;function r(g,b=i.PINO_CUSTOM_CONTEXT_KEY){return g[b]||""}rr.getBrowserLoggerContext=r;function s(g,b,y=i.PINO_CUSTOM_CONTEXT_KEY){return g[y]=b,g}rr.setBrowserLoggerContext=s;function a(g,b=i.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof g.bindings>"u"?y=r(g,b):y=g.bindings().context||"",y}rr.getLoggerContext=a;function h(g,b,y=i.PINO_CUSTOM_CONTEXT_KEY){const E=a(g,y);return E.trim()?`${E}/${b}`:b}rr.formatChildLoggerContext=h;function f(g,b,y=i.PINO_CUSTOM_CONTEXT_KEY){const E=h(g,b,y),R=g.child({context:E});return s(R,E,y)}return rr.generateChildLogger=f,rr}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=Ri,r=e.__importDefault(U0());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Gf(),i),e.__exportStar($0(),i)})(Ct);class z0 extends Xn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let k0=class extends Xn{constructor(i,e){super(),this.core=i,this.logger=e,this.records=new Map}},H0=class{constructor(i,e){this.logger=i,this.core=e}},K0=class extends Xn{constructor(i,e){super(),this.relayer=i,this.logger=e}},V0=class extends Xn{constructor(i){super()}},W0=class{constructor(i,e,r,s){this.core=i,this.logger=e,this.name=r}};class B0 extends Xn{constructor(e,r){super(),this.relayer=e,this.logger=r}}let F0=class extends Xn{constructor(i,e){super(),this.core=i,this.logger=e}},G0=class{constructor(i,e){this.projectId=i,this.logger=e}},J0=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},Q0=class{constructor(i){this.client=i}};var Fc={},Jf={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=gb,r=Of;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(b,y){if(y===void 0&&(y=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=b[E++],y--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(E=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,E,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=b[E++],y--;return this},g.prototype.finish=function(b){if(!this._finished){var y=this._bytesHashed,E=this._bufferLength,R=y/536870912|0,x=y<<3,$=y%128<112?128:256;this._buffer[E]=128;for(var C=E+1;C<$-8;C++)this._buffer[C]=0;e.writeUint32BE(R,this._buffer,$-8),e.writeUint32BE(x,this._buffer,$-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,$),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)e.writeUint32BE(this._stateHi[C],b,C*8),e.writeUint32BE(this._stateLo[C],b,C*8+4);return this},g.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(b){r.wipe(b.stateHi),r.wipe(b.stateLo),b.buffer&&r.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},g}();i.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(g,b,y,E,R,x,$){for(var C=y[0],W=y[1],tt=y[2],yt=y[3],pt=y[4],ut=y[5],ht=y[6],lt=y[7],q=E[0],H=E[1],G=E[2],wt=E[3],nt=E[4],st=E[5],qt=E[6],Dt=E[7],m,S,Y,dt,B,k,V,F;$>=128;){for(var Jt=0;Jt<16;Jt++){var Kt=8*Jt+x;g[Jt]=e.readUint32BE(R,Kt),b[Jt]=e.readUint32BE(R,Kt+4)}for(var Jt=0;Jt<80;Jt++){var Vr=C,It=W,Se=tt,L=yt,j=pt,N=ut,u=ht,I=lt,et=q,ft=H,_t=G,Tt=wt,jt=nt,Ot=st,Pe=qt,me=Dt;if(m=lt,S=Dt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=(pt>>>14|nt<<18)^(pt>>>18|nt<<14)^(nt>>>9|pt<<23),S=(nt>>>14|pt<<18)^(nt>>>18|pt<<14)^(pt>>>9|nt<<23),B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,m=pt&ut^~pt&ht,S=nt&st^~nt&qt,B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,m=a[Jt*2],S=a[Jt*2+1],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,m=g[Jt%16],S=b[Jt%16],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,Y=V&65535|F<<16,dt=B&65535|k<<16,m=Y,S=dt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=(C>>>28|q<<4)^(q>>>2|C<<30)^(q>>>7|C<<25),S=(q>>>28|C<<4)^(C>>>2|q<<30)^(C>>>7|q<<25),B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,m=C&W^C&tt^W&tt,S=q&H^q&G^H&G,B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,I=V&65535|F<<16,me=B&65535|k<<16,m=L,S=Tt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=Y,S=dt,B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,L=V&65535|F<<16,Tt=B&65535|k<<16,W=Vr,tt=It,yt=Se,pt=L,ut=j,ht=N,lt=u,C=I,H=et,G=ft,wt=_t,nt=Tt,st=jt,qt=Ot,Dt=Pe,q=me,Jt%16===15)for(var Kt=0;Kt<16;Kt++)m=g[Kt],S=b[Kt],B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=g[(Kt+9)%16],S=b[(Kt+9)%16],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,Y=g[(Kt+1)%16],dt=b[(Kt+1)%16],m=(Y>>>1|dt<<31)^(Y>>>8|dt<<24)^Y>>>7,S=(dt>>>1|Y<<31)^(dt>>>8|Y<<24)^(dt>>>7|Y<<25),B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,Y=g[(Kt+14)%16],dt=b[(Kt+14)%16],m=(Y>>>19|dt<<13)^(dt>>>29|Y<<3)^Y>>>6,S=(dt>>>19|Y<<13)^(Y>>>29|dt<<3)^(dt>>>6|Y<<26),B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,g[Kt]=V&65535|F<<16,b[Kt]=B&65535|k<<16}m=C,S=q,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[0],S=E[0],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[0]=C=V&65535|F<<16,E[0]=q=B&65535|k<<16,m=W,S=H,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[1],S=E[1],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[1]=W=V&65535|F<<16,E[1]=H=B&65535|k<<16,m=tt,S=G,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[2],S=E[2],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[2]=tt=V&65535|F<<16,E[2]=G=B&65535|k<<16,m=yt,S=wt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[3],S=E[3],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[3]=yt=V&65535|F<<16,E[3]=wt=B&65535|k<<16,m=pt,S=nt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[4],S=E[4],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[4]=pt=V&65535|F<<16,E[4]=nt=B&65535|k<<16,m=ut,S=st,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[5],S=E[5],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[5]=ut=V&65535|F<<16,E[5]=st=B&65535|k<<16,m=ht,S=qt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[6],S=E[6],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[6]=ht=V&65535|F<<16,E[6]=qt=B&65535|k<<16,m=lt,S=Dt,B=S&65535,k=S>>>16,V=m&65535,F=m>>>16,m=y[7],S=E[7],B+=S&65535,k+=S>>>16,V+=m&65535,F+=m>>>16,k+=B>>>16,V+=k>>>16,F+=V>>>16,y[7]=lt=V&65535|F<<16,E[7]=Dt=B&65535|k<<16,x+=128,$-=128}return x}function f(g){var b=new s;b.update(g);var y=b.digest();return b.clean(),y}i.hash=f})(Jf);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=qo,r=Jf,s=Of;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function a(L){const j=new Float64Array(16);if(L)for(let N=0;N<L.length;N++)j[N]=L[N];return j}const h=new Uint8Array(32);h[0]=9;const f=a(),g=a([1]),b=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),R=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function $(L,j){for(let N=0;N<16;N++)L[N]=j[N]|0}function C(L){let j=1;for(let N=0;N<16;N++){let u=L[N]+j+65535;j=Math.floor(u/65536),L[N]=u-j*65536}L[0]+=j-1+37*(j-1)}function W(L,j,N){const u=~(N-1);for(let I=0;I<16;I++){const et=u&(L[I]^j[I]);L[I]^=et,j[I]^=et}}function tt(L,j){const N=a(),u=a();for(let I=0;I<16;I++)u[I]=j[I];C(u),C(u),C(u);for(let I=0;I<2;I++){N[0]=u[0]-65517;for(let ft=1;ft<15;ft++)N[ft]=u[ft]-65535-(N[ft-1]>>16&1),N[ft-1]&=65535;N[15]=u[15]-32767-(N[14]>>16&1);const et=N[15]>>16&1;N[14]&=65535,W(u,N,1-et)}for(let I=0;I<16;I++)L[2*I]=u[I]&255,L[2*I+1]=u[I]>>8}function yt(L,j){let N=0;for(let u=0;u<32;u++)N|=L[u]^j[u];return(1&N-1>>>8)-1}function pt(L,j){const N=new Uint8Array(32),u=new Uint8Array(32);return tt(N,L),tt(u,j),yt(N,u)}function ut(L){const j=new Uint8Array(32);return tt(j,L),j[0]&1}function ht(L,j){for(let N=0;N<16;N++)L[N]=j[2*N]+(j[2*N+1]<<8);L[15]&=32767}function lt(L,j,N){for(let u=0;u<16;u++)L[u]=j[u]+N[u]}function q(L,j,N){for(let u=0;u<16;u++)L[u]=j[u]-N[u]}function H(L,j,N){let u,I,et=0,ft=0,_t=0,Tt=0,jt=0,Ot=0,Pe=0,me=0,oe=0,Mt=0,Yt=0,Zt=0,ae=0,kt=0,Xt=0,xt=0,Vt=0,he=0,$t=0,Oe=0,qe=0,Ke=0,Ve=0,Ue=0,Qe=0,or=0,Wr=0,Ye=0,Xr=0,wn=0,Ln=0,le=N[0],re=N[1],fe=N[2],pe=N[3],ce=N[4],ne=N[5],Re=N[6],Ae=N[7],de=N[8],Ne=N[9],ge=N[10],we=N[11],ye=N[12],Qt=N[13],Ce=N[14],Te=N[15];u=j[0],et+=u*le,ft+=u*re,_t+=u*fe,Tt+=u*pe,jt+=u*ce,Ot+=u*ne,Pe+=u*Re,me+=u*Ae,oe+=u*de,Mt+=u*Ne,Yt+=u*ge,Zt+=u*we,ae+=u*ye,kt+=u*Qt,Xt+=u*Ce,xt+=u*Te,u=j[1],ft+=u*le,_t+=u*re,Tt+=u*fe,jt+=u*pe,Ot+=u*ce,Pe+=u*ne,me+=u*Re,oe+=u*Ae,Mt+=u*de,Yt+=u*Ne,Zt+=u*ge,ae+=u*we,kt+=u*ye,Xt+=u*Qt,xt+=u*Ce,Vt+=u*Te,u=j[2],_t+=u*le,Tt+=u*re,jt+=u*fe,Ot+=u*pe,Pe+=u*ce,me+=u*ne,oe+=u*Re,Mt+=u*Ae,Yt+=u*de,Zt+=u*Ne,ae+=u*ge,kt+=u*we,Xt+=u*ye,xt+=u*Qt,Vt+=u*Ce,he+=u*Te,u=j[3],Tt+=u*le,jt+=u*re,Ot+=u*fe,Pe+=u*pe,me+=u*ce,oe+=u*ne,Mt+=u*Re,Yt+=u*Ae,Zt+=u*de,ae+=u*Ne,kt+=u*ge,Xt+=u*we,xt+=u*ye,Vt+=u*Qt,he+=u*Ce,$t+=u*Te,u=j[4],jt+=u*le,Ot+=u*re,Pe+=u*fe,me+=u*pe,oe+=u*ce,Mt+=u*ne,Yt+=u*Re,Zt+=u*Ae,ae+=u*de,kt+=u*Ne,Xt+=u*ge,xt+=u*we,Vt+=u*ye,he+=u*Qt,$t+=u*Ce,Oe+=u*Te,u=j[5],Ot+=u*le,Pe+=u*re,me+=u*fe,oe+=u*pe,Mt+=u*ce,Yt+=u*ne,Zt+=u*Re,ae+=u*Ae,kt+=u*de,Xt+=u*Ne,xt+=u*ge,Vt+=u*we,he+=u*ye,$t+=u*Qt,Oe+=u*Ce,qe+=u*Te,u=j[6],Pe+=u*le,me+=u*re,oe+=u*fe,Mt+=u*pe,Yt+=u*ce,Zt+=u*ne,ae+=u*Re,kt+=u*Ae,Xt+=u*de,xt+=u*Ne,Vt+=u*ge,he+=u*we,$t+=u*ye,Oe+=u*Qt,qe+=u*Ce,Ke+=u*Te,u=j[7],me+=u*le,oe+=u*re,Mt+=u*fe,Yt+=u*pe,Zt+=u*ce,ae+=u*ne,kt+=u*Re,Xt+=u*Ae,xt+=u*de,Vt+=u*Ne,he+=u*ge,$t+=u*we,Oe+=u*ye,qe+=u*Qt,Ke+=u*Ce,Ve+=u*Te,u=j[8],oe+=u*le,Mt+=u*re,Yt+=u*fe,Zt+=u*pe,ae+=u*ce,kt+=u*ne,Xt+=u*Re,xt+=u*Ae,Vt+=u*de,he+=u*Ne,$t+=u*ge,Oe+=u*we,qe+=u*ye,Ke+=u*Qt,Ve+=u*Ce,Ue+=u*Te,u=j[9],Mt+=u*le,Yt+=u*re,Zt+=u*fe,ae+=u*pe,kt+=u*ce,Xt+=u*ne,xt+=u*Re,Vt+=u*Ae,he+=u*de,$t+=u*Ne,Oe+=u*ge,qe+=u*we,Ke+=u*ye,Ve+=u*Qt,Ue+=u*Ce,Qe+=u*Te,u=j[10],Yt+=u*le,Zt+=u*re,ae+=u*fe,kt+=u*pe,Xt+=u*ce,xt+=u*ne,Vt+=u*Re,he+=u*Ae,$t+=u*de,Oe+=u*Ne,qe+=u*ge,Ke+=u*we,Ve+=u*ye,Ue+=u*Qt,Qe+=u*Ce,or+=u*Te,u=j[11],Zt+=u*le,ae+=u*re,kt+=u*fe,Xt+=u*pe,xt+=u*ce,Vt+=u*ne,he+=u*Re,$t+=u*Ae,Oe+=u*de,qe+=u*Ne,Ke+=u*ge,Ve+=u*we,Ue+=u*ye,Qe+=u*Qt,or+=u*Ce,Wr+=u*Te,u=j[12],ae+=u*le,kt+=u*re,Xt+=u*fe,xt+=u*pe,Vt+=u*ce,he+=u*ne,$t+=u*Re,Oe+=u*Ae,qe+=u*de,Ke+=u*Ne,Ve+=u*ge,Ue+=u*we,Qe+=u*ye,or+=u*Qt,Wr+=u*Ce,Ye+=u*Te,u=j[13],kt+=u*le,Xt+=u*re,xt+=u*fe,Vt+=u*pe,he+=u*ce,$t+=u*ne,Oe+=u*Re,qe+=u*Ae,Ke+=u*de,Ve+=u*Ne,Ue+=u*ge,Qe+=u*we,or+=u*ye,Wr+=u*Qt,Ye+=u*Ce,Xr+=u*Te,u=j[14],Xt+=u*le,xt+=u*re,Vt+=u*fe,he+=u*pe,$t+=u*ce,Oe+=u*ne,qe+=u*Re,Ke+=u*Ae,Ve+=u*de,Ue+=u*Ne,Qe+=u*ge,or+=u*we,Wr+=u*ye,Ye+=u*Qt,Xr+=u*Ce,wn+=u*Te,u=j[15],xt+=u*le,Vt+=u*re,he+=u*fe,$t+=u*pe,Oe+=u*ce,qe+=u*ne,Ke+=u*Re,Ve+=u*Ae,Ue+=u*de,Qe+=u*Ne,or+=u*ge,Wr+=u*we,Ye+=u*ye,Xr+=u*Qt,wn+=u*Ce,Ln+=u*Te,et+=38*Vt,ft+=38*he,_t+=38*$t,Tt+=38*Oe,jt+=38*qe,Ot+=38*Ke,Pe+=38*Ve,me+=38*Ue,oe+=38*Qe,Mt+=38*or,Yt+=38*Wr,Zt+=38*Ye,ae+=38*Xr,kt+=38*wn,Xt+=38*Ln,I=1,u=et+I+65535,I=Math.floor(u/65536),et=u-I*65536,u=ft+I+65535,I=Math.floor(u/65536),ft=u-I*65536,u=_t+I+65535,I=Math.floor(u/65536),_t=u-I*65536,u=Tt+I+65535,I=Math.floor(u/65536),Tt=u-I*65536,u=jt+I+65535,I=Math.floor(u/65536),jt=u-I*65536,u=Ot+I+65535,I=Math.floor(u/65536),Ot=u-I*65536,u=Pe+I+65535,I=Math.floor(u/65536),Pe=u-I*65536,u=me+I+65535,I=Math.floor(u/65536),me=u-I*65536,u=oe+I+65535,I=Math.floor(u/65536),oe=u-I*65536,u=Mt+I+65535,I=Math.floor(u/65536),Mt=u-I*65536,u=Yt+I+65535,I=Math.floor(u/65536),Yt=u-I*65536,u=Zt+I+65535,I=Math.floor(u/65536),Zt=u-I*65536,u=ae+I+65535,I=Math.floor(u/65536),ae=u-I*65536,u=kt+I+65535,I=Math.floor(u/65536),kt=u-I*65536,u=Xt+I+65535,I=Math.floor(u/65536),Xt=u-I*65536,u=xt+I+65535,I=Math.floor(u/65536),xt=u-I*65536,et+=I-1+37*(I-1),I=1,u=et+I+65535,I=Math.floor(u/65536),et=u-I*65536,u=ft+I+65535,I=Math.floor(u/65536),ft=u-I*65536,u=_t+I+65535,I=Math.floor(u/65536),_t=u-I*65536,u=Tt+I+65535,I=Math.floor(u/65536),Tt=u-I*65536,u=jt+I+65535,I=Math.floor(u/65536),jt=u-I*65536,u=Ot+I+65535,I=Math.floor(u/65536),Ot=u-I*65536,u=Pe+I+65535,I=Math.floor(u/65536),Pe=u-I*65536,u=me+I+65535,I=Math.floor(u/65536),me=u-I*65536,u=oe+I+65535,I=Math.floor(u/65536),oe=u-I*65536,u=Mt+I+65535,I=Math.floor(u/65536),Mt=u-I*65536,u=Yt+I+65535,I=Math.floor(u/65536),Yt=u-I*65536,u=Zt+I+65535,I=Math.floor(u/65536),Zt=u-I*65536,u=ae+I+65535,I=Math.floor(u/65536),ae=u-I*65536,u=kt+I+65535,I=Math.floor(u/65536),kt=u-I*65536,u=Xt+I+65535,I=Math.floor(u/65536),Xt=u-I*65536,u=xt+I+65535,I=Math.floor(u/65536),xt=u-I*65536,et+=I-1+37*(I-1),L[0]=et,L[1]=ft,L[2]=_t,L[3]=Tt,L[4]=jt,L[5]=Ot,L[6]=Pe,L[7]=me,L[8]=oe,L[9]=Mt,L[10]=Yt,L[11]=Zt,L[12]=ae,L[13]=kt,L[14]=Xt,L[15]=xt}function G(L,j){H(L,j,j)}function wt(L,j){const N=a();let u;for(u=0;u<16;u++)N[u]=j[u];for(u=253;u>=0;u--)G(N,N),u!==2&&u!==4&&H(N,N,j);for(u=0;u<16;u++)L[u]=N[u]}function nt(L,j){const N=a();let u;for(u=0;u<16;u++)N[u]=j[u];for(u=250;u>=0;u--)G(N,N),u!==1&&H(N,N,j);for(u=0;u<16;u++)L[u]=N[u]}function st(L,j){const N=a(),u=a(),I=a(),et=a(),ft=a(),_t=a(),Tt=a(),jt=a(),Ot=a();q(N,L[1],L[0]),q(Ot,j[1],j[0]),H(N,N,Ot),lt(u,L[0],L[1]),lt(Ot,j[0],j[1]),H(u,u,Ot),H(I,L[3],j[3]),H(I,I,y),H(et,L[2],j[2]),lt(et,et,et),q(ft,u,N),q(_t,et,I),lt(Tt,et,I),lt(jt,u,N),H(L[0],ft,_t),H(L[1],jt,Tt),H(L[2],Tt,_t),H(L[3],ft,jt)}function qt(L,j,N){for(let u=0;u<4;u++)W(L[u],j[u],N)}function Dt(L,j){const N=a(),u=a(),I=a();wt(I,j[2]),H(N,j[0],I),H(u,j[1],I),tt(L,u),L[31]^=ut(N)<<7}function m(L,j,N){$(L[0],f),$(L[1],g),$(L[2],g),$(L[3],f);for(let u=255;u>=0;--u){const I=N[u/8|0]>>(u&7)&1;qt(L,j,I),st(j,L),st(L,L),qt(L,j,I)}}function S(L,j){const N=[a(),a(),a(),a()];$(N[0],E),$(N[1],R),$(N[2],g),H(N[3],E,R),m(L,N,j)}function Y(L){if(L.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const j=(0,r.hash)(L);j[0]&=248,j[31]&=127,j[31]|=64;const N=new Uint8Array(32),u=[a(),a(),a(),a()];S(u,j),Dt(N,u);const I=new Uint8Array(64);return I.set(L),I.set(N,32),{publicKey:N,secretKey:I}}i.generateKeyPairFromSeed=Y;function dt(L){const j=(0,e.randomBytes)(32,L),N=Y(j);return(0,s.wipe)(j),N}i.generateKeyPair=dt;function B(L){if(L.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}i.extractPublicKeyFromSecretKey=B;const k=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function V(L,j){let N,u,I,et;for(u=63;u>=32;--u){for(N=0,I=u-32,et=u-12;I<et;++I)j[I]+=N-16*j[u]*k[I-(u-32)],N=Math.floor((j[I]+128)/256),j[I]-=N*256;j[I]+=N,j[u]=0}for(N=0,I=0;I<32;I++)j[I]+=N-(j[31]>>4)*k[I],N=j[I]>>8,j[I]&=255;for(I=0;I<32;I++)j[I]-=N*k[I];for(u=0;u<32;u++)j[u+1]+=j[u]>>8,L[u]=j[u]&255}function F(L){const j=new Float64Array(64);for(let N=0;N<64;N++)j[N]=L[N];for(let N=0;N<64;N++)L[N]=0;V(L,j)}function Jt(L,j){const N=new Float64Array(64),u=[a(),a(),a(),a()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const et=new Uint8Array(64);et.set(I.subarray(32),32);const ft=new r.SHA512;ft.update(et.subarray(32)),ft.update(j);const _t=ft.digest();ft.clean(),F(_t),S(u,_t),Dt(et,u),ft.reset(),ft.update(et.subarray(0,32)),ft.update(L.subarray(32)),ft.update(j);const Tt=ft.digest();F(Tt);for(let jt=0;jt<32;jt++)N[jt]=_t[jt];for(let jt=0;jt<32;jt++)for(let Ot=0;Ot<32;Ot++)N[jt+Ot]+=Tt[jt]*I[Ot];return V(et.subarray(32),N),et}i.sign=Jt;function Kt(L,j){const N=a(),u=a(),I=a(),et=a(),ft=a(),_t=a(),Tt=a();return $(L[2],g),ht(L[1],j),G(I,L[1]),H(et,I,b),q(I,I,L[2]),lt(et,L[2],et),G(ft,et),G(_t,ft),H(Tt,_t,ft),H(N,Tt,I),H(N,N,et),nt(N,N),H(N,N,I),H(N,N,et),H(N,N,et),H(L[0],N,et),G(u,L[0]),H(u,u,et),pt(u,I)&&H(L[0],L[0],x),G(u,L[0]),H(u,u,et),pt(u,I)?-1:(ut(L[0])===j[31]>>7&&q(L[0],f,L[0]),H(L[3],L[0],L[1]),0)}function Vr(L,j,N){const u=new Uint8Array(32),I=[a(),a(),a(),a()],et=[a(),a(),a(),a()];if(N.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(Kt(et,L))return!1;const ft=new r.SHA512;ft.update(N.subarray(0,32)),ft.update(L),ft.update(j);const _t=ft.digest();return F(_t),m(I,et,_t),S(et,N.subarray(32)),st(I,et),Dt(u,I),!yt(N,u)}i.verify=Vr;function It(L){let j=[a(),a(),a(),a()];if(Kt(j,L))throw new Error("Ed25519: invalid public key");let N=a(),u=a(),I=j[1];lt(N,g,I),q(u,g,I),wt(u,u),H(N,N,u);let et=new Uint8Array(32);return tt(et,N),et}i.convertPublicKeyToX25519=It;function Se(L){const j=(0,r.hash)(L.subarray(0,32));j[0]&=248,j[31]&=127,j[31]|=64;const N=new Uint8Array(j.subarray(0,32));return(0,s.wipe)(j),N}i.convertSecretKeyToX25519=Se})(Fc);const Y0="EdDSA",Z0="JWT",Qf=".",Yf="base64url",X0="utf8",t1="utf8",e1=":",r1="did",n1="key",Dl="base58btc",i1="z",s1="K36",o1=32;function xo(i){return sr(gr(Qn(i),X0),Yf)}function Zf(i){const e=gr(s1,Dl),r=i1+sr(Oc([e,i]),Dl);return[r1,n1,r].join(e1)}function a1(i){return sr(i,Yf)}function c1(i){return gr([xo(i.header),xo(i.payload)].join(Qf),t1)}function u1(i){return[xo(i.header),xo(i.payload),a1(i.signature)].join(Qf)}function Ml(i=qo.randomBytes(o1)){return Fc.generateKeyPairFromSeed(i)}async function h1(i,e,r,s,a=it.fromMiliseconds(Date.now())){const h={alg:Y0,typ:Z0},f=Zf(s.publicKey),g=a+r,b={iss:f,sub:i,aud:e,iat:a,exp:g},y=c1({header:h,payload:b}),E=Fc.sign(s.secretKey,y);return u1({header:h,payload:b,signature:E})}const l1="PARSE_ERROR",f1="INVALID_REQUEST",p1="METHOD_NOT_FOUND",d1="INVALID_PARAMS",Xf="INTERNAL_ERROR",Gc="SERVER_ERROR",g1=[-32700,-32600,-32601,-32602,-32603],as={[l1]:{code:-32700,message:"Parse error"},[f1]:{code:-32600,message:"Invalid Request"},[p1]:{code:-32601,message:"Method not found"},[d1]:{code:-32602,message:"Invalid params"},[Xf]:{code:-32603,message:"Internal error"},[Gc]:{code:-32e3,message:"Server error"}},tp=Gc;function y1(i){return g1.includes(i)}function Ul(i){return Object.keys(as).includes(i)?as[i]:as[tp]}function v1(i){return Object.values(as).find(r=>r.code===i)||as[tp]}function ep(i,e,r){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):i}var rp={},fn={},$l;function m1(){if($l)return fn;$l=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.isBrowserCryptoAvailable=fn.getSubtleCrypto=fn.getBrowerCrypto=void 0;function i(){return(Kr===null||Kr===void 0?void 0:Kr.crypto)||(Kr===null||Kr===void 0?void 0:Kr.msCrypto)||{}}fn.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}fn.getSubtleCrypto=e;function r(){return!!i()&&!!e()}return fn.isBrowserCryptoAvailable=r,fn}var pn={},zl;function w1(){if(zl)return pn;zl=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.isBrowser=pn.isNode=pn.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}pn.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}pn.isNode=e;function r(){return!i()&&!e()}return pn.isBrowser=r,pn}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Ri;e.__exportStar(m1(),i),e.__exportStar(w1(),i)})(rp);function Jc(i=3){const e=Date.now()*Math.pow(10,i),r=Math.floor(Math.random()*Math.pow(10,i));return e+r}function np(i=6){return BigInt(Jc(i))}function Oi(i,e,r){return{id:r||Jc(),jsonrpc:"2.0",method:i,params:e}}function Qc(i,e){return{id:i,jsonrpc:"2.0",result:e}}function Do(i,e,r){return{id:i,jsonrpc:"2.0",error:b1(e,r)}}function b1(i,e){return typeof i>"u"?Ul(Xf):(typeof i=="string"&&(i=Object.assign(Object.assign({},Ul(Gc)),{message:i})),typeof e<"u"&&(i.data=e),y1(i.code)&&(i=v1(i.code)),i)}class _1{}class E1 extends _1{constructor(){super()}}class I1 extends E1{constructor(e){super()}}const S1="^https?:",P1="^wss?:";function O1(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function ip(i,e){const r=O1(i);return typeof r>"u"?!1:new RegExp(e).test(r)}function kl(i){return ip(i,S1)}function Hl(i){return ip(i,P1)}function R1(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function sp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function Yc(i){return sp(i)&&"method"in i}function Mo(i){return sp(i)&&(yn(i)||Hr(i))}function yn(i){return"result"in i}function Hr(i){return"error"in i}class vn extends I1{constructor(e){super(e),this.events=new jr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Oi(e.method,e.params||[],e.id||np().toString()),r)}async requestStrict(e,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${e.id}`,h=>{Hr(h)?a(h.error):s(h.result)});try{await this.connection.send(e,r)}catch(h){a(h)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Mo(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const A1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),N1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Kl=i=>i.split("?")[0],Vl=10,C1=A1();let T1=class{constructor(i){if(this.url=i,this.events=new jr.EventEmitter,this.registering=!1,!Hl(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,e){this.events.on(i,e)}once(i,e){this.events.once(i,e)}off(i,e){this.events.off(i,e)}removeListener(i,e){this.events.removeListener(i,e)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,e)=>{if(typeof this.socket>"u"){e(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),i()},this.socket.close()})}async send(i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qn(i))}catch(e){this.onError(i.id,e)}}register(i=this.url){if(!Hl(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((r,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=i,this.registering=!0,new Promise((e,r)=>{const s=new URLSearchParams(i).get("origin"),a=rp.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!R1(i)},h=new C1(i,[],a);N1()?h.onerror=f=>{const g=f;r(this.emitError(g.error))}:h.on("error",f=>{r(this.emitError(f))}),h.onopen=()=>{this.onOpen(h),e(h)}})}onOpen(i){i.onmessage=e=>this.onPayload(e),i.onclose=e=>this.onClose(e),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const e=typeof i.data=="string"?fs(i.data):i.data;this.events.emit("payload",e)}onError(i,e){const r=this.parseError(e),s=r.message||r.toString(),a=Do(i,s);this.events.emit("payload",a)}parseError(i,e=this.url){return ep(i,Kl(e),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Vl&&this.events.setMaxListeners(Vl)}emitError(i){const e=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${Kl(this.url)}`));return this.events.emit("register_error",e),e}};var jo={exports:{}};jo.exports;(function(i,e){var r=200,s="__lodash_hash_undefined__",a=1,h=2,f=9007199254740991,g="[object Arguments]",b="[object Array]",y="[object AsyncFunction]",E="[object Boolean]",R="[object Date]",x="[object Error]",$="[object Function]",C="[object GeneratorFunction]",W="[object Map]",tt="[object Number]",yt="[object Null]",pt="[object Object]",ut="[object Promise]",ht="[object Proxy]",lt="[object RegExp]",q="[object Set]",H="[object String]",G="[object Symbol]",wt="[object Undefined]",nt="[object WeakMap]",st="[object ArrayBuffer]",qt="[object DataView]",Dt="[object Float32Array]",m="[object Float64Array]",S="[object Int8Array]",Y="[object Int16Array]",dt="[object Int32Array]",B="[object Uint8Array]",k="[object Uint8ClampedArray]",V="[object Uint16Array]",F="[object Uint32Array]",Jt=/[\\^$.*+?()[\]{}|]/g,Kt=/^\[object .+?Constructor\]$/,Vr=/^(?:0|[1-9]\d*)$/,It={};It[Dt]=It[m]=It[S]=It[Y]=It[dt]=It[B]=It[k]=It[V]=It[F]=!0,It[g]=It[b]=It[st]=It[E]=It[qt]=It[R]=It[x]=It[$]=It[W]=It[tt]=It[pt]=It[lt]=It[q]=It[H]=It[nt]=!1;var Se=typeof Kr=="object"&&Kr&&Kr.Object===Object&&Kr,L=typeof self=="object"&&self&&self.Object===Object&&self,j=Se||L||Function("return this")(),N=e&&!e.nodeType&&e,u=N&&!0&&i&&!i.nodeType&&i,I=u&&u.exports===N,et=I&&Se.process,ft=function(){try{return et&&et.binding&&et.binding("util")}catch{}}(),_t=ft&&ft.isTypedArray;function Tt(v,O){for(var z=-1,Z=v==null?0:v.length,Bt=0,mt=[];++z<Z;){var te=v[z];O(te,z,v)&&(mt[Bt++]=te)}return mt}function jt(v,O){for(var z=-1,Z=O.length,Bt=v.length;++z<Z;)v[Bt+z]=O[z];return v}function Ot(v,O){for(var z=-1,Z=v==null?0:v.length;++z<Z;)if(O(v[z],z,v))return!0;return!1}function Pe(v,O){for(var z=-1,Z=Array(v);++z<v;)Z[z]=O(z);return Z}function me(v){return function(O){return v(O)}}function oe(v,O){return v.has(O)}function Mt(v,O){return v==null?void 0:v[O]}function Yt(v){var O=-1,z=Array(v.size);return v.forEach(function(Z,Bt){z[++O]=[Bt,Z]}),z}function Zt(v,O){return function(z){return v(O(z))}}function ae(v){var O=-1,z=Array(v.size);return v.forEach(function(Z){z[++O]=Z}),z}var kt=Array.prototype,Xt=Function.prototype,xt=Object.prototype,Vt=j["__core-js_shared__"],he=Xt.toString,$t=xt.hasOwnProperty,Oe=function(){var v=/[^.]+$/.exec(Vt&&Vt.keys&&Vt.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),qe=xt.toString,Ke=RegExp("^"+he.call($t).replace(Jt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ve=I?j.Buffer:void 0,Ue=j.Symbol,Qe=j.Uint8Array,or=xt.propertyIsEnumerable,Wr=kt.splice,Ye=Ue?Ue.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,wn=Ve?Ve.isBuffer:void 0,Ln=Zt(Object.keys,Object),le=yr(j,"DataView"),re=yr(j,"Map"),fe=yr(j,"Promise"),pe=yr(j,"Set"),ce=yr(j,"WeakMap"),ne=yr(Object,"create"),Re=en(le),Ae=en(re),de=en(fe),Ne=en(pe),ge=en(ce),we=Ue?Ue.prototype:void 0,ye=we?we.valueOf:void 0;function Qt(v){var O=-1,z=v==null?0:v.length;for(this.clear();++O<z;){var Z=v[O];this.set(Z[0],Z[1])}}function Ce(){this.__data__=ne?ne(null):{},this.size=0}function Te(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}function zo(v){var O=this.__data__;if(ne){var z=O[v];return z===s?void 0:z}return $t.call(O,v)?O[v]:void 0}function ko(v){var O=this.__data__;return ne?O[v]!==void 0:$t.call(O,v)}function Ho(v,O){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=ne&&O===void 0?s:O,this}Qt.prototype.clear=Ce,Qt.prototype.delete=Te,Qt.prototype.get=zo,Qt.prototype.has=ko,Qt.prototype.set=Ho;function Ir(v){var O=-1,z=v==null?0:v.length;for(this.clear();++O<z;){var Z=v[O];this.set(Z[0],Z[1])}}function Ko(){this.__data__=[],this.size=0}function Vo(v){var O=this.__data__,z=qn(O,v);if(z<0)return!1;var Z=O.length-1;return z==Z?O.pop():Wr.call(O,z,1),--this.size,!0}function Wo(v){var O=this.__data__,z=qn(O,v);return z<0?void 0:O[z][1]}function Bo(v){return qn(this.__data__,v)>-1}function Fo(v,O){var z=this.__data__,Z=qn(z,v);return Z<0?(++this.size,z.push([v,O])):z[Z][1]=O,this}Ir.prototype.clear=Ko,Ir.prototype.delete=Vo,Ir.prototype.get=Wo,Ir.prototype.has=Bo,Ir.prototype.set=Fo;function tn(v){var O=-1,z=v==null?0:v.length;for(this.clear();++O<z;){var Z=v[O];this.set(Z[0],Z[1])}}function ei(){this.size=0,this.__data__={hash:new Qt,map:new(re||Ir),string:new Qt}}function Go(v){var O=bn(this,v).delete(v);return this.size-=O?1:0,O}function ri(v){return bn(this,v).get(v)}function Jo(v){return bn(this,v).has(v)}function Qo(v,O){var z=bn(this,v),Z=z.size;return z.set(v,O),this.size+=z.size==Z?0:1,this}tn.prototype.clear=ei,tn.prototype.delete=Go,tn.prototype.get=ri,tn.prototype.has=Jo,tn.prototype.set=Qo;function ni(v){var O=-1,z=v==null?0:v.length;for(this.__data__=new tn;++O<z;)this.add(v[O])}function ds(v){return this.__data__.set(v,s),this}function gs(v){return this.__data__.has(v)}ni.prototype.add=ni.prototype.push=ds,ni.prototype.has=gs;function Lr(v){var O=this.__data__=new Ir(v);this.size=O.size}function Yo(){this.__data__=new Ir,this.size=0}function Zo(v){var O=this.__data__,z=O.delete(v);return this.size=O.size,z}function Xo(v){return this.__data__.get(v)}function ta(v){return this.__data__.has(v)}function ys(v,O){var z=this.__data__;if(z instanceof Ir){var Z=z.__data__;if(!re||Z.length<r-1)return Z.push([v,O]),this.size=++z.size,this;z=this.__data__=new tn(Z)}return z.set(v,O),this.size=z.size,this}Lr.prototype.clear=Yo,Lr.prototype.delete=Zo,Lr.prototype.get=Xo,Lr.prototype.has=ta,Lr.prototype.set=ys;function vs(v,O){var z=oi(v),Z=!z&&Ns(v),Bt=!z&&!Z&&Li(v),mt=!z&&!Z&&!Bt&&xs(v),te=z||Z||Bt||mt,xe=te?Pe(v.length,String):[],At=xe.length;for(var Ft in v)(O||$t.call(v,Ft))&&!(te&&(Ft=="length"||Bt&&(Ft=="offset"||Ft=="parent")||mt&&(Ft=="buffer"||Ft=="byteLength"||Ft=="byteOffset")||Ss(Ft,At)))&&xe.push(Ft);return xe}function qn(v,O){for(var z=v.length;z--;)if(As(v[z][0],O))return z;return-1}function xi(v,O,z){var Z=O(v);return oi(v)?Z:jt(Z,z(v))}function Dn(v){return v==null?v===void 0?wt:yt:Ye&&Ye in Object(v)?Es(v):na(v)}function ji(v){return Un(v)&&Dn(v)==g}function Mn(v,O,z,Z,Bt){return v===O?!0:v==null||O==null||!Un(v)&&!Un(O)?v!==v&&O!==O:ms(v,O,z,Z,Mn,Bt)}function ms(v,O,z,Z,Bt,mt){var te=oi(v),xe=oi(O),At=te?b:Br(v),Ft=xe?b:Br(O);At=At==g?pt:At,Ft=Ft==g?pt:Ft;var be=At==pt,ar=Ft==pt,je=At==Ft;if(je&&Li(v)){if(!Li(O))return!1;te=!0,be=!1}if(je&&!be)return mt||(mt=new Lr),te||xs(v)?ii(v,O,z,Z,Bt,mt):ra(v,O,At,z,Z,Bt,mt);if(!(z&a)){var ee=be&&$t.call(v,"__wrapped__"),Ze=ar&&$t.call(O,"__wrapped__");if(ee||Ze){var qr=ee?v.value():v,Sr=Ze?O.value():O;return mt||(mt=new Lr),Bt(qr,Sr,z,Z,mt)}}return je?(mt||(mt=new Lr),_s(v,O,z,Z,Bt,mt)):!1}function ea(v){if(!Ts(v)||Os(v))return!1;var O=ai(v)?Ke:Kt;return O.test(en(v))}function ws(v){return Un(v)&&Cs(v.length)&&!!It[Dn(v)]}function bs(v){if(!Rs(v))return Ln(v);var O=[];for(var z in Object(v))$t.call(v,z)&&z!="constructor"&&O.push(z);return O}function ii(v,O,z,Z,Bt,mt){var te=z&a,xe=v.length,At=O.length;if(xe!=At&&!(te&&At>xe))return!1;var Ft=mt.get(v);if(Ft&&mt.get(O))return Ft==O;var be=-1,ar=!0,je=z&h?new ni:void 0;for(mt.set(v,O),mt.set(O,v);++be<xe;){var ee=v[be],Ze=O[be];if(Z)var qr=te?Z(Ze,ee,be,O,v,mt):Z(ee,Ze,be,v,O,mt);if(qr!==void 0){if(qr)continue;ar=!1;break}if(je){if(!Ot(O,function(Sr,Fr){if(!oe(je,Fr)&&(ee===Sr||Bt(ee,Sr,z,Z,mt)))return je.push(Fr)})){ar=!1;break}}else if(!(ee===Ze||Bt(ee,Ze,z,Z,mt))){ar=!1;break}}return mt.delete(v),mt.delete(O),ar}function ra(v,O,z,Z,Bt,mt,te){switch(z){case qt:if(v.byteLength!=O.byteLength||v.byteOffset!=O.byteOffset)return!1;v=v.buffer,O=O.buffer;case st:return!(v.byteLength!=O.byteLength||!mt(new Qe(v),new Qe(O)));case E:case R:case tt:return As(+v,+O);case x:return v.name==O.name&&v.message==O.message;case lt:case H:return v==O+"";case W:var xe=Yt;case q:var At=Z&a;if(xe||(xe=ae),v.size!=O.size&&!At)return!1;var Ft=te.get(v);if(Ft)return Ft==O;Z|=h,te.set(v,O);var be=ii(xe(v),xe(O),Z,Bt,mt,te);return te.delete(v),be;case G:if(ye)return ye.call(v)==ye.call(O)}return!1}function _s(v,O,z,Z,Bt,mt){var te=z&a,xe=si(v),At=xe.length,Ft=si(O),be=Ft.length;if(At!=be&&!te)return!1;for(var ar=At;ar--;){var je=xe[ar];if(!(te?je in O:$t.call(O,je)))return!1}var ee=mt.get(v);if(ee&&mt.get(O))return ee==O;var Ze=!0;mt.set(v,O),mt.set(O,v);for(var qr=te;++ar<At;){je=xe[ar];var Sr=v[je],Fr=O[je];if(Z)var qi=te?Z(Fr,Sr,je,O,v,mt):Z(Sr,Fr,je,v,O,mt);if(!(qi===void 0?Sr===Fr||Bt(Sr,Fr,z,Z,mt):qi)){Ze=!1;break}qr||(qr=je=="constructor")}if(Ze&&!qr){var $n=v.constructor,$e=O.constructor;$n!=$e&&"constructor"in v&&"constructor"in O&&!(typeof $n=="function"&&$n instanceof $n&&typeof $e=="function"&&$e instanceof $e)&&(Ze=!1)}return mt.delete(v),mt.delete(O),Ze}function si(v){return xi(v,oa,Is)}function bn(v,O){var z=v.__data__;return Ps(O)?z[typeof O=="string"?"string":"hash"]:z.map}function yr(v,O){var z=Mt(v,O);return ea(z)?z:void 0}function Es(v){var O=$t.call(v,Ye),z=v[Ye];try{v[Ye]=void 0;var Z=!0}catch{}var Bt=qe.call(v);return Z&&(O?v[Ye]=z:delete v[Ye]),Bt}var Is=Xr?function(v){return v==null?[]:(v=Object(v),Tt(Xr(v),function(O){return or.call(v,O)}))}:Wt,Br=Dn;(le&&Br(new le(new ArrayBuffer(1)))!=qt||re&&Br(new re)!=W||fe&&Br(fe.resolve())!=ut||pe&&Br(new pe)!=q||ce&&Br(new ce)!=nt)&&(Br=function(v){var O=Dn(v),z=O==pt?v.constructor:void 0,Z=z?en(z):"";if(Z)switch(Z){case Re:return qt;case Ae:return W;case de:return ut;case Ne:return q;case ge:return nt}return O});function Ss(v,O){return O=O??f,!!O&&(typeof v=="number"||Vr.test(v))&&v>-1&&v%1==0&&v<O}function Ps(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}function Os(v){return!!Oe&&Oe in v}function Rs(v){var O=v&&v.constructor,z=typeof O=="function"&&O.prototype||xt;return v===z}function na(v){return qe.call(v)}function en(v){if(v!=null){try{return he.call(v)}catch{}try{return v+""}catch{}}return""}function As(v,O){return v===O||v!==v&&O!==O}var Ns=ji(function(){return arguments}())?ji:function(v){return Un(v)&&$t.call(v,"callee")&&!or.call(v,"callee")},oi=Array.isArray;function ia(v){return v!=null&&Cs(v.length)&&!ai(v)}var Li=wn||Ht;function sa(v,O){return Mn(v,O)}function ai(v){if(!Ts(v))return!1;var O=Dn(v);return O==$||O==C||O==y||O==ht}function Cs(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function Ts(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}function Un(v){return v!=null&&typeof v=="object"}var xs=_t?me(_t):ws;function oa(v){return ia(v)?vs(v):bs(v)}function Wt(){return[]}function Ht(){return!1}i.exports=sa})(jo,jo.exports);var x1=jo.exports;const j1=Af(x1);function L1(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<i.length;a++){var h=i.charAt(a),f=h.charCodeAt(0);if(r[f]!==255)throw new TypeError(h+" is ambiguous");r[f]=a}var g=i.length,b=i.charAt(0),y=Math.log(g)/Math.log(256),E=Math.log(256)/Math.log(g);function R(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var W=0,tt=0,yt=0,pt=C.length;yt!==pt&&C[yt]===0;)yt++,W++;for(var ut=(pt-yt)*E+1>>>0,ht=new Uint8Array(ut);yt!==pt;){for(var lt=C[yt],q=0,H=ut-1;(lt!==0||q<tt)&&H!==-1;H--,q++)lt+=256*ht[H]>>>0,ht[H]=lt%g>>>0,lt=lt/g>>>0;if(lt!==0)throw new Error("Non-zero carry");tt=q,yt++}for(var G=ut-tt;G!==ut&&ht[G]===0;)G++;for(var wt=b.repeat(W);G<ut;++G)wt+=i.charAt(ht[G]);return wt}function x(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var W=0;if(C[W]!==" "){for(var tt=0,yt=0;C[W]===b;)tt++,W++;for(var pt=(C.length-W)*y+1>>>0,ut=new Uint8Array(pt);C[W];){var ht=r[C.charCodeAt(W)];if(ht===255)return;for(var lt=0,q=pt-1;(ht!==0||lt<yt)&&q!==-1;q--,lt++)ht+=g*ut[q]>>>0,ut[q]=ht%256>>>0,ht=ht/256>>>0;if(ht!==0)throw new Error("Non-zero carry");yt=lt,W++}if(C[W]!==" "){for(var H=pt-yt;H!==pt&&ut[H]===0;)H++;for(var G=new Uint8Array(tt+(pt-H)),wt=tt;H!==pt;)G[wt++]=ut[H++];return G}}}function $(C){var W=x(C);if(W)return W;throw new Error(`Non-${e} character`)}return{encode:R,decodeUnsafe:x,decode:$}}var q1=L1,D1=q1;const op=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},M1=i=>new TextEncoder().encode(i),U1=i=>new TextDecoder().decode(i);class $1{constructor(e,r,s){this.name=e,this.prefix=r,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class z1{constructor(e,r,s){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ap(this,e)}}let k1=class{constructor(i){this.decoders=i}or(i){return ap(this,i)}decode(i){const e=i[0],r=this.decoders[e];if(r)return r.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const ap=(i,e)=>new k1({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class H1{constructor(e,r,s,a){this.name=e,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new $1(e,r,s),this.decoder=new z1(e,r,a)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Uo=({name:i,prefix:e,encode:r,decode:s})=>new H1(i,e,r,s),ps=({prefix:i,name:e,alphabet:r})=>{const{encode:s,decode:a}=D1(r,e);return Uo({prefix:i,name:e,encode:s,decode:h=>op(a(h))})},K1=(i,e,r,s)=>{const a={};for(let E=0;E<e.length;++E)a[e[E]]=E;let h=i.length;for(;i[h-1]==="=";)--h;const f=new Uint8Array(h*r/8|0);let g=0,b=0,y=0;for(let E=0;E<h;++E){const R=a[i[E]];if(R===void 0)throw new SyntaxError(`Non-${s} character`);b=b<<r|R,g+=r,g>=8&&(g-=8,f[y++]=255&b>>g)}if(g>=r||255&b<<8-g)throw new SyntaxError("Unexpected end of data");return f},V1=(i,e,r)=>{const s=e[e.length-1]==="=",a=(1<<r)-1;let h="",f=0,g=0;for(let b=0;b<i.length;++b)for(g=g<<8|i[b],f+=8;f>r;)f-=r,h+=e[a&g>>f];if(f&&(h+=e[a&g<<r-f]),s)for(;h.length*r&7;)h+="=";return h},Be=({name:i,prefix:e,bitsPerChar:r,alphabet:s})=>Uo({prefix:e,name:i,encode(a){return V1(a,s,r)},decode(a){return K1(a,s,r,i)}}),W1=Uo({prefix:"\0",name:"identity",encode:i=>U1(i),decode:i=>M1(i)});var B1=Object.freeze({__proto__:null,identity:W1});const F1=Be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var G1=Object.freeze({__proto__:null,base2:F1});const J1=Be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Q1=Object.freeze({__proto__:null,base8:J1});const Y1=ps({prefix:"9",name:"base10",alphabet:"0123456789"});var Z1=Object.freeze({__proto__:null,base10:Y1});const X1=Be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tE=Be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var eE=Object.freeze({__proto__:null,base16:X1,base16upper:tE});const rE=Be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nE=Be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),iE=Be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sE=Be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oE=Be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aE=Be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cE=Be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uE=Be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hE=Be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lE=Object.freeze({__proto__:null,base32:rE,base32upper:nE,base32pad:iE,base32padupper:sE,base32hex:oE,base32hexupper:aE,base32hexpad:cE,base32hexpadupper:uE,base32z:hE});const fE=ps({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pE=ps({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var dE=Object.freeze({__proto__:null,base36:fE,base36upper:pE});const gE=ps({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yE=ps({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vE=Object.freeze({__proto__:null,base58btc:gE,base58flickr:yE});const mE=Be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wE=Be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),bE=Be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_E=Be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var EE=Object.freeze({__proto__:null,base64:mE,base64pad:wE,base64url:bE,base64urlpad:_E});const cp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),IE=cp.reduce((i,e,r)=>(i[r]=e,i),[]),SE=cp.reduce((i,e,r)=>(i[e.codePointAt(0)]=r,i),[]);function PE(i){return i.reduce((e,r)=>(e+=IE[r],e),"")}function OE(i){const e=[];for(const r of i){const s=SE[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const RE=Uo({prefix:"🚀",name:"base256emoji",encode:PE,decode:OE});var AE=Object.freeze({__proto__:null,base256emoji:RE}),NE=up,Wl=128,CE=127,TE=~CE,xE=Math.pow(2,31);function up(i,e,r){e=e||[],r=r||0;for(var s=r;i>=xE;)e[r++]=i&255|Wl,i/=128;for(;i&TE;)e[r++]=i&255|Wl,i>>>=7;return e[r]=i|0,up.bytes=r-s+1,e}var jE=xc,LE=128,Bl=127;function xc(i,s){var r=0,s=s||0,a=0,h=s,f,g=i.length;do{if(h>=g)throw xc.bytes=0,new RangeError("Could not decode varint");f=i[h++],r+=a<28?(f&Bl)<<a:(f&Bl)*Math.pow(2,a),a+=7}while(f>=LE);return xc.bytes=h-s,r}var qE=Math.pow(2,7),DE=Math.pow(2,14),ME=Math.pow(2,21),UE=Math.pow(2,28),$E=Math.pow(2,35),zE=Math.pow(2,42),kE=Math.pow(2,49),HE=Math.pow(2,56),KE=Math.pow(2,63),VE=function(i){return i<qE?1:i<DE?2:i<ME?3:i<UE?4:i<$E?5:i<zE?6:i<kE?7:i<HE?8:i<KE?9:10},WE={encode:NE,decode:jE,encodingLength:VE},hp=WE;const Fl=(i,e,r=0)=>(hp.encode(i,e,r),e),Gl=i=>hp.encodingLength(i),jc=(i,e)=>{const r=e.byteLength,s=Gl(i),a=s+Gl(r),h=new Uint8Array(a+r);return Fl(i,h,0),Fl(r,h,s),h.set(e,a),new BE(i,r,e,h)};class BE{constructor(e,r,s,a){this.code=e,this.size=r,this.digest=s,this.bytes=a}}const lp=({name:i,code:e,encode:r})=>new FE(i,e,r);class FE{constructor(e,r,s){this.name=e,this.code=r,this.encode=s}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?jc(this.code,r):r.then(s=>jc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const fp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),GE=lp({name:"sha2-256",code:18,encode:fp("SHA-256")}),JE=lp({name:"sha2-512",code:19,encode:fp("SHA-512")});var QE=Object.freeze({__proto__:null,sha256:GE,sha512:JE});const pp=0,YE="identity",dp=op,ZE=i=>jc(pp,dp(i)),XE={code:pp,name:YE,encode:dp,digest:ZE};var tI=Object.freeze({__proto__:null,identity:XE});new TextEncoder,new TextDecoder;const Jl={...B1,...G1,...Q1,...Z1,...eE,...lE,...dE,...vE,...EE,...AE};({...QE,...tI});function gp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function eI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function yp(i,e,r,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:r},decoder:{decode:s}}}const Ql=yp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),vc=yp("ascii","a",i=>{let e="a";for(let r=0;r<i.length;r++)e+=String.fromCharCode(i[r]);return e},i=>{i=i.substring(1);const e=eI(i.length);for(let r=0;r<i.length;r++)e[r]=i.charCodeAt(r);return e}),rI={utf8:Ql,"utf-8":Ql,hex:Jl.base16,latin1:vc,ascii:vc,binary:vc,...Jl};function nI(i,e="utf8"){const r=rI[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gp(globalThis.Buffer.from(i,"utf-8")):r.decoder.decode(`${r.prefix}${i}`)}const vp="wc",iI=2,Zc="core",Tn=`${vp}@2:${Zc}:`,sI={name:Zc,logger:"error"},oI={database:":memory:"},aI="crypto",Yl="client_ed25519_seed",cI=it.ONE_DAY,uI="keychain",hI="0.3",lI="messages",fI="0.3",pI=it.SIX_HOURS,dI="publisher",mp="irn",gI="error",wp="wss://relay.walletconnect.com",Zl="wss://relay.walletconnect.org",yI="relayer",Je={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},vI="_subscription",dn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},mI=it.ONE_SECOND,wI="2.10.6",bI=1e4,_I="0.3",EI="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},II="subscription",SI="0.3",PI=it.FIVE_SECONDS*1e3,OI="pairing",RI="0.3",Xi={wc_pairingDelete:{req:{ttl:it.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:it.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:it.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:it.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:it.ONE_DAY,prompt:!1,tag:0},res:{ttl:it.ONE_DAY,prompt:!1,tag:0}}},ss={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},AI="history",NI="0.3",CI="expirer",xr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},TI="0.3",mc="verify-api",Ii="https://verify.walletconnect.com",Lc="https://verify.walletconnect.org",xI=[Ii,Lc];class jI{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=uI,this.version=hI,this.initialized=!1,this.storagePrefix=Tn,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:h}=J("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=Ct.generateChildLogger(r,this.name)}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Uf(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?$f(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class LI{constructor(e,r,s){this.core=e,this.logger=r,this.name=aI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=Ml(a);return Zf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=zb();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),f=Ml(h),g=Nc();return await h1(g,a,cI,f)},this.generateSharedKey=(a,h,f)=>{this.isInitialized();const g=this.getPrivateKey(a),b=kb(g,h);return this.setSymKey(b,f)},this.setSymKey=async(a,h)=>{this.isInitialized();const f=h||Hb(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,f)=>{this.isInitialized();const g=Mf(f),b=Qn(h);if(ul(g)){const x=g.senderPublicKey,$=g.receiverPublicKey;a=await this.generateSharedKey(x,$)}const y=this.getSymKey(a),{type:E,senderPublicKey:R}=g;return Vb({type:E,symKey:y,message:b,senderPublicKey:R})},this.decode=async(a,h,f)=>{this.isInitialized();const g=Fb(h,f);if(ul(g)){const b=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(b,y)}try{const b=this.getSymKey(a),y=Wb({symKey:b,encoded:h});return fs(y)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}},this.getPayloadType=a=>{const h=Co(a);return us(h.type)},this.getPayloadSenderPublicKey=a=>{const h=Co(a);return h.senderPublicKey?sr(h.senderPublicKey,ir):void 0},this.core=e,this.logger=Ct.generateChildLogger(r,this.name),this.keychain=s||new jI(this.core,this.logger)}get context(){return Ct.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Yl)}catch{e=Nc(),await this.keychain.set(Yl,e)}return nI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class qI extends H0{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=lI,this.version=fI,this.initialized=!1,this.storagePrefix=Tn,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const h=Si(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[h]<"u"||(f[h]=a,this.messages.set(s,f),await this.persist()),h},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const h=this.get(s),f=Si(a);return typeof h[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ct.generateChildLogger(e,this.name),this.core=r}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Uf(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?$f(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class DI extends K0{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new jr.EventEmitter,this.name=dI,this.queue=new Map,this.publishTimeout=it.toMiliseconds(it.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,h)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}});try{const g=(h==null?void 0:h.ttl)||pI,b=Cc(h),y=(h==null?void 0:h.prompt)||!1,E=(h==null?void 0:h.tag)||0,R=(h==null?void 0:h.id)||np().toString(),x={topic:s,message:a,opts:{ttl:g,relay:b,prompt:y,tag:E,id:R}},$=setTimeout(()=>this.queue.set(R,x),this.publishTimeout);try{await await cs(this.rpcPublish(s,a,g,b,y,E,R),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(R),this.relayer.events.emit(Je.publish,x)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=h==null?void 0:h.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(R),C;return}finally{clearTimeout($)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=e,this.logger=Ct.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ct.getLoggerContext(this.logger)}rpcPublish(e,r,s,a,h,f,g){var b,y,E,R;const x={method:Po(a.protocol).publish,params:{topic:e,message:r,ttl:s,prompt:h,tag:f},id:g};return nr((b=x.params)==null?void 0:b.prompt)&&((y=x.params)==null||delete y.prompt),nr((E=x.params)==null?void 0:E.tag)&&((R=x.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:s,opts:a}=e;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ti.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Je.connection_stalled);return}this.checkQueue()}),this.relayer.on(Je.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class MI{constructor(){this.map=new Map,this.set=(e,r)=>{const s=this.get(e);this.exists(e,r)||this.map.set(e,[...s,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,r))return;const a=s.filter(h=>h!==r);if(!a.length){this.map.delete(e);return}this.map.set(e,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var UI=Object.defineProperty,$I=Object.defineProperties,zI=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,kI=Object.prototype.hasOwnProperty,HI=Object.prototype.propertyIsEnumerable,tf=(i,e,r)=>e in i?UI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,ts=(i,e)=>{for(var r in e||(e={}))kI.call(e,r)&&tf(i,r,e[r]);if(Xl)for(var r of Xl(e))HI.call(e,r)&&tf(i,r,e[r]);return i},wc=(i,e)=>$I(i,zI(e));class KI extends B0{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new MI,this.events=new jr.EventEmitter,this.name=II,this.version=SI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Tn,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const h=Cc(a),f={topic:s,relay:h};this.pending.set(s,f);const g=await this.rpcSubscribe(s,h);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,h)=>{const f=new it.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=PI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Ct.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let s=!1;try{s=this.getSubscription(e).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const s=this.topicMap.get(e);await Promise.all(s.map(async a=>await this.unsubscribeById(e,a,r)))}async unsubscribeById(e,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}});try{const a=Cc(s);await this.rpcUnsubscribe(e,r,a);const h=Ie("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(e,r){const s={method:Po(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await cs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Je.connection_stalled)}return Si(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,s={method:Po(r.protocol).batchSubscribe,params:{topics:e.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await cs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Je.connection_stalled)}}rpcUnsubscribe(e,r,s){const a={method:Po(s.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(e,r){this.setSubscription(e,wc(ts({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,ts({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,ts({},r)),this.topicMap.set(r.topic,e),this.events.emit(zr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(zr.deleted,wc(ts({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Zr(r)&&this.onBatchSubscribe(r.map((s,a)=>wc(ts({},e[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Ti.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Je.connect,async()=>{await this.onConnect()}),this.relayer.on(Je.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async e=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(zr.deleted,async e=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var VI=Object.defineProperty,ef=Object.getOwnPropertySymbols,WI=Object.prototype.hasOwnProperty,BI=Object.prototype.propertyIsEnumerable,rf=(i,e,r)=>e in i?VI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,FI=(i,e)=>{for(var r in e||(e={}))WI.call(e,r)&&rf(i,r,e[r]);if(ef)for(var r of ef(e))BI.call(e,r)&&rf(i,r,e[r]);return i};class GI extends V0{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new jr.EventEmitter,this.name=yI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Je.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Je.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(dn.payload,this.onPayloadHandler),this.provider.on(dn.connect,this.onConnectHandler),this.provider.on(dn.disconnect,this.onDisconnectHandler),this.provider.on(dn.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Ct.generateChildLogger(e.logger,this.name):Ct.pino(Ct.getDefaultLoggerOptions({level:e.logger||gI})),this.messages=new qI(this.logger,e.core),this.subscriber=new KI(this,this.logger),this.publisher=new DI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||wp,this.projectId=e.projectId,this.bundleId=Xb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Zl}...`),await this.restartTransport(Zl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},bI)}get context(){return Ct.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,s){this.isInitialized(),await this.publisher.publish(e,r,s),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(a)return a;let h;const f=g=>{g.topic===e&&(this.subscriber.off(zr.created,f),h())};return await Promise.all([new Promise(g=>{h=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(e,r),g()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await cs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await cs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(dn.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await bl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new vn(new T1(s_({sdkVersion:wI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:s}=e;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(e){const{topic:r,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Yc(e)){if(!e.method.endsWith(vI))return;const r=e.params,{topic:s,message:a,publishedAt:h}=r.data,f={topic:s,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(FI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(e),await this.onMessageEvent(f)}else Mo(e)&&this.events.emit(Je.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Je.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Qc(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(dn.payload,this.onPayloadHandler),this.provider.off(dn.connect,this.onConnectHandler),this.provider.off(dn.disconnect,this.onDisconnectHandler),this.provider.off(dn.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Je.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let e=await bl();Y_(async r=>{this.initialized&&e!==r&&(e=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Je.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},it.toMiliseconds(mI)))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var JI=Object.defineProperty,nf=Object.getOwnPropertySymbols,QI=Object.prototype.hasOwnProperty,YI=Object.prototype.propertyIsEnumerable,sf=(i,e,r)=>e in i?JI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,of=(i,e)=>{for(var r in e||(e={}))QI.call(e,r)&&sf(i,r,e[r]);if(nf)for(var r of nf(e))YI.call(e,r)&&sf(i,r,e[r]);return i};class $o extends W0{constructor(e,r,s,a=Tn,h=void 0){super(e,r,s,a),this.core=e,this.logger=r,this.name=s,this.map=new Map,this.version=_I,this.cached=[],this.initialized=!1,this.storagePrefix=Tn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!nr(f)?this.map.set(this.getKey(f),f):A_(f)?this.map.set(f.id,f):N_(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(b=>j1(g[b],f[b]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const b=of(of({},this.getData(f)),g);this.map.set(f,b),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ct.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class ZI{constructor(e,r){this.core=e,this.logger=r,this.name=OI,this.version=RI,this.events=new $c,this.initialized=!1,this.storagePrefix=Tn,this.ignoredPayloadTypes=[Yn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Nc(),a=await this.core.crypto.setSymKey(s),h=kr(it.FIVE_MINUTES),f={protocol:mp},g={topic:a,expiry:h,relay:f,active:!1},b=m_({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:b}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:h,relay:f}=gl(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const b=kr(it.FIVE_MINUTES),y={topic:a,relay:f,expiry:b,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,b),s.activatePairing&&await this.activate({topic:a}),this.events.emit(ss.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const a=kr(it.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:b}=Ei();this.events.once(Le("pairing_ping",h),({error:y})=>{y?b(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",Ie("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,h)=>{const f=Oi(a,h),g=await this.core.crypto.encode(s,f),b=Xi[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,b),f.id},this.sendResult=async(s,a,h)=>{const f=Qc(s,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=Xi[b.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(s,a,h)=>{const f=Do(s,h),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=Xi[b.request.method]?Xi[b.request.method].res:Xi.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,Ie("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Cn(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:h}=s,f=(await this.core.history.get(a,h.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:h}=a;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(ss.ping,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:h}=a;setTimeout(()=>{yn(a)?this.events.emit(Le("pairing_ping",h),{}):Hr(a)&&this.events.emit(Le("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ss.delete,{id:h,topic:s})}catch(f){await this.sendError(h,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:h,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=Ie("WC_METHOD_UNSUPPORTED",f);await this.sendError(h,s,g),this.logger.error(g)}catch(g){await this.sendError(h,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(Ie("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!dr(s)){const{message:f}=J("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!R_(s.uri)){const{message:f}=J("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const h=gl(s.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(h!=null&&h.symKey)){const{message:f}=J("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!dr(s)){const{message:h}=J("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!dr(s)){const{message:h}=J("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!He(s,!1)){const{message:a}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Cn(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=J("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=e,this.logger=Ct.generateChildLogger(r,this.name),this.pairings=new $o(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ct.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Je.message,async e=>{const{topic:r,message:s}=e;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{Yc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Mo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(xr.expired,async e=>{const{topic:r}=kf(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(ss.expire,{topic:r}))})}}class XI extends k0{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new jr.EventEmitter,this.name=AI,this.version=NI,this.cached=[],this.initialized=!1,this.storagePrefix=Tn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:h}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:h,expiry:kr(it.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Yr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Yr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===s){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Yr.deleted,h)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ct.generateChildLogger(r,this.name)}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Oi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Yr.created,e=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Yr.updated,e=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Yr.deleted,e=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.core.heartbeat.on(Ti.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{it.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class t5 extends F0{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new jr.EventEmitter,this.name=CI,this.version=TI,this.cached=[],this.initialized=!1,this.storagePrefix=Tn,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const h=this.formatTarget(s),f={target:h,expiry:a};this.expirations.set(h,f),this.checkExpiry(h,f),this.events.emit(xr.created,{target:h,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(xr.deleted,{target:a,expiration:h})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ct.generateChildLogger(r,this.name)}get context(){return Ct.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return o_(e);if(typeof e=="number")return a_(e);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(xr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(e,r){const{expiry:s}=r;it.toMiliseconds(s)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(xr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Ti.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(xr.created,e=>{const r=xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(xr.expired,e=>{const r=xr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(xr.deleted,e=>{const r=xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}}class e5 extends G0{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.name=mc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Ai()||!Ni())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Lc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),h=await this.fetchAttestation(s.attestationId,Lc)}return h},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(it.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(h=>{if(document.getElementById(mc))return h();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=mc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=h}),new Promise((h,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},it.toMiliseconds(it.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Ii;return xI.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Ii}`),a=Ii),a},this.logger=Ct.generateChildLogger(r,this.name),this.verifyUrl=Ii,this.abortController=new AbortController,this.isDevEnv=Vc()&&_b.IS_VITEST}get context(){return Ct.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),it.toMiliseconds(e))}}var r5=Object.defineProperty,af=Object.getOwnPropertySymbols,n5=Object.prototype.hasOwnProperty,i5=Object.prototype.propertyIsEnumerable,cf=(i,e,r)=>e in i?r5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,uf=(i,e)=>{for(var r in e||(e={}))n5.call(e,r)&&cf(i,r,e[r]);if(af)for(var r of af(e))i5.call(e,r)&&cf(i,r,e[r]);return i};class Xc extends z0{constructor(e){super(e),this.protocol=vp,this.version=iI,this.name=Zc,this.events=new jr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||wp,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ct.pino(Ct.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||sI.logger}));this.logger=Ct.generateChildLogger(r,this.name),this.heartbeat=new Ti.HeartBeat,this.crypto=new LI(this,this.logger,e==null?void 0:e.keychain),this.history=new XI(this,this.logger),this.expirer=new t5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new T0(uf(uf({},oI),e==null?void 0:e.storageOptions)),this.relayer=new GI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ZI(this,this.logger),this.verify=new e5(this.projectId||"",this.logger)}static async init(e){const r=new Xc(e);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(EI,s),r}get context(){return Ct.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const s5=Xc,bp="wc",_p=2,Ep="client",tu=`${bp}@${_p}:${Ep}:`,bc={name:Ep,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},hf="WALLETCONNECT_DEEPLINK_CHOICE",o5="proposal",Ip="Proposal expired",a5="session",Eo=it.SEVEN_DAYS,c5="engine",es={wc_sessionPropose:{req:{ttl:it.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:it.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:it.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:it.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:it.ONE_DAY,prompt:!1,tag:1104},res:{ttl:it.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:it.ONE_DAY,prompt:!1,tag:1106},res:{ttl:it.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:it.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:it.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:it.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:it.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:it.ONE_DAY,prompt:!1,tag:1112},res:{ttl:it.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:it.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:it.THIRTY_SECONDS,prompt:!1,tag:1115}}},_c={min:it.FIVE_MINUTES,max:it.SEVEN_DAYS},gn={idle:"IDLE",active:"ACTIVE"},u5="request",h5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var l5=Object.defineProperty,f5=Object.defineProperties,p5=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,d5=Object.prototype.hasOwnProperty,g5=Object.prototype.propertyIsEnumerable,ff=(i,e,r)=>e in i?l5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,fr=(i,e)=>{for(var r in e||(e={}))d5.call(e,r)&&ff(i,r,e[r]);if(lf)for(var r of lf(e))g5.call(e,r)&&ff(i,r,e[r]);return i},rs=(i,e)=>f5(i,p5(e));class y5 extends Q0{constructor(e){super(e),this.name=c5,this.events=new $c,this.initialized=!1,this.ignoredPayloadTypes=[Yn],this.requestQueue={state:gn.idle,queue:[]},this.sessionRequestQueue={state:gn.idle,queue:[]},this.requestQueueDelay=it.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(es)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},it.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=rs(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:f,sessionProperties:g,relays:b}=s;let y=a,E,R=!1;if(y&&(R=this.client.core.pairing.pairings.get(y).active),!y||!R){const{topic:ut,uri:ht}=await this.client.core.pairing.create();y=ut,E=ht}const x=await this.client.core.crypto.generateKeyPair(),$=fr({requiredNamespaces:h,optionalNamespaces:f,relays:b??[{protocol:mp}],proposer:{publicKey:x,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:C,resolve:W,done:tt}=Ei(it.FIVE_MINUTES,Ip);if(this.events.once(Le("session_connect"),async({error:ut,session:ht})=>{if(ut)C(ut);else if(ht){ht.self.publicKey=x;const lt=rs(fr({},ht),{requiredNamespaces:ht.requiredNamespaces,optionalNamespaces:ht.optionalNamespaces});await this.client.session.set(ht.topic,lt),await this.setExpiry(ht.topic,ht.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:ht.peer.metadata}),W(lt)}}),!y){const{message:ut}=J("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(ut)}const yt=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:$}),pt=kr(it.FIVE_MINUTES);return await this.setProposal(yt,fr({id:yt,expiry:pt},$)),{uri:E,approval:tt}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:h,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:b,proposer:y,requiredNamespaces:E,optionalNamespaces:R}=g;b=b||"",Pi(E)||(E=E_(h,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),$=y.publicKey,C=await this.client.core.crypto.generateSharedKey(x,$);b&&s&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:y.metadata}),await this.sendResult({id:s,topic:b,result:{relay:{protocol:a??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(s,Ie("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const W=fr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:E,optionalNamespaces:R,pairingTopic:b,controller:{publicKey:x,metadata:this.client.metadata},expiry:kr(Eo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0});const tt=rs(fr({},W),{topic:C,pairingTopic:b,acknowledged:!1,self:W.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:x});return await this.client.session.set(C,tt),await this.setExpiry(C,kr(Eo)),{topic:C,acknowledged:()=>new Promise(yt=>setTimeout(()=>yt(this.client.session.get(C)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,a),await this.client.proposal.delete(s,Ie("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:b}=Ei();return this.events.once(Le("session_update",h),({error:y})=>{y?b(y):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:f,reject:g}=Ei();return this.events.once(Le("session_extend",a),({error:b})=>{b?g(b):f()}),await this.setExpiry(s,kr(Eo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:h,expiry:f}=r,g=Jc(),{done:b,resolve:y,reject:E}=Ei(f,"Request expired. Please try again.");return this.events.once(Le("session_request",g),({error:R,result:x})=>{R?E(R):y(x)}),await Promise.all([new Promise(async R=>{await this.sendRequest({clientRpcId:g,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(x=>E(x)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:s,id:g}),R()}),new Promise(async R=>{const x=await u_(this.client.core.storage,hf);c_({id:g,topic:h,wcDeepLink:x}),R()}),b()]).then(R=>R[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:h}=a;yn(a)?await this.sendResult({id:h,topic:s,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(h,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:f,reject:g}=Ei();this.events.once(Le("session_ping",a),({error:b})=>{b?g(b):f()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:h}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:Ie("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>P_(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var f,g;return((f=h.peerMetadata)==null?void 0:f.url)&&((g=h.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Ie("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(hf).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,Ie("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=gn.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=es.wc_sessionRequest.req.ttl,{id:a,topic:h,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,kr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:h,expiry:f,relayRpcId:g,clientRpcId:b,throwOnFailedPublish:y}=r,E=Oi(a,h,b);if(Ni()&&h5.includes(a)){const $=Si(JSON.stringify(E));this.client.core.verify.register({attestationId:$})}const R=await this.client.core.crypto.encode(s,E),x=es[a].req;return f&&(x.ttl=f),g&&(x.id=g),this.client.core.history.set(s,E),y?(x.internal=rs(fr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,R,x)):this.client.core.relayer.publish(s,R,x).catch($=>this.client.logger.error($)),E.id},this.sendResult=async r=>{const{id:s,topic:a,result:h,throwOnFailedPublish:f}=r,g=Qc(s,h),b=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,s),E=es[y.request.method].res;f?(E.internal=rs(fr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,b,E)):this.client.core.relayer.publish(a,b,E).catch(R=>this.client.logger.error(R)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const h=Do(r,a),f=await this.client.core.crypto.encode(s,h),g=await this.client.core.history.get(s,r),b=es[g.request.method].res;this.client.core.relayer.publish(s,f,b),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Cn(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Cn(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===gn.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=gn.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=gn.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,h=(await this.client.core.history.get(s,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=J("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:h}=s;try{this.isValidConnect(fr({},s.params));const f=kr(it.FIVE_MINUTES),g=fr({id:h,pairingTopic:r,expiry:f},a);await this.setProposal(h,g);const b=Si(JSON.stringify(s)),y=await this.getVerifyContext(b,g.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:g,verifyContext:y})}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(yn(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const b=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const y=await this.client.core.crypto.generateSharedKey(g,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const E=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(a,Ie("USER_DISCONNECTED")),this.events.emit(Le("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:f,controller:g,expiry:b,namespaces:y,requiredNamespaces:E,optionalNamespaces:R,sessionProperties:x,pairingTopic:$}=s.params,C=fr({topic:r,relay:f,expiry:b,namespaces:y,acknowledged:!0,pairingTopic:$,requiredNamespaces:E,optionalNamespaces:R,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},x&&{sessionProperties:x});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Le("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;yn(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Le("session_approve",a),{})):Hr(s)&&(await this.client.session.delete(r,Ie("USER_DISCONNECTED")),this.events.emit(Le("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:h}=s;try{const f=`${r}_session_update`,g=wo.get(f);if(g&&this.isRequestOutOfSync(g,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(fr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),wo.set(f,h)}catch(f){await this.sendError(h,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;yn(s)?this.events.emit(Le("session_update",a),{}):Hr(s)&&this.events.emit(Le("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,kr(Eo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;yn(s)?this.events.emit(Le("session_extend",a),{}):Hr(s)&&this.events.emit(Le("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{yn(s)?this.events.emit(Le("session_ping",a),{}):Hr(s)&&this.events.emit(Le("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Je.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidRequest(fr({topic:r},h));const f=Si(JSON.stringify(Oi("wc_sessionRequest",h,a))),g=this.client.session.get(r),b=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:h,verifyContext:b};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;yn(s)?this.events.emit(Le("session_request",a),{result:s.result}):Hr(s)&&this.events.emit(Le("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:h}=s;try{const f=`${r}_session_event_${h.event.name}`,g=wo.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(fr({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),wo.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=gn.idle,this.processSessionRequestQueue()},it.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===gn.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=gn.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Oi("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(b)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:f,relays:g}=r;if(nr(s)||await this.isValidPairingTopic(s),!M_(g,!0)){const{message:b}=J("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(b)}!nr(a)&&Pi(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!nr(h)&&Pi(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),nr(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=D_(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!dr(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:h,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),b=Oo(a,"approve()");if(b)throw new Error(b.message);const y=ml(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!He(h,!0)){const{message:E}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(E)}nr(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!$_(a)){const{message:h}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!dr(r)){const{message:y}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:h,expiry:f}=r;if(!Kf(s)){const{message:y}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=C_(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const b=Oo(h,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Cn(f)){const{message:y}=J("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(b)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const h=this.client.session.get(s),f=Oo(a,"update()");if(f)throw new Error(f.message);const g=ml(h.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!dr(r)){const{message:b}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(b)}const{topic:s,request:a,chainId:h,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!vl(g,h)){const{message:b}=J("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(b)}if(!z_(a)){const{message:b}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(b)}if(!K_(g,h,a.method)){const{message:b}=J("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(b)}if(f&&!F_(f,_c)){const{message:b}=J("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${_c.min} and ${_c.max}`);throw new Error(b)}},this.isValidRespond=async r=>{if(!dr(r)){const{message:h}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!k_(a)){const{message:h}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!dr(r)){const{message:g}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:h}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!vl(f,h)){const{message:g}=J("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(g)}if(!H_(a)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!V_(f,h,a.name)){const{message:g}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!dr(r)){const{message:a}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Ii,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!He(a,!1)){const{message:h}=J("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Je.message,async e=>{const{topic:r,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{Yc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Mo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(xr.expired,async e=>{const{topic:r,id:s}=kf(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ss.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!He(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Cn(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!He(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Cn(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=J("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(He(e,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!U_(e)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Cn(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=J("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class v5 extends $o{constructor(e,r){super(e,r,o5,tu),this.core=e,this.logger=r}}class m5 extends $o{constructor(e,r){super(e,r,a5,tu),this.core=e,this.logger=r}}class w5 extends $o{constructor(e,r){super(e,r,u5,tu,s=>s.id),this.core=e,this.logger=r}}let b5=class Sp extends J0{constructor(e){super(e),this.protocol=bp,this.version=_p,this.name=bc.name,this.events=new jr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||bc.name,this.metadata=(e==null?void 0:e.metadata)||e_();const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ct.pino(Ct.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||bc.logger}));this.core=(e==null?void 0:e.core)||new s5(e),this.logger=Ct.generateChildLogger(r,this.name),this.session=new m5(this.core,this.logger),this.proposal=new v5(this.core,this.logger),this.pendingRequest=new w5(this.core,this.logger),this.engine=new y5(this)}static async init(e){const r=new Sp(e);return await r.initialize(),r}get context(){return Ct.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var qc={exports:{}};(function(i,e){var r=typeof self<"u"?self:Kr,s=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(f){var g={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function b(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(m){return m&&y.indexOf(Object.prototype.toString.call(m))>-1};function R(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function x(m){return typeof m!="string"&&(m=String(m)),m}function $(m){var S={next:function(){var Y=m.shift();return{done:Y===void 0,value:Y}}};return g.iterable&&(S[Symbol.iterator]=function(){return S}),S}function C(m){this.map={},m instanceof C?m.forEach(function(S,Y){this.append(Y,S)},this):Array.isArray(m)?m.forEach(function(S){this.append(S[0],S[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(S){this.append(S,m[S])},this)}C.prototype.append=function(m,S){m=R(m),S=x(S);var Y=this.map[m];this.map[m]=Y?Y+", "+S:S},C.prototype.delete=function(m){delete this.map[R(m)]},C.prototype.get=function(m){return m=R(m),this.has(m)?this.map[m]:null},C.prototype.has=function(m){return this.map.hasOwnProperty(R(m))},C.prototype.set=function(m,S){this.map[R(m)]=x(S)},C.prototype.forEach=function(m,S){for(var Y in this.map)this.map.hasOwnProperty(Y)&&m.call(S,this.map[Y],Y,this)},C.prototype.keys=function(){var m=[];return this.forEach(function(S,Y){m.push(Y)}),$(m)},C.prototype.values=function(){var m=[];return this.forEach(function(S){m.push(S)}),$(m)},C.prototype.entries=function(){var m=[];return this.forEach(function(S,Y){m.push([Y,S])}),$(m)},g.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function W(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function tt(m){return new Promise(function(S,Y){m.onload=function(){S(m.result)},m.onerror=function(){Y(m.error)}})}function yt(m){var S=new FileReader,Y=tt(S);return S.readAsArrayBuffer(m),Y}function pt(m){var S=new FileReader,Y=tt(S);return S.readAsText(m),Y}function ut(m){for(var S=new Uint8Array(m),Y=new Array(S.length),dt=0;dt<S.length;dt++)Y[dt]=String.fromCharCode(S[dt]);return Y.join("")}function ht(m){if(m.slice)return m.slice(0);var S=new Uint8Array(m.byteLength);return S.set(new Uint8Array(m)),S.buffer}function lt(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&b(m)?(this._bodyArrayBuffer=ht(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||E(m))?this._bodyArrayBuffer=ht(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=W(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(yt)}),this.text=function(){var m=W(this);if(m)return m;if(this._bodyBlob)return pt(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ut(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(wt)}),this.json=function(){return this.text().then(JSON.parse)},this}var q=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function H(m){var S=m.toUpperCase();return q.indexOf(S)>-1?S:m}function G(m,S){S=S||{};var Y=S.body;if(m instanceof G){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,S.headers||(this.headers=new C(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!Y&&m._bodyInit!=null&&(Y=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new C(S.headers)),this.method=H(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Y)}G.prototype.clone=function(){return new G(this,{body:this._bodyInit})};function wt(m){var S=new FormData;return m.trim().split("&").forEach(function(Y){if(Y){var dt=Y.split("="),B=dt.shift().replace(/\+/g," "),k=dt.join("=").replace(/\+/g," ");S.append(decodeURIComponent(B),decodeURIComponent(k))}}),S}function nt(m){var S=new C,Y=m.replace(/\r?\n[\t ]+/g," ");return Y.split(/\r?\n/).forEach(function(dt){var B=dt.split(":"),k=B.shift().trim();if(k){var V=B.join(":").trim();S.append(k,V)}}),S}lt.call(G.prototype);function st(m,S){S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"OK",this.headers=new C(S.headers),this.url=S.url||"",this._initBody(m)}lt.call(st.prototype),st.prototype.clone=function(){return new st(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},st.error=function(){var m=new st(null,{status:0,statusText:""});return m.type="error",m};var qt=[301,302,303,307,308];st.redirect=function(m,S){if(qt.indexOf(S)===-1)throw new RangeError("Invalid status code");return new st(null,{status:S,headers:{location:m}})},f.DOMException=h.DOMException;try{new f.DOMException}catch{f.DOMException=function(m,S){this.message=m,this.name=S;var Y=Error(m);this.stack=Y.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Dt(m,S){return new Promise(function(Y,dt){var B=new G(m,S);if(B.signal&&B.signal.aborted)return dt(new f.DOMException("Aborted","AbortError"));var k=new XMLHttpRequest;function V(){k.abort()}k.onload=function(){var F={status:k.status,statusText:k.statusText,headers:nt(k.getAllResponseHeaders()||"")};F.url="responseURL"in k?k.responseURL:F.headers.get("X-Request-URL");var Jt="response"in k?k.response:k.responseText;Y(new st(Jt,F))},k.onerror=function(){dt(new TypeError("Network request failed"))},k.ontimeout=function(){dt(new TypeError("Network request failed"))},k.onabort=function(){dt(new f.DOMException("Aborted","AbortError"))},k.open(B.method,B.url,!0),B.credentials==="include"?k.withCredentials=!0:B.credentials==="omit"&&(k.withCredentials=!1),"responseType"in k&&g.blob&&(k.responseType="blob"),B.headers.forEach(function(F,Jt){k.setRequestHeader(Jt,F)}),B.signal&&(B.signal.addEventListener("abort",V),k.onreadystatechange=function(){k.readyState===4&&B.signal.removeEventListener("abort",V)}),k.send(typeof B._bodyInit>"u"?null:B._bodyInit)})}return Dt.polyfill=!0,h.fetch||(h.fetch=Dt,h.Headers=C,h.Request=G,h.Response=st),f.Headers=C,f.Request=G,f.Response=st,f.fetch=Dt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;e=a.fetch,e.default=a.fetch,e.fetch=a.fetch,e.Headers=a.Headers,e.Request=a.Request,e.Response=a.Response,i.exports=e})(qc,qc.exports);var _5=qc.exports;const pf=Af(_5),E5={Accept:"application/json","Content-Type":"application/json"},I5="POST",df={headers:E5,method:I5},gf=10;class jn{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new jr.EventEmitter,this.isAvailable=!1,this.registering=!1,!kl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const s=Qn(e),a=await(await pf(this.url,Object.assign(Object.assign({},df),{body:s}))).json();this.onPayload({data:a})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!kl(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Qn({id:1,jsonrpc:"2.0",method:"test",params:[]});await pf(e,Object.assign(Object.assign({},df),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?fs(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const s=this.parseError(r),a=s.message||s.toString(),h=Do(e,a);this.events.emit("payload",h)}parseError(e,r=this.url){return ep(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>gf&&this.events.setMaxListeners(gf)}}const yf="error",S5="wss://relay.walletconnect.com",P5="wc",O5="universal_provider",vf=`${P5}@2:${O5}:`,R5="https://rpc.walletconnect.com/v1/",mn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ns=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var r,s="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,E="__lodash_placeholder__",R=1,x=2,$=4,C=1,W=2,tt=1,yt=2,pt=4,ut=8,ht=16,lt=32,q=64,H=128,G=256,wt=512,nt=30,st="...",qt=800,Dt=16,m=1,S=2,Y=3,dt=1/0,B=9007199254740991,k=17976931348623157e292,V=NaN,F=4294967295,Jt=F-1,Kt=F>>>1,Vr=[["ary",H],["bind",tt],["bindKey",yt],["curry",ut],["curryRight",ht],["flip",wt],["partial",lt],["partialRight",q],["rearg",G]],It="[object Arguments]",Se="[object Array]",L="[object AsyncFunction]",j="[object Boolean]",N="[object Date]",u="[object DOMException]",I="[object Error]",et="[object Function]",ft="[object GeneratorFunction]",_t="[object Map]",Tt="[object Number]",jt="[object Null]",Ot="[object Object]",Pe="[object Promise]",me="[object Proxy]",oe="[object RegExp]",Mt="[object Set]",Yt="[object String]",Zt="[object Symbol]",ae="[object Undefined]",kt="[object WeakMap]",Xt="[object WeakSet]",xt="[object ArrayBuffer]",Vt="[object DataView]",he="[object Float32Array]",$t="[object Float64Array]",Oe="[object Int8Array]",qe="[object Int16Array]",Ke="[object Int32Array]",Ve="[object Uint8Array]",Ue="[object Uint8ClampedArray]",Qe="[object Uint16Array]",or="[object Uint32Array]",Wr=/\b__p \+= '';/g,Ye=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wn=/&(?:amp|lt|gt|quot|#39);/g,Ln=/[&<>"']/g,le=RegExp(wn.source),re=RegExp(Ln.source),fe=/<%-([\s\S]+?)%>/g,pe=/<%([\s\S]+?)%>/g,ce=/<%=([\s\S]+?)%>/g,ne=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Re=/^\w*$/,Ae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,de=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(de.source),ge=/^\s+/,we=/\s/,ye=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ce=/,? & /,Te=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zo=/[()=,{}\[\]\/\s]/,ko=/\\(\\)?/g,Ho=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Ko=/^[-+]0x[0-9a-f]+$/i,Vo=/^0b[01]+$/i,Wo=/^\[object .+?Constructor\]$/,Bo=/^0o[0-7]+$/i,Fo=/^(?:0|[1-9]\d*)$/,tn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ei=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,ri="\\ud800-\\udfff",Jo="\\u0300-\\u036f",Qo="\\ufe20-\\ufe2f",ni="\\u20d0-\\u20ff",ds=Jo+Qo+ni,gs="\\u2700-\\u27bf",Lr="a-z\\xdf-\\xf6\\xf8-\\xff",Yo="\\xac\\xb1\\xd7\\xf7",Zo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xo="\\u2000-\\u206f",ta=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ys="A-Z\\xc0-\\xd6\\xd8-\\xde",vs="\\ufe0e\\ufe0f",qn=Yo+Zo+Xo+ta,xi="['’]",Dn="["+ri+"]",ji="["+qn+"]",Mn="["+ds+"]",ms="\\d+",ea="["+gs+"]",ws="["+Lr+"]",bs="[^"+ri+qn+ms+gs+Lr+ys+"]",ii="\\ud83c[\\udffb-\\udfff]",ra="(?:"+Mn+"|"+ii+")",_s="[^"+ri+"]",si="(?:\\ud83c[\\udde6-\\uddff]){2}",bn="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+ys+"]",Es="\\u200d",Is="(?:"+ws+"|"+bs+")",Br="(?:"+yr+"|"+bs+")",Ss="(?:"+xi+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+xi+"(?:D|LL|M|RE|S|T|VE))?",Os=ra+"?",Rs="["+vs+"]?",na="(?:"+Es+"(?:"+[_s,si,bn].join("|")+")"+Rs+Os+")*",en="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",As="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ns=Rs+Os+na,oi="(?:"+[ea,si,bn].join("|")+")"+Ns,ia="(?:"+[_s+Mn+"?",Mn,si,bn,Dn].join("|")+")",Li=RegExp(xi,"g"),sa=RegExp(Mn,"g"),ai=RegExp(ii+"(?="+ii+")|"+ia+Ns,"g"),Cs=RegExp([yr+"?"+ws+"+"+Ss+"(?="+[ji,yr,"$"].join("|")+")",Br+"+"+Ps+"(?="+[ji,yr+Is,"$"].join("|")+")",yr+"?"+Is+"+"+Ss,yr+"+"+Ps,As,en,ms,oi].join("|"),"g"),Ts=RegExp("["+Es+ri+ds+vs+"]"),Un=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,xs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],oa=-1,Wt={};Wt[he]=Wt[$t]=Wt[Oe]=Wt[qe]=Wt[Ke]=Wt[Ve]=Wt[Ue]=Wt[Qe]=Wt[or]=!0,Wt[It]=Wt[Se]=Wt[xt]=Wt[j]=Wt[Vt]=Wt[N]=Wt[I]=Wt[et]=Wt[_t]=Wt[Tt]=Wt[Ot]=Wt[oe]=Wt[Mt]=Wt[Yt]=Wt[kt]=!1;var Ht={};Ht[It]=Ht[Se]=Ht[xt]=Ht[Vt]=Ht[j]=Ht[N]=Ht[he]=Ht[$t]=Ht[Oe]=Ht[qe]=Ht[Ke]=Ht[_t]=Ht[Tt]=Ht[Ot]=Ht[oe]=Ht[Mt]=Ht[Yt]=Ht[Zt]=Ht[Ve]=Ht[Ue]=Ht[Qe]=Ht[or]=!0,Ht[I]=Ht[et]=Ht[kt]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Z={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Bt=parseFloat,mt=parseInt,te=typeof ns=="object"&&ns&&ns.Object===Object&&ns,xe=typeof self=="object"&&self&&self.Object===Object&&self,At=te||xe||Function("return this")(),Ft=e&&!e.nodeType&&e,be=Ft&&!0&&i&&!i.nodeType&&i,ar=be&&be.exports===Ft,je=ar&&te.process,ee=function(){try{var P=be&&be.require&&be.require("util").types;return P||je&&je.binding&&je.binding("util")}catch{}}(),Ze=ee&&ee.isArrayBuffer,qr=ee&&ee.isDate,Sr=ee&&ee.isMap,Fr=ee&&ee.isRegExp,qi=ee&&ee.isSet,$n=ee&&ee.isTypedArray;function $e(P,D,T){switch(T.length){case 0:return P.call(D);case 1:return P.call(D,T[0]);case 2:return P.call(D,T[0],T[1]);case 3:return P.call(D,T[0],T[1],T[2])}return P.apply(D,T)}function Rp(P,D,T,X){for(var gt=-1,Lt=P==null?0:P.length;++gt<Lt;){var De=P[gt];D(X,De,T(De),P)}return X}function Pr(P,D){for(var T=-1,X=P==null?0:P.length;++T<X&&D(P[T],T,P)!==!1;);return P}function Ap(P,D){for(var T=P==null?0:P.length;T--&&D(P[T],T,P)!==!1;);return P}function nu(P,D){for(var T=-1,X=P==null?0:P.length;++T<X;)if(!D(P[T],T,P))return!1;return!0}function _n(P,D){for(var T=-1,X=P==null?0:P.length,gt=0,Lt=[];++T<X;){var De=P[T];D(De,T,P)&&(Lt[gt++]=De)}return Lt}function js(P,D){var T=P==null?0:P.length;return!!T&&ci(P,D,0)>-1}function aa(P,D,T){for(var X=-1,gt=P==null?0:P.length;++X<gt;)if(T(D,P[X]))return!0;return!1}function ie(P,D){for(var T=-1,X=P==null?0:P.length,gt=Array(X);++T<X;)gt[T]=D(P[T],T,P);return gt}function En(P,D){for(var T=-1,X=D.length,gt=P.length;++T<X;)P[gt+T]=D[T];return P}function ca(P,D,T,X){var gt=-1,Lt=P==null?0:P.length;for(X&&Lt&&(T=P[++gt]);++gt<Lt;)T=D(T,P[gt],gt,P);return T}function Np(P,D,T,X){var gt=P==null?0:P.length;for(X&&gt&&(T=P[--gt]);gt--;)T=D(T,P[gt],gt,P);return T}function ua(P,D){for(var T=-1,X=P==null?0:P.length;++T<X;)if(D(P[T],T,P))return!0;return!1}var Cp=ha("length");function Tp(P){return P.split("")}function xp(P){return P.match(Te)||[]}function iu(P,D,T){var X;return T(P,function(gt,Lt,De){if(D(gt,Lt,De))return X=Lt,!1}),X}function Ls(P,D,T,X){for(var gt=P.length,Lt=T+(X?1:-1);X?Lt--:++Lt<gt;)if(D(P[Lt],Lt,P))return Lt;return-1}function ci(P,D,T){return D===D?Vp(P,D,T):Ls(P,su,T)}function jp(P,D,T,X){for(var gt=T-1,Lt=P.length;++gt<Lt;)if(X(P[gt],D))return gt;return-1}function su(P){return P!==P}function ou(P,D){var T=P==null?0:P.length;return T?fa(P,D)/T:V}function ha(P){return function(D){return D==null?r:D[P]}}function la(P){return function(D){return P==null?r:P[D]}}function au(P,D,T,X,gt){return gt(P,function(Lt,De,Gt){T=X?(X=!1,Lt):D(T,Lt,De,Gt)}),T}function Lp(P,D){var T=P.length;for(P.sort(D);T--;)P[T]=P[T].value;return P}function fa(P,D){for(var T,X=-1,gt=P.length;++X<gt;){var Lt=D(P[X]);Lt!==r&&(T=T===r?Lt:T+Lt)}return T}function pa(P,D){for(var T=-1,X=Array(P);++T<P;)X[T]=D(T);return X}function qp(P,D){return ie(D,function(T){return[T,P[T]]})}function cu(P){return P&&P.slice(0,fu(P)+1).replace(ge,"")}function vr(P){return function(D){return P(D)}}function da(P,D){return ie(D,function(T){return P[T]})}function Di(P,D){return P.has(D)}function uu(P,D){for(var T=-1,X=P.length;++T<X&&ci(D,P[T],0)>-1;);return T}function hu(P,D){for(var T=P.length;T--&&ci(D,P[T],0)>-1;);return T}function Dp(P,D){for(var T=P.length,X=0;T--;)P[T]===D&&++X;return X}var Mp=la(v),Up=la(O);function $p(P){return"\\"+Z[P]}function zp(P,D){return P==null?r:P[D]}function ui(P){return Ts.test(P)}function kp(P){return Un.test(P)}function Hp(P){for(var D,T=[];!(D=P.next()).done;)T.push(D.value);return T}function ga(P){var D=-1,T=Array(P.size);return P.forEach(function(X,gt){T[++D]=[gt,X]}),T}function lu(P,D){return function(T){return P(D(T))}}function In(P,D){for(var T=-1,X=P.length,gt=0,Lt=[];++T<X;){var De=P[T];(De===D||De===E)&&(P[T]=E,Lt[gt++]=T)}return Lt}function qs(P){var D=-1,T=Array(P.size);return P.forEach(function(X){T[++D]=X}),T}function Kp(P){var D=-1,T=Array(P.size);return P.forEach(function(X){T[++D]=[X,X]}),T}function Vp(P,D,T){for(var X=T-1,gt=P.length;++X<gt;)if(P[X]===D)return X;return-1}function Wp(P,D,T){for(var X=T+1;X--;)if(P[X]===D)return X;return X}function hi(P){return ui(P)?Fp(P):Cp(P)}function Dr(P){return ui(P)?Gp(P):Tp(P)}function fu(P){for(var D=P.length;D--&&we.test(P.charAt(D)););return D}var Bp=la(z);function Fp(P){for(var D=ai.lastIndex=0;ai.test(P);)++D;return D}function Gp(P){return P.match(ai)||[]}function Jp(P){return P.match(Cs)||[]}var Qp=function P(D){D=D==null?At:li.defaults(At.Object(),D,li.pick(At,xs));var T=D.Array,X=D.Date,gt=D.Error,Lt=D.Function,De=D.Math,Gt=D.Object,ya=D.RegExp,Yp=D.String,Or=D.TypeError,Ds=T.prototype,Zp=Lt.prototype,fi=Gt.prototype,Ms=D["__core-js_shared__"],Us=Zp.toString,zt=fi.hasOwnProperty,Xp=0,pu=function(){var t=/[^.]+$/.exec(Ms&&Ms.keys&&Ms.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),$s=fi.toString,td=Us.call(Gt),ed=At._,rd=ya("^"+Us.call(zt).replace(de,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=ar?D.Buffer:r,Sn=D.Symbol,ks=D.Uint8Array,du=zs?zs.allocUnsafe:r,Hs=lu(Gt.getPrototypeOf,Gt),gu=Gt.create,yu=fi.propertyIsEnumerable,Ks=Ds.splice,vu=Sn?Sn.isConcatSpreadable:r,Mi=Sn?Sn.iterator:r,zn=Sn?Sn.toStringTag:r,Vs=function(){try{var t=Wn(Gt,"defineProperty");return t({},"",{}),t}catch{}}(),nd=D.clearTimeout!==At.clearTimeout&&D.clearTimeout,id=X&&X.now!==At.Date.now&&X.now,sd=D.setTimeout!==At.setTimeout&&D.setTimeout,Ws=De.ceil,Bs=De.floor,va=Gt.getOwnPropertySymbols,od=zs?zs.isBuffer:r,mu=D.isFinite,ad=Ds.join,cd=lu(Gt.keys,Gt),Me=De.max,Fe=De.min,ud=X.now,hd=D.parseInt,wu=De.random,ld=Ds.reverse,ma=Wn(D,"DataView"),Ui=Wn(D,"Map"),wa=Wn(D,"Promise"),pi=Wn(D,"Set"),$i=Wn(D,"WeakMap"),zi=Wn(Gt,"create"),Fs=$i&&new $i,di={},fd=Bn(ma),pd=Bn(Ui),dd=Bn(wa),gd=Bn(pi),yd=Bn($i),Gs=Sn?Sn.prototype:r,ki=Gs?Gs.valueOf:r,bu=Gs?Gs.toString:r;function p(t){if(ve(t)&&!vt(t)&&!(t instanceof Rt)){if(t instanceof Rr)return t;if(zt.call(t,"__wrapped__"))return _h(t)}return new Rr(t)}var gi=function(){function t(){}return function(n){if(!ue(n))return{};if(gu)return gu(n);t.prototype=n;var o=new t;return t.prototype=r,o}}();function Js(){}function Rr(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}p.templateSettings={escape:fe,evaluate:pe,interpolate:ce,variable:"",imports:{_:p}},p.prototype=Js.prototype,p.prototype.constructor=p,Rr.prototype=gi(Js.prototype),Rr.prototype.constructor=Rr;function Rt(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=F,this.__views__=[]}function vd(){var t=new Rt(this.__wrapped__);return t.__actions__=cr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=cr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=cr(this.__views__),t}function md(){if(this.__filtered__){var t=new Rt(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function wd(){var t=this.__wrapped__.value(),n=this.__dir__,o=vt(t),c=n<0,l=o?t.length:0,d=Tg(0,l,this.__views__),w=d.start,_=d.end,A=_-w,M=c?_:w-1,U=this.__iteratees__,K=U.length,Q=0,rt=Fe(A,this.__takeCount__);if(!o||!c&&l==A&&rt==A)return Vu(t,this.__actions__);var at=[];t:for(;A--&&Q<rt;){M+=n;for(var Et=-1,ct=t[M];++Et<K;){var Pt=U[Et],Nt=Pt.iteratee,br=Pt.type,er=Nt(ct);if(br==S)ct=er;else if(!er){if(br==m)continue t;break t}}at[Q++]=ct}return at}Rt.prototype=gi(Js.prototype),Rt.prototype.constructor=Rt;function kn(t){var n=-1,o=t==null?0:t.length;for(this.clear();++n<o;){var c=t[n];this.set(c[0],c[1])}}function bd(){this.__data__=zi?zi(null):{},this.size=0}function _d(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Ed(t){var n=this.__data__;if(zi){var o=n[t];return o===b?r:o}return zt.call(n,t)?n[t]:r}function Id(t){var n=this.__data__;return zi?n[t]!==r:zt.call(n,t)}function Sd(t,n){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=zi&&n===r?b:n,this}kn.prototype.clear=bd,kn.prototype.delete=_d,kn.prototype.get=Ed,kn.prototype.has=Id,kn.prototype.set=Sd;function rn(t){var n=-1,o=t==null?0:t.length;for(this.clear();++n<o;){var c=t[n];this.set(c[0],c[1])}}function Pd(){this.__data__=[],this.size=0}function Od(t){var n=this.__data__,o=Qs(n,t);if(o<0)return!1;var c=n.length-1;return o==c?n.pop():Ks.call(n,o,1),--this.size,!0}function Rd(t){var n=this.__data__,o=Qs(n,t);return o<0?r:n[o][1]}function Ad(t){return Qs(this.__data__,t)>-1}function Nd(t,n){var o=this.__data__,c=Qs(o,t);return c<0?(++this.size,o.push([t,n])):o[c][1]=n,this}rn.prototype.clear=Pd,rn.prototype.delete=Od,rn.prototype.get=Rd,rn.prototype.has=Ad,rn.prototype.set=Nd;function nn(t){var n=-1,o=t==null?0:t.length;for(this.clear();++n<o;){var c=t[n];this.set(c[0],c[1])}}function Cd(){this.size=0,this.__data__={hash:new kn,map:new(Ui||rn),string:new kn}}function Td(t){var n=co(this,t).delete(t);return this.size-=n?1:0,n}function xd(t){return co(this,t).get(t)}function jd(t){return co(this,t).has(t)}function Ld(t,n){var o=co(this,t),c=o.size;return o.set(t,n),this.size+=o.size==c?0:1,this}nn.prototype.clear=Cd,nn.prototype.delete=Td,nn.prototype.get=xd,nn.prototype.has=jd,nn.prototype.set=Ld;function Hn(t){var n=-1,o=t==null?0:t.length;for(this.__data__=new nn;++n<o;)this.add(t[n])}function qd(t){return this.__data__.set(t,b),this}function Dd(t){return this.__data__.has(t)}Hn.prototype.add=Hn.prototype.push=qd,Hn.prototype.has=Dd;function Mr(t){var n=this.__data__=new rn(t);this.size=n.size}function Md(){this.__data__=new rn,this.size=0}function Ud(t){var n=this.__data__,o=n.delete(t);return this.size=n.size,o}function $d(t){return this.__data__.get(t)}function zd(t){return this.__data__.has(t)}function kd(t,n){var o=this.__data__;if(o instanceof rn){var c=o.__data__;if(!Ui||c.length<a-1)return c.push([t,n]),this.size=++o.size,this;o=this.__data__=new nn(c)}return o.set(t,n),this.size=o.size,this}Mr.prototype.clear=Md,Mr.prototype.delete=Ud,Mr.prototype.get=$d,Mr.prototype.has=zd,Mr.prototype.set=kd;function _u(t,n){var o=vt(t),c=!o&&Fn(t),l=!o&&!c&&Nn(t),d=!o&&!c&&!l&&wi(t),w=o||c||l||d,_=w?pa(t.length,Yp):[],A=_.length;for(var M in t)(n||zt.call(t,M))&&!(w&&(M=="length"||l&&(M=="offset"||M=="parent")||d&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||cn(M,A)))&&_.push(M);return _}function Eu(t){var n=t.length;return n?t[Ca(0,n-1)]:r}function Hd(t,n){return uo(cr(t),Kn(n,0,t.length))}function Kd(t){return uo(cr(t))}function ba(t,n,o){(o!==r&&!Ur(t[n],o)||o===r&&!(n in t))&&sn(t,n,o)}function Hi(t,n,o){var c=t[n];(!(zt.call(t,n)&&Ur(c,o))||o===r&&!(n in t))&&sn(t,n,o)}function Qs(t,n){for(var o=t.length;o--;)if(Ur(t[o][0],n))return o;return-1}function Vd(t,n,o,c){return Pn(t,function(l,d,w){n(c,l,o(l),w)}),c}function Iu(t,n){return t&&Jr(n,ze(n),t)}function Wd(t,n){return t&&Jr(n,hr(n),t)}function sn(t,n,o){n=="__proto__"&&Vs?Vs(t,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[n]=o}function _a(t,n){for(var o=-1,c=n.length,l=T(c),d=t==null;++o<c;)l[o]=d?r:ec(t,n[o]);return l}function Kn(t,n,o){return t===t&&(o!==r&&(t=t<=o?t:o),n!==r&&(t=t>=n?t:n)),t}function Ar(t,n,o,c,l,d){var w,_=n&R,A=n&x,M=n&$;if(o&&(w=l?o(t,c,l,d):o(t)),w!==r)return w;if(!ue(t))return t;var U=vt(t);if(U){if(w=jg(t),!_)return cr(t,w)}else{var K=Ge(t),Q=K==et||K==ft;if(Nn(t))return Fu(t,_);if(K==Ot||K==It||Q&&!l){if(w=A||Q?{}:fh(t),!_)return A?Eg(t,Wd(w,t)):_g(t,Iu(w,t))}else{if(!Ht[K])return l?t:{};w=Lg(t,K,_)}}d||(d=new Mr);var rt=d.get(t);if(rt)return rt;d.set(t,w),kh(t)?t.forEach(function(ct){w.add(Ar(ct,n,o,ct,t,d))}):$h(t)&&t.forEach(function(ct,Pt){w.set(Pt,Ar(ct,n,o,Pt,t,d))});var at=M?A?ka:za:A?hr:ze,Et=U?r:at(t);return Pr(Et||t,function(ct,Pt){Et&&(Pt=ct,ct=t[Pt]),Hi(w,Pt,Ar(ct,n,o,Pt,t,d))}),w}function Bd(t){var n=ze(t);return function(o){return Su(o,t,n)}}function Su(t,n,o){var c=o.length;if(t==null)return!c;for(t=Gt(t);c--;){var l=o[c],d=n[l],w=t[l];if(w===r&&!(l in t)||!d(w))return!1}return!0}function Pu(t,n,o){if(typeof t!="function")throw new Or(f);return Ji(function(){t.apply(r,o)},n)}function Ki(t,n,o,c){var l=-1,d=js,w=!0,_=t.length,A=[],M=n.length;if(!_)return A;o&&(n=ie(n,vr(o))),c?(d=aa,w=!1):n.length>=a&&(d=Di,w=!1,n=new Hn(n));t:for(;++l<_;){var U=t[l],K=o==null?U:o(U);if(U=c||U!==0?U:0,w&&K===K){for(var Q=M;Q--;)if(n[Q]===K)continue t;A.push(U)}else d(n,K,c)||A.push(U)}return A}var Pn=Zu(Gr),Ou=Zu(Ia,!0);function Fd(t,n){var o=!0;return Pn(t,function(c,l,d){return o=!!n(c,l,d),o}),o}function Ys(t,n,o){for(var c=-1,l=t.length;++c<l;){var d=t[c],w=n(d);if(w!=null&&(_===r?w===w&&!wr(w):o(w,_)))var _=w,A=d}return A}function Gd(t,n,o,c){var l=t.length;for(o=bt(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:bt(c),c<0&&(c+=l),c=o>c?0:Kh(c);o<c;)t[o++]=n;return t}function Ru(t,n){var o=[];return Pn(t,function(c,l,d){n(c,l,d)&&o.push(c)}),o}function We(t,n,o,c,l){var d=-1,w=t.length;for(o||(o=Dg),l||(l=[]);++d<w;){var _=t[d];n>0&&o(_)?n>1?We(_,n-1,o,c,l):En(l,_):c||(l[l.length]=_)}return l}var Ea=Xu(),Au=Xu(!0);function Gr(t,n){return t&&Ea(t,n,ze)}function Ia(t,n){return t&&Au(t,n,ze)}function Zs(t,n){return _n(n,function(o){return un(t[o])})}function Vn(t,n){n=Rn(n,t);for(var o=0,c=n.length;t!=null&&o<c;)t=t[Qr(n[o++])];return o&&o==c?t:r}function Nu(t,n,o){var c=n(t);return vt(t)?c:En(c,o(t))}function Xe(t){return t==null?t===r?ae:jt:zn&&zn in Gt(t)?Cg(t):Kg(t)}function Sa(t,n){return t>n}function Jd(t,n){return t!=null&&zt.call(t,n)}function Qd(t,n){return t!=null&&n in Gt(t)}function Yd(t,n,o){return t>=Fe(n,o)&&t<Me(n,o)}function Pa(t,n,o){for(var c=o?aa:js,l=t[0].length,d=t.length,w=d,_=T(d),A=1/0,M=[];w--;){var U=t[w];w&&n&&(U=ie(U,vr(n))),A=Fe(U.length,A),_[w]=!o&&(n||l>=120&&U.length>=120)?new Hn(w&&U):r}U=t[0];var K=-1,Q=_[0];t:for(;++K<l&&M.length<A;){var rt=U[K],at=n?n(rt):rt;if(rt=o||rt!==0?rt:0,!(Q?Di(Q,at):c(M,at,o))){for(w=d;--w;){var Et=_[w];if(!(Et?Di(Et,at):c(t[w],at,o)))continue t}Q&&Q.push(at),M.push(rt)}}return M}function Zd(t,n,o,c){return Gr(t,function(l,d,w){n(c,o(l),d,w)}),c}function Vi(t,n,o){n=Rn(n,t),t=yh(t,n);var c=t==null?t:t[Qr(Cr(n))];return c==null?r:$e(c,t,o)}function Cu(t){return ve(t)&&Xe(t)==It}function Xd(t){return ve(t)&&Xe(t)==xt}function tg(t){return ve(t)&&Xe(t)==N}function Wi(t,n,o,c,l){return t===n?!0:t==null||n==null||!ve(t)&&!ve(n)?t!==t&&n!==n:eg(t,n,o,c,Wi,l)}function eg(t,n,o,c,l,d){var w=vt(t),_=vt(n),A=w?Se:Ge(t),M=_?Se:Ge(n);A=A==It?Ot:A,M=M==It?Ot:M;var U=A==Ot,K=M==Ot,Q=A==M;if(Q&&Nn(t)){if(!Nn(n))return!1;w=!0,U=!1}if(Q&&!U)return d||(d=new Mr),w||wi(t)?uh(t,n,o,c,l,d):Ag(t,n,A,o,c,l,d);if(!(o&C)){var rt=U&&zt.call(t,"__wrapped__"),at=K&&zt.call(n,"__wrapped__");if(rt||at){var Et=rt?t.value():t,ct=at?n.value():n;return d||(d=new Mr),l(Et,ct,o,c,d)}}return Q?(d||(d=new Mr),Ng(t,n,o,c,l,d)):!1}function rg(t){return ve(t)&&Ge(t)==_t}function Oa(t,n,o,c){var l=o.length,d=l,w=!c;if(t==null)return!d;for(t=Gt(t);l--;){var _=o[l];if(w&&_[2]?_[1]!==t[_[0]]:!(_[0]in t))return!1}for(;++l<d;){_=o[l];var A=_[0],M=t[A],U=_[1];if(w&&_[2]){if(M===r&&!(A in t))return!1}else{var K=new Mr;if(c)var Q=c(M,U,A,t,n,K);if(!(Q===r?Wi(U,M,C|W,c,K):Q))return!1}}return!0}function Tu(t){if(!ue(t)||Ug(t))return!1;var n=un(t)?rd:Wo;return n.test(Bn(t))}function ng(t){return ve(t)&&Xe(t)==oe}function ig(t){return ve(t)&&Ge(t)==Mt}function sg(t){return ve(t)&&yo(t.length)&&!!Wt[Xe(t)]}function xu(t){return typeof t=="function"?t:t==null?lr:typeof t=="object"?vt(t)?qu(t[0],t[1]):Lu(t):tl(t)}function Ra(t){if(!Gi(t))return cd(t);var n=[];for(var o in Gt(t))zt.call(t,o)&&o!="constructor"&&n.push(o);return n}function og(t){if(!ue(t))return Hg(t);var n=Gi(t),o=[];for(var c in t)c=="constructor"&&(n||!zt.call(t,c))||o.push(c);return o}function Aa(t,n){return t<n}function ju(t,n){var o=-1,c=ur(t)?T(t.length):[];return Pn(t,function(l,d,w){c[++o]=n(l,d,w)}),c}function Lu(t){var n=Ka(t);return n.length==1&&n[0][2]?dh(n[0][0],n[0][1]):function(o){return o===t||Oa(o,t,n)}}function qu(t,n){return Wa(t)&&ph(n)?dh(Qr(t),n):function(o){var c=ec(o,t);return c===r&&c===n?rc(o,t):Wi(n,c,C|W)}}function Xs(t,n,o,c,l){t!==n&&Ea(n,function(d,w){if(l||(l=new Mr),ue(d))ag(t,n,w,o,Xs,c,l);else{var _=c?c(Fa(t,w),d,w+"",t,n,l):r;_===r&&(_=d),ba(t,w,_)}},hr)}function ag(t,n,o,c,l,d,w){var _=Fa(t,o),A=Fa(n,o),M=w.get(A);if(M){ba(t,o,M);return}var U=d?d(_,A,o+"",t,n,w):r,K=U===r;if(K){var Q=vt(A),rt=!Q&&Nn(A),at=!Q&&!rt&&wi(A);U=A,Q||rt||at?vt(_)?U=_:_e(_)?U=cr(_):rt?(K=!1,U=Fu(A,!0)):at?(K=!1,U=Gu(A,!0)):U=[]:Qi(A)||Fn(A)?(U=_,Fn(_)?U=Vh(_):(!ue(_)||un(_))&&(U=fh(A))):K=!1}K&&(w.set(A,U),l(U,A,c,d,w),w.delete(A)),ba(t,o,U)}function Du(t,n){var o=t.length;if(o)return n+=n<0?o:0,cn(n,o)?t[n]:r}function Mu(t,n,o){n.length?n=ie(n,function(d){return vt(d)?function(w){return Vn(w,d.length===1?d[0]:d)}:d}):n=[lr];var c=-1;n=ie(n,vr(ot()));var l=ju(t,function(d,w,_){var A=ie(n,function(M){return M(d)});return{criteria:A,index:++c,value:d}});return Lp(l,function(d,w){return bg(d,w,o)})}function cg(t,n){return Uu(t,n,function(o,c){return rc(t,c)})}function Uu(t,n,o){for(var c=-1,l=n.length,d={};++c<l;){var w=n[c],_=Vn(t,w);o(_,w)&&Bi(d,Rn(w,t),_)}return d}function ug(t){return function(n){return Vn(n,t)}}function Na(t,n,o,c){var l=c?jp:ci,d=-1,w=n.length,_=t;for(t===n&&(n=cr(n)),o&&(_=ie(t,vr(o)));++d<w;)for(var A=0,M=n[d],U=o?o(M):M;(A=l(_,U,A,c))>-1;)_!==t&&Ks.call(_,A,1),Ks.call(t,A,1);return t}function $u(t,n){for(var o=t?n.length:0,c=o-1;o--;){var l=n[o];if(o==c||l!==d){var d=l;cn(l)?Ks.call(t,l,1):ja(t,l)}}return t}function Ca(t,n){return t+Bs(wu()*(n-t+1))}function hg(t,n,o,c){for(var l=-1,d=Me(Ws((n-t)/(o||1)),0),w=T(d);d--;)w[c?d:++l]=t,t+=o;return w}function Ta(t,n){var o="";if(!t||n<1||n>B)return o;do n%2&&(o+=t),n=Bs(n/2),n&&(t+=t);while(n);return o}function St(t,n){return Ga(gh(t,n,lr),t+"")}function lg(t){return Eu(bi(t))}function fg(t,n){var o=bi(t);return uo(o,Kn(n,0,o.length))}function Bi(t,n,o,c){if(!ue(t))return t;n=Rn(n,t);for(var l=-1,d=n.length,w=d-1,_=t;_!=null&&++l<d;){var A=Qr(n[l]),M=o;if(A==="__proto__"||A==="constructor"||A==="prototype")return t;if(l!=w){var U=_[A];M=c?c(U,A,_):r,M===r&&(M=ue(U)?U:cn(n[l+1])?[]:{})}Hi(_,A,M),_=_[A]}return t}var zu=Fs?function(t,n){return Fs.set(t,n),t}:lr,pg=Vs?function(t,n){return Vs(t,"toString",{configurable:!0,enumerable:!1,value:ic(n),writable:!0})}:lr;function dg(t){return uo(bi(t))}function Nr(t,n,o){var c=-1,l=t.length;n<0&&(n=-n>l?0:l+n),o=o>l?l:o,o<0&&(o+=l),l=n>o?0:o-n>>>0,n>>>=0;for(var d=T(l);++c<l;)d[c]=t[c+n];return d}function gg(t,n){var o;return Pn(t,function(c,l,d){return o=n(c,l,d),!o}),!!o}function to(t,n,o){var c=0,l=t==null?c:t.length;if(typeof n=="number"&&n===n&&l<=Kt){for(;c<l;){var d=c+l>>>1,w=t[d];w!==null&&!wr(w)&&(o?w<=n:w<n)?c=d+1:l=d}return l}return xa(t,n,lr,o)}function xa(t,n,o,c){var l=0,d=t==null?0:t.length;if(d===0)return 0;n=o(n);for(var w=n!==n,_=n===null,A=wr(n),M=n===r;l<d;){var U=Bs((l+d)/2),K=o(t[U]),Q=K!==r,rt=K===null,at=K===K,Et=wr(K);if(w)var ct=c||at;else M?ct=at&&(c||Q):_?ct=at&&Q&&(c||!rt):A?ct=at&&Q&&!rt&&(c||!Et):rt||Et?ct=!1:ct=c?K<=n:K<n;ct?l=U+1:d=U}return Fe(d,Jt)}function ku(t,n){for(var o=-1,c=t.length,l=0,d=[];++o<c;){var w=t[o],_=n?n(w):w;if(!o||!Ur(_,A)){var A=_;d[l++]=w===0?0:w}}return d}function Hu(t){return typeof t=="number"?t:wr(t)?V:+t}function mr(t){if(typeof t=="string")return t;if(vt(t))return ie(t,mr)+"";if(wr(t))return bu?bu.call(t):"";var n=t+"";return n=="0"&&1/t==-dt?"-0":n}function On(t,n,o){var c=-1,l=js,d=t.length,w=!0,_=[],A=_;if(o)w=!1,l=aa;else if(d>=a){var M=n?null:Og(t);if(M)return qs(M);w=!1,l=Di,A=new Hn}else A=n?[]:_;t:for(;++c<d;){var U=t[c],K=n?n(U):U;if(U=o||U!==0?U:0,w&&K===K){for(var Q=A.length;Q--;)if(A[Q]===K)continue t;n&&A.push(K),_.push(U)}else l(A,K,o)||(A!==_&&A.push(K),_.push(U))}return _}function ja(t,n){return n=Rn(n,t),t=yh(t,n),t==null||delete t[Qr(Cr(n))]}function Ku(t,n,o,c){return Bi(t,n,o(Vn(t,n)),c)}function eo(t,n,o,c){for(var l=t.length,d=c?l:-1;(c?d--:++d<l)&&n(t[d],d,t););return o?Nr(t,c?0:d,c?d+1:l):Nr(t,c?d+1:0,c?l:d)}function Vu(t,n){var o=t;return o instanceof Rt&&(o=o.value()),ca(n,function(c,l){return l.func.apply(l.thisArg,En([c],l.args))},o)}function La(t,n,o){var c=t.length;if(c<2)return c?On(t[0]):[];for(var l=-1,d=T(c);++l<c;)for(var w=t[l],_=-1;++_<c;)_!=l&&(d[l]=Ki(d[l]||w,t[_],n,o));return On(We(d,1),n,o)}function Wu(t,n,o){for(var c=-1,l=t.length,d=n.length,w={};++c<l;){var _=c<d?n[c]:r;o(w,t[c],_)}return w}function qa(t){return _e(t)?t:[]}function Da(t){return typeof t=="function"?t:lr}function Rn(t,n){return vt(t)?t:Wa(t,n)?[t]:bh(Ut(t))}var yg=St;function An(t,n,o){var c=t.length;return o=o===r?c:o,!n&&o>=c?t:Nr(t,n,o)}var Bu=nd||function(t){return At.clearTimeout(t)};function Fu(t,n){if(n)return t.slice();var o=t.length,c=du?du(o):new t.constructor(o);return t.copy(c),c}function Ma(t){var n=new t.constructor(t.byteLength);return new ks(n).set(new ks(t)),n}function vg(t,n){var o=n?Ma(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.byteLength)}function mg(t){var n=new t.constructor(t.source,Ir.exec(t));return n.lastIndex=t.lastIndex,n}function wg(t){return ki?Gt(ki.call(t)):{}}function Gu(t,n){var o=n?Ma(t.buffer):t.buffer;return new t.constructor(o,t.byteOffset,t.length)}function Ju(t,n){if(t!==n){var o=t!==r,c=t===null,l=t===t,d=wr(t),w=n!==r,_=n===null,A=n===n,M=wr(n);if(!_&&!M&&!d&&t>n||d&&w&&A&&!_&&!M||c&&w&&A||!o&&A||!l)return 1;if(!c&&!d&&!M&&t<n||M&&o&&l&&!c&&!d||_&&o&&l||!w&&l||!A)return-1}return 0}function bg(t,n,o){for(var c=-1,l=t.criteria,d=n.criteria,w=l.length,_=o.length;++c<w;){var A=Ju(l[c],d[c]);if(A){if(c>=_)return A;var M=o[c];return A*(M=="desc"?-1:1)}}return t.index-n.index}function Qu(t,n,o,c){for(var l=-1,d=t.length,w=o.length,_=-1,A=n.length,M=Me(d-w,0),U=T(A+M),K=!c;++_<A;)U[_]=n[_];for(;++l<w;)(K||l<d)&&(U[o[l]]=t[l]);for(;M--;)U[_++]=t[l++];return U}function Yu(t,n,o,c){for(var l=-1,d=t.length,w=-1,_=o.length,A=-1,M=n.length,U=Me(d-_,0),K=T(U+M),Q=!c;++l<U;)K[l]=t[l];for(var rt=l;++A<M;)K[rt+A]=n[A];for(;++w<_;)(Q||l<d)&&(K[rt+o[w]]=t[l++]);return K}function cr(t,n){var o=-1,c=t.length;for(n||(n=T(c));++o<c;)n[o]=t[o];return n}function Jr(t,n,o,c){var l=!o;o||(o={});for(var d=-1,w=n.length;++d<w;){var _=n[d],A=c?c(o[_],t[_],_,o,t):r;A===r&&(A=t[_]),l?sn(o,_,A):Hi(o,_,A)}return o}function _g(t,n){return Jr(t,Va(t),n)}function Eg(t,n){return Jr(t,hh(t),n)}function ro(t,n){return function(o,c){var l=vt(o)?Rp:Vd,d=n?n():{};return l(o,t,ot(c,2),d)}}function yi(t){return St(function(n,o){var c=-1,l=o.length,d=l>1?o[l-1]:r,w=l>2?o[2]:r;for(d=t.length>3&&typeof d=="function"?(l--,d):r,w&&tr(o[0],o[1],w)&&(d=l<3?r:d,l=1),n=Gt(n);++c<l;){var _=o[c];_&&t(n,_,c,d)}return n})}function Zu(t,n){return function(o,c){if(o==null)return o;if(!ur(o))return t(o,c);for(var l=o.length,d=n?l:-1,w=Gt(o);(n?d--:++d<l)&&c(w[d],d,w)!==!1;);return o}}function Xu(t){return function(n,o,c){for(var l=-1,d=Gt(n),w=c(n),_=w.length;_--;){var A=w[t?_:++l];if(o(d[A],A,d)===!1)break}return n}}function Ig(t,n,o){var c=n&tt,l=Fi(t);function d(){var w=this&&this!==At&&this instanceof d?l:t;return w.apply(c?o:this,arguments)}return d}function th(t){return function(n){n=Ut(n);var o=ui(n)?Dr(n):r,c=o?o[0]:n.charAt(0),l=o?An(o,1).join(""):n.slice(1);return c[t]()+l}}function vi(t){return function(n){return ca(Zh(Yh(n).replace(Li,"")),t,"")}}function Fi(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var o=gi(t.prototype),c=t.apply(o,n);return ue(c)?c:o}}function Sg(t,n,o){var c=Fi(t);function l(){for(var d=arguments.length,w=T(d),_=d,A=mi(l);_--;)w[_]=arguments[_];var M=d<3&&w[0]!==A&&w[d-1]!==A?[]:In(w,A);if(d-=M.length,d<o)return sh(t,n,no,l.placeholder,r,w,M,r,r,o-d);var U=this&&this!==At&&this instanceof l?c:t;return $e(U,this,w)}return l}function eh(t){return function(n,o,c){var l=Gt(n);if(!ur(n)){var d=ot(o,3);n=ze(n),o=function(_){return d(l[_],_,l)}}var w=t(n,o,c);return w>-1?l[d?n[w]:w]:r}}function rh(t){return an(function(n){var o=n.length,c=o,l=Rr.prototype.thru;for(t&&n.reverse();c--;){var d=n[c];if(typeof d!="function")throw new Or(f);if(l&&!w&&ao(d)=="wrapper")var w=new Rr([],!0)}for(c=w?c:o;++c<o;){d=n[c];var _=ao(d),A=_=="wrapper"?Ha(d):r;A&&Ba(A[0])&&A[1]==(H|ut|lt|G)&&!A[4].length&&A[9]==1?w=w[ao(A[0])].apply(w,A[3]):w=d.length==1&&Ba(d)?w[_]():w.thru(d)}return function(){var M=arguments,U=M[0];if(w&&M.length==1&&vt(U))return w.plant(U).value();for(var K=0,Q=o?n[K].apply(this,M):U;++K<o;)Q=n[K].call(this,Q);return Q}})}function no(t,n,o,c,l,d,w,_,A,M){var U=n&H,K=n&tt,Q=n&yt,rt=n&(ut|ht),at=n&wt,Et=Q?r:Fi(t);function ct(){for(var Pt=arguments.length,Nt=T(Pt),br=Pt;br--;)Nt[br]=arguments[br];if(rt)var er=mi(ct),_r=Dp(Nt,er);if(c&&(Nt=Qu(Nt,c,l,rt)),d&&(Nt=Yu(Nt,d,w,rt)),Pt-=_r,rt&&Pt<M){var Ee=In(Nt,er);return sh(t,n,no,ct.placeholder,o,Nt,Ee,_,A,M-Pt)}var $r=K?o:this,ln=Q?$r[t]:t;return Pt=Nt.length,_?Nt=Vg(Nt,_):at&&Pt>1&&Nt.reverse(),U&&A<Pt&&(Nt.length=A),this&&this!==At&&this instanceof ct&&(ln=Et||Fi(ln)),ln.apply($r,Nt)}return ct}function nh(t,n){return function(o,c){return Zd(o,t,n(c),{})}}function io(t,n){return function(o,c){var l;if(o===r&&c===r)return n;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=mr(o),c=mr(c)):(o=Hu(o),c=Hu(c)),l=t(o,c)}return l}}function Ua(t){return an(function(n){return n=ie(n,vr(ot())),St(function(o){var c=this;return t(n,function(l){return $e(l,c,o)})})})}function so(t,n){n=n===r?" ":mr(n);var o=n.length;if(o<2)return o?Ta(n,t):n;var c=Ta(n,Ws(t/hi(n)));return ui(n)?An(Dr(c),0,t).join(""):c.slice(0,t)}function Pg(t,n,o,c){var l=n&tt,d=Fi(t);function w(){for(var _=-1,A=arguments.length,M=-1,U=c.length,K=T(U+A),Q=this&&this!==At&&this instanceof w?d:t;++M<U;)K[M]=c[M];for(;A--;)K[M++]=arguments[++_];return $e(Q,l?o:this,K)}return w}function ih(t){return function(n,o,c){return c&&typeof c!="number"&&tr(n,o,c)&&(o=c=r),n=hn(n),o===r?(o=n,n=0):o=hn(o),c=c===r?n<o?1:-1:hn(c),hg(n,o,c,t)}}function oo(t){return function(n,o){return typeof n=="string"&&typeof o=="string"||(n=Tr(n),o=Tr(o)),t(n,o)}}function sh(t,n,o,c,l,d,w,_,A,M){var U=n&ut,K=U?w:r,Q=U?r:w,rt=U?d:r,at=U?r:d;n|=U?lt:q,n&=~(U?q:lt),n&pt||(n&=~(tt|yt));var Et=[t,n,l,rt,K,at,Q,_,A,M],ct=o.apply(r,Et);return Ba(t)&&vh(ct,Et),ct.placeholder=c,mh(ct,t,n)}function $a(t){var n=De[t];return function(o,c){if(o=Tr(o),c=c==null?0:Fe(bt(c),292),c&&mu(o)){var l=(Ut(o)+"e").split("e"),d=n(l[0]+"e"+(+l[1]+c));return l=(Ut(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return n(o)}}var Og=pi&&1/qs(new pi([,-0]))[1]==dt?function(t){return new pi(t)}:ac;function oh(t){return function(n){var o=Ge(n);return o==_t?ga(n):o==Mt?Kp(n):qp(n,t(n))}}function on(t,n,o,c,l,d,w,_){var A=n&yt;if(!A&&typeof t!="function")throw new Or(f);var M=c?c.length:0;if(M||(n&=~(lt|q),c=l=r),w=w===r?w:Me(bt(w),0),_=_===r?_:bt(_),M-=l?l.length:0,n&q){var U=c,K=l;c=l=r}var Q=A?r:Ha(t),rt=[t,n,o,c,l,U,K,d,w,_];if(Q&&kg(rt,Q),t=rt[0],n=rt[1],o=rt[2],c=rt[3],l=rt[4],_=rt[9]=rt[9]===r?A?0:t.length:Me(rt[9]-M,0),!_&&n&(ut|ht)&&(n&=~(ut|ht)),!n||n==tt)var at=Ig(t,n,o);else n==ut||n==ht?at=Sg(t,n,_):(n==lt||n==(tt|lt))&&!l.length?at=Pg(t,n,o,c):at=no.apply(r,rt);var Et=Q?zu:vh;return mh(Et(at,rt),t,n)}function ah(t,n,o,c){return t===r||Ur(t,fi[o])&&!zt.call(c,o)?n:t}function ch(t,n,o,c,l,d){return ue(t)&&ue(n)&&(d.set(n,t),Xs(t,n,r,ch,d),d.delete(n)),t}function Rg(t){return Qi(t)?r:t}function uh(t,n,o,c,l,d){var w=o&C,_=t.length,A=n.length;if(_!=A&&!(w&&A>_))return!1;var M=d.get(t),U=d.get(n);if(M&&U)return M==n&&U==t;var K=-1,Q=!0,rt=o&W?new Hn:r;for(d.set(t,n),d.set(n,t);++K<_;){var at=t[K],Et=n[K];if(c)var ct=w?c(Et,at,K,n,t,d):c(at,Et,K,t,n,d);if(ct!==r){if(ct)continue;Q=!1;break}if(rt){if(!ua(n,function(Pt,Nt){if(!Di(rt,Nt)&&(at===Pt||l(at,Pt,o,c,d)))return rt.push(Nt)})){Q=!1;break}}else if(!(at===Et||l(at,Et,o,c,d))){Q=!1;break}}return d.delete(t),d.delete(n),Q}function Ag(t,n,o,c,l,d,w){switch(o){case Vt:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case xt:return!(t.byteLength!=n.byteLength||!d(new ks(t),new ks(n)));case j:case N:case Tt:return Ur(+t,+n);case I:return t.name==n.name&&t.message==n.message;case oe:case Yt:return t==n+"";case _t:var _=ga;case Mt:var A=c&C;if(_||(_=qs),t.size!=n.size&&!A)return!1;var M=w.get(t);if(M)return M==n;c|=W,w.set(t,n);var U=uh(_(t),_(n),c,l,d,w);return w.delete(t),U;case Zt:if(ki)return ki.call(t)==ki.call(n)}return!1}function Ng(t,n,o,c,l,d){var w=o&C,_=za(t),A=_.length,M=za(n),U=M.length;if(A!=U&&!w)return!1;for(var K=A;K--;){var Q=_[K];if(!(w?Q in n:zt.call(n,Q)))return!1}var rt=d.get(t),at=d.get(n);if(rt&&at)return rt==n&&at==t;var Et=!0;d.set(t,n),d.set(n,t);for(var ct=w;++K<A;){Q=_[K];var Pt=t[Q],Nt=n[Q];if(c)var br=w?c(Nt,Pt,Q,n,t,d):c(Pt,Nt,Q,t,n,d);if(!(br===r?Pt===Nt||l(Pt,Nt,o,c,d):br)){Et=!1;break}ct||(ct=Q=="constructor")}if(Et&&!ct){var er=t.constructor,_r=n.constructor;er!=_r&&"constructor"in t&&"constructor"in n&&!(typeof er=="function"&&er instanceof er&&typeof _r=="function"&&_r instanceof _r)&&(Et=!1)}return d.delete(t),d.delete(n),Et}function an(t){return Ga(gh(t,r,Sh),t+"")}function za(t){return Nu(t,ze,Va)}function ka(t){return Nu(t,hr,hh)}var Ha=Fs?function(t){return Fs.get(t)}:ac;function ao(t){for(var n=t.name+"",o=di[n],c=zt.call(di,n)?o.length:0;c--;){var l=o[c],d=l.func;if(d==null||d==t)return l.name}return n}function mi(t){var n=zt.call(p,"placeholder")?p:t;return n.placeholder}function ot(){var t=p.iteratee||sc;return t=t===sc?xu:t,arguments.length?t(arguments[0],arguments[1]):t}function co(t,n){var o=t.__data__;return Mg(n)?o[typeof n=="string"?"string":"hash"]:o.map}function Ka(t){for(var n=ze(t),o=n.length;o--;){var c=n[o],l=t[c];n[o]=[c,l,ph(l)]}return n}function Wn(t,n){var o=zp(t,n);return Tu(o)?o:r}function Cg(t){var n=zt.call(t,zn),o=t[zn];try{t[zn]=r;var c=!0}catch{}var l=$s.call(t);return c&&(n?t[zn]=o:delete t[zn]),l}var Va=va?function(t){return t==null?[]:(t=Gt(t),_n(va(t),function(n){return yu.call(t,n)}))}:cc,hh=va?function(t){for(var n=[];t;)En(n,Va(t)),t=Hs(t);return n}:cc,Ge=Xe;(ma&&Ge(new ma(new ArrayBuffer(1)))!=Vt||Ui&&Ge(new Ui)!=_t||wa&&Ge(wa.resolve())!=Pe||pi&&Ge(new pi)!=Mt||$i&&Ge(new $i)!=kt)&&(Ge=function(t){var n=Xe(t),o=n==Ot?t.constructor:r,c=o?Bn(o):"";if(c)switch(c){case fd:return Vt;case pd:return _t;case dd:return Pe;case gd:return Mt;case yd:return kt}return n});function Tg(t,n,o){for(var c=-1,l=o.length;++c<l;){var d=o[c],w=d.size;switch(d.type){case"drop":t+=w;break;case"dropRight":n-=w;break;case"take":n=Fe(n,t+w);break;case"takeRight":t=Me(t,n-w);break}}return{start:t,end:n}}function xg(t){var n=t.match(Qt);return n?n[1].split(Ce):[]}function lh(t,n,o){n=Rn(n,t);for(var c=-1,l=n.length,d=!1;++c<l;){var w=Qr(n[c]);if(!(d=t!=null&&o(t,w)))break;t=t[w]}return d||++c!=l?d:(l=t==null?0:t.length,!!l&&yo(l)&&cn(w,l)&&(vt(t)||Fn(t)))}function jg(t){var n=t.length,o=new t.constructor(n);return n&&typeof t[0]=="string"&&zt.call(t,"index")&&(o.index=t.index,o.input=t.input),o}function fh(t){return typeof t.constructor=="function"&&!Gi(t)?gi(Hs(t)):{}}function Lg(t,n,o){var c=t.constructor;switch(n){case xt:return Ma(t);case j:case N:return new c(+t);case Vt:return vg(t,o);case he:case $t:case Oe:case qe:case Ke:case Ve:case Ue:case Qe:case or:return Gu(t,o);case _t:return new c;case Tt:case Yt:return new c(t);case oe:return mg(t);case Mt:return new c;case Zt:return wg(t)}}function qg(t,n){var o=n.length;if(!o)return t;var c=o-1;return n[c]=(o>1?"& ":"")+n[c],n=n.join(o>2?", ":" "),t.replace(ye,`{
/* [wrapped with `+n+`] */
`)}function Dg(t){return vt(t)||Fn(t)||!!(vu&&t&&t[vu])}function cn(t,n){var o=typeof t;return n=n??B,!!n&&(o=="number"||o!="symbol"&&Fo.test(t))&&t>-1&&t%1==0&&t<n}function tr(t,n,o){if(!ue(o))return!1;var c=typeof n;return(c=="number"?ur(o)&&cn(n,o.length):c=="string"&&n in o)?Ur(o[n],t):!1}function Wa(t,n){if(vt(t))return!1;var o=typeof t;return o=="number"||o=="symbol"||o=="boolean"||t==null||wr(t)?!0:Re.test(t)||!ne.test(t)||n!=null&&t in Gt(n)}function Mg(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Ba(t){var n=ao(t),o=p[n];if(typeof o!="function"||!(n in Rt.prototype))return!1;if(t===o)return!0;var c=Ha(o);return!!c&&t===c[0]}function Ug(t){return!!pu&&pu in t}var $g=Ms?un:uc;function Gi(t){var n=t&&t.constructor,o=typeof n=="function"&&n.prototype||fi;return t===o}function ph(t){return t===t&&!ue(t)}function dh(t,n){return function(o){return o==null?!1:o[t]===n&&(n!==r||t in Gt(o))}}function zg(t){var n=po(t,function(c){return o.size===y&&o.clear(),c}),o=n.cache;return n}function kg(t,n){var o=t[1],c=n[1],l=o|c,d=l<(tt|yt|H),w=c==H&&o==ut||c==H&&o==G&&t[7].length<=n[8]||c==(H|G)&&n[7].length<=n[8]&&o==ut;if(!(d||w))return t;c&tt&&(t[2]=n[2],l|=o&tt?0:pt);var _=n[3];if(_){var A=t[3];t[3]=A?Qu(A,_,n[4]):_,t[4]=A?In(t[3],E):n[4]}return _=n[5],_&&(A=t[5],t[5]=A?Yu(A,_,n[6]):_,t[6]=A?In(t[5],E):n[6]),_=n[7],_&&(t[7]=_),c&H&&(t[8]=t[8]==null?n[8]:Fe(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=l,t}function Hg(t){var n=[];if(t!=null)for(var o in Gt(t))n.push(o);return n}function Kg(t){return $s.call(t)}function gh(t,n,o){return n=Me(n===r?t.length-1:n,0),function(){for(var c=arguments,l=-1,d=Me(c.length-n,0),w=T(d);++l<d;)w[l]=c[n+l];l=-1;for(var _=T(n+1);++l<n;)_[l]=c[l];return _[n]=o(w),$e(t,this,_)}}function yh(t,n){return n.length<2?t:Vn(t,Nr(n,0,-1))}function Vg(t,n){for(var o=t.length,c=Fe(n.length,o),l=cr(t);c--;){var d=n[c];t[c]=cn(d,o)?l[d]:r}return t}function Fa(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var vh=wh(zu),Ji=sd||function(t,n){return At.setTimeout(t,n)},Ga=wh(pg);function mh(t,n,o){var c=n+"";return Ga(t,qg(c,Wg(xg(c),o)))}function wh(t){var n=0,o=0;return function(){var c=ud(),l=Dt-(c-o);if(o=c,l>0){if(++n>=qt)return arguments[0]}else n=0;return t.apply(r,arguments)}}function uo(t,n){var o=-1,c=t.length,l=c-1;for(n=n===r?c:n;++o<n;){var d=Ca(o,l),w=t[d];t[d]=t[o],t[o]=w}return t.length=n,t}var bh=zg(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Ae,function(o,c,l,d){n.push(l?d.replace(ko,"$1"):c||o)}),n});function Qr(t){if(typeof t=="string"||wr(t))return t;var n=t+"";return n=="0"&&1/t==-dt?"-0":n}function Bn(t){if(t!=null){try{return Us.call(t)}catch{}try{return t+""}catch{}}return""}function Wg(t,n){return Pr(Vr,function(o){var c="_."+o[0];n&o[1]&&!js(t,c)&&t.push(c)}),t.sort()}function _h(t){if(t instanceof Rt)return t.clone();var n=new Rr(t.__wrapped__,t.__chain__);return n.__actions__=cr(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function Bg(t,n,o){(o?tr(t,n,o):n===r)?n=1:n=Me(bt(n),0);var c=t==null?0:t.length;if(!c||n<1)return[];for(var l=0,d=0,w=T(Ws(c/n));l<c;)w[d++]=Nr(t,l,l+=n);return w}function Fg(t){for(var n=-1,o=t==null?0:t.length,c=0,l=[];++n<o;){var d=t[n];d&&(l[c++]=d)}return l}function Gg(){var t=arguments.length;if(!t)return[];for(var n=T(t-1),o=arguments[0],c=t;c--;)n[c-1]=arguments[c];return En(vt(o)?cr(o):[o],We(n,1))}var Jg=St(function(t,n){return _e(t)?Ki(t,We(n,1,_e,!0)):[]}),Qg=St(function(t,n){var o=Cr(n);return _e(o)&&(o=r),_e(t)?Ki(t,We(n,1,_e,!0),ot(o,2)):[]}),Yg=St(function(t,n){var o=Cr(n);return _e(o)&&(o=r),_e(t)?Ki(t,We(n,1,_e,!0),r,o):[]});function Zg(t,n,o){var c=t==null?0:t.length;return c?(n=o||n===r?1:bt(n),Nr(t,n<0?0:n,c)):[]}function Xg(t,n,o){var c=t==null?0:t.length;return c?(n=o||n===r?1:bt(n),n=c-n,Nr(t,0,n<0?0:n)):[]}function ty(t,n){return t&&t.length?eo(t,ot(n,3),!0,!0):[]}function ey(t,n){return t&&t.length?eo(t,ot(n,3),!0):[]}function ry(t,n,o,c){var l=t==null?0:t.length;return l?(o&&typeof o!="number"&&tr(t,n,o)&&(o=0,c=l),Gd(t,n,o,c)):[]}function Eh(t,n,o){var c=t==null?0:t.length;if(!c)return-1;var l=o==null?0:bt(o);return l<0&&(l=Me(c+l,0)),Ls(t,ot(n,3),l)}function Ih(t,n,o){var c=t==null?0:t.length;if(!c)return-1;var l=c-1;return o!==r&&(l=bt(o),l=o<0?Me(c+l,0):Fe(l,c-1)),Ls(t,ot(n,3),l,!0)}function Sh(t){var n=t==null?0:t.length;return n?We(t,1):[]}function ny(t){var n=t==null?0:t.length;return n?We(t,dt):[]}function iy(t,n){var o=t==null?0:t.length;return o?(n=n===r?1:bt(n),We(t,n)):[]}function sy(t){for(var n=-1,o=t==null?0:t.length,c={};++n<o;){var l=t[n];c[l[0]]=l[1]}return c}function Ph(t){return t&&t.length?t[0]:r}function oy(t,n,o){var c=t==null?0:t.length;if(!c)return-1;var l=o==null?0:bt(o);return l<0&&(l=Me(c+l,0)),ci(t,n,l)}function ay(t){var n=t==null?0:t.length;return n?Nr(t,0,-1):[]}var cy=St(function(t){var n=ie(t,qa);return n.length&&n[0]===t[0]?Pa(n):[]}),uy=St(function(t){var n=Cr(t),o=ie(t,qa);return n===Cr(o)?n=r:o.pop(),o.length&&o[0]===t[0]?Pa(o,ot(n,2)):[]}),hy=St(function(t){var n=Cr(t),o=ie(t,qa);return n=typeof n=="function"?n:r,n&&o.pop(),o.length&&o[0]===t[0]?Pa(o,r,n):[]});function ly(t,n){return t==null?"":ad.call(t,n)}function Cr(t){var n=t==null?0:t.length;return n?t[n-1]:r}function fy(t,n,o){var c=t==null?0:t.length;if(!c)return-1;var l=c;return o!==r&&(l=bt(o),l=l<0?Me(c+l,0):Fe(l,c-1)),n===n?Wp(t,n,l):Ls(t,su,l,!0)}function py(t,n){return t&&t.length?Du(t,bt(n)):r}var dy=St(Oh);function Oh(t,n){return t&&t.length&&n&&n.length?Na(t,n):t}function gy(t,n,o){return t&&t.length&&n&&n.length?Na(t,n,ot(o,2)):t}function yy(t,n,o){return t&&t.length&&n&&n.length?Na(t,n,r,o):t}var vy=an(function(t,n){var o=t==null?0:t.length,c=_a(t,n);return $u(t,ie(n,function(l){return cn(l,o)?+l:l}).sort(Ju)),c});function my(t,n){var o=[];if(!(t&&t.length))return o;var c=-1,l=[],d=t.length;for(n=ot(n,3);++c<d;){var w=t[c];n(w,c,t)&&(o.push(w),l.push(c))}return $u(t,l),o}function Ja(t){return t==null?t:ld.call(t)}function wy(t,n,o){var c=t==null?0:t.length;return c?(o&&typeof o!="number"&&tr(t,n,o)?(n=0,o=c):(n=n==null?0:bt(n),o=o===r?c:bt(o)),Nr(t,n,o)):[]}function by(t,n){return to(t,n)}function _y(t,n,o){return xa(t,n,ot(o,2))}function Ey(t,n){var o=t==null?0:t.length;if(o){var c=to(t,n);if(c<o&&Ur(t[c],n))return c}return-1}function Iy(t,n){return to(t,n,!0)}function Sy(t,n,o){return xa(t,n,ot(o,2),!0)}function Py(t,n){var o=t==null?0:t.length;if(o){var c=to(t,n,!0)-1;if(Ur(t[c],n))return c}return-1}function Oy(t){return t&&t.length?ku(t):[]}function Ry(t,n){return t&&t.length?ku(t,ot(n,2)):[]}function Ay(t){var n=t==null?0:t.length;return n?Nr(t,1,n):[]}function Ny(t,n,o){return t&&t.length?(n=o||n===r?1:bt(n),Nr(t,0,n<0?0:n)):[]}function Cy(t,n,o){var c=t==null?0:t.length;return c?(n=o||n===r?1:bt(n),n=c-n,Nr(t,n<0?0:n,c)):[]}function Ty(t,n){return t&&t.length?eo(t,ot(n,3),!1,!0):[]}function xy(t,n){return t&&t.length?eo(t,ot(n,3)):[]}var jy=St(function(t){return On(We(t,1,_e,!0))}),Ly=St(function(t){var n=Cr(t);return _e(n)&&(n=r),On(We(t,1,_e,!0),ot(n,2))}),qy=St(function(t){var n=Cr(t);return n=typeof n=="function"?n:r,On(We(t,1,_e,!0),r,n)});function Dy(t){return t&&t.length?On(t):[]}function My(t,n){return t&&t.length?On(t,ot(n,2)):[]}function Uy(t,n){return n=typeof n=="function"?n:r,t&&t.length?On(t,r,n):[]}function Qa(t){if(!(t&&t.length))return[];var n=0;return t=_n(t,function(o){if(_e(o))return n=Me(o.length,n),!0}),pa(n,function(o){return ie(t,ha(o))})}function Rh(t,n){if(!(t&&t.length))return[];var o=Qa(t);return n==null?o:ie(o,function(c){return $e(n,r,c)})}var $y=St(function(t,n){return _e(t)?Ki(t,n):[]}),zy=St(function(t){return La(_n(t,_e))}),ky=St(function(t){var n=Cr(t);return _e(n)&&(n=r),La(_n(t,_e),ot(n,2))}),Hy=St(function(t){var n=Cr(t);return n=typeof n=="function"?n:r,La(_n(t,_e),r,n)}),Ky=St(Qa);function Vy(t,n){return Wu(t||[],n||[],Hi)}function Wy(t,n){return Wu(t||[],n||[],Bi)}var By=St(function(t){var n=t.length,o=n>1?t[n-1]:r;return o=typeof o=="function"?(t.pop(),o):r,Rh(t,o)});function Ah(t){var n=p(t);return n.__chain__=!0,n}function Fy(t,n){return n(t),t}function ho(t,n){return n(t)}var Gy=an(function(t){var n=t.length,o=n?t[0]:0,c=this.__wrapped__,l=function(d){return _a(d,t)};return n>1||this.__actions__.length||!(c instanceof Rt)||!cn(o)?this.thru(l):(c=c.slice(o,+o+(n?1:0)),c.__actions__.push({func:ho,args:[l],thisArg:r}),new Rr(c,this.__chain__).thru(function(d){return n&&!d.length&&d.push(r),d}))});function Jy(){return Ah(this)}function Qy(){return new Rr(this.value(),this.__chain__)}function Yy(){this.__values__===r&&(this.__values__=Hh(this.value()));var t=this.__index__>=this.__values__.length,n=t?r:this.__values__[this.__index__++];return{done:t,value:n}}function Zy(){return this}function Xy(t){for(var n,o=this;o instanceof Js;){var c=_h(o);c.__index__=0,c.__values__=r,n?l.__wrapped__=c:n=c;var l=c;o=o.__wrapped__}return l.__wrapped__=t,n}function tv(){var t=this.__wrapped__;if(t instanceof Rt){var n=t;return this.__actions__.length&&(n=new Rt(this)),n=n.reverse(),n.__actions__.push({func:ho,args:[Ja],thisArg:r}),new Rr(n,this.__chain__)}return this.thru(Ja)}function ev(){return Vu(this.__wrapped__,this.__actions__)}var rv=ro(function(t,n,o){zt.call(t,o)?++t[o]:sn(t,o,1)});function nv(t,n,o){var c=vt(t)?nu:Fd;return o&&tr(t,n,o)&&(n=r),c(t,ot(n,3))}function iv(t,n){var o=vt(t)?_n:Ru;return o(t,ot(n,3))}var sv=eh(Eh),ov=eh(Ih);function av(t,n){return We(lo(t,n),1)}function cv(t,n){return We(lo(t,n),dt)}function uv(t,n,o){return o=o===r?1:bt(o),We(lo(t,n),o)}function Nh(t,n){var o=vt(t)?Pr:Pn;return o(t,ot(n,3))}function Ch(t,n){var o=vt(t)?Ap:Ou;return o(t,ot(n,3))}var hv=ro(function(t,n,o){zt.call(t,o)?t[o].push(n):sn(t,o,[n])});function lv(t,n,o,c){t=ur(t)?t:bi(t),o=o&&!c?bt(o):0;var l=t.length;return o<0&&(o=Me(l+o,0)),vo(t)?o<=l&&t.indexOf(n,o)>-1:!!l&&ci(t,n,o)>-1}var fv=St(function(t,n,o){var c=-1,l=typeof n=="function",d=ur(t)?T(t.length):[];return Pn(t,function(w){d[++c]=l?$e(n,w,o):Vi(w,n,o)}),d}),pv=ro(function(t,n,o){sn(t,o,n)});function lo(t,n){var o=vt(t)?ie:ju;return o(t,ot(n,3))}function dv(t,n,o,c){return t==null?[]:(vt(n)||(n=n==null?[]:[n]),o=c?r:o,vt(o)||(o=o==null?[]:[o]),Mu(t,n,o))}var gv=ro(function(t,n,o){t[o?0:1].push(n)},function(){return[[],[]]});function yv(t,n,o){var c=vt(t)?ca:au,l=arguments.length<3;return c(t,ot(n,4),o,l,Pn)}function vv(t,n,o){var c=vt(t)?Np:au,l=arguments.length<3;return c(t,ot(n,4),o,l,Ou)}function mv(t,n){var o=vt(t)?_n:Ru;return o(t,go(ot(n,3)))}function wv(t){var n=vt(t)?Eu:lg;return n(t)}function bv(t,n,o){(o?tr(t,n,o):n===r)?n=1:n=bt(n);var c=vt(t)?Hd:fg;return c(t,n)}function _v(t){var n=vt(t)?Kd:dg;return n(t)}function Ev(t){if(t==null)return 0;if(ur(t))return vo(t)?hi(t):t.length;var n=Ge(t);return n==_t||n==Mt?t.size:Ra(t).length}function Iv(t,n,o){var c=vt(t)?ua:gg;return o&&tr(t,n,o)&&(n=r),c(t,ot(n,3))}var Sv=St(function(t,n){if(t==null)return[];var o=n.length;return o>1&&tr(t,n[0],n[1])?n=[]:o>2&&tr(n[0],n[1],n[2])&&(n=[n[0]]),Mu(t,We(n,1),[])}),fo=id||function(){return At.Date.now()};function Pv(t,n){if(typeof n!="function")throw new Or(f);return t=bt(t),function(){if(--t<1)return n.apply(this,arguments)}}function Th(t,n,o){return n=o?r:n,n=t&&n==null?t.length:n,on(t,H,r,r,r,r,n)}function xh(t,n){var o;if(typeof n!="function")throw new Or(f);return t=bt(t),function(){return--t>0&&(o=n.apply(this,arguments)),t<=1&&(n=r),o}}var Ya=St(function(t,n,o){var c=tt;if(o.length){var l=In(o,mi(Ya));c|=lt}return on(t,c,n,o,l)}),jh=St(function(t,n,o){var c=tt|yt;if(o.length){var l=In(o,mi(jh));c|=lt}return on(n,c,t,o,l)});function Lh(t,n,o){n=o?r:n;var c=on(t,ut,r,r,r,r,r,n);return c.placeholder=Lh.placeholder,c}function qh(t,n,o){n=o?r:n;var c=on(t,ht,r,r,r,r,r,n);return c.placeholder=qh.placeholder,c}function Dh(t,n,o){var c,l,d,w,_,A,M=0,U=!1,K=!1,Q=!0;if(typeof t!="function")throw new Or(f);n=Tr(n)||0,ue(o)&&(U=!!o.leading,K="maxWait"in o,d=K?Me(Tr(o.maxWait)||0,n):d,Q="trailing"in o?!!o.trailing:Q);function rt(Ee){var $r=c,ln=l;return c=l=r,M=Ee,w=t.apply(ln,$r),w}function at(Ee){return M=Ee,_=Ji(Pt,n),U?rt(Ee):w}function Et(Ee){var $r=Ee-A,ln=Ee-M,el=n-$r;return K?Fe(el,d-ln):el}function ct(Ee){var $r=Ee-A,ln=Ee-M;return A===r||$r>=n||$r<0||K&&ln>=d}function Pt(){var Ee=fo();if(ct(Ee))return Nt(Ee);_=Ji(Pt,Et(Ee))}function Nt(Ee){return _=r,Q&&c?rt(Ee):(c=l=r,w)}function br(){_!==r&&Bu(_),M=0,c=A=l=_=r}function er(){return _===r?w:Nt(fo())}function _r(){var Ee=fo(),$r=ct(Ee);if(c=arguments,l=this,A=Ee,$r){if(_===r)return at(A);if(K)return Bu(_),_=Ji(Pt,n),rt(A)}return _===r&&(_=Ji(Pt,n)),w}return _r.cancel=br,_r.flush=er,_r}var Ov=St(function(t,n){return Pu(t,1,n)}),Rv=St(function(t,n,o){return Pu(t,Tr(n)||0,o)});function Av(t){return on(t,wt)}function po(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new Or(f);var o=function(){var c=arguments,l=n?n.apply(this,c):c[0],d=o.cache;if(d.has(l))return d.get(l);var w=t.apply(this,c);return o.cache=d.set(l,w)||d,w};return o.cache=new(po.Cache||nn),o}po.Cache=nn;function go(t){if(typeof t!="function")throw new Or(f);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Nv(t){return xh(2,t)}var Cv=yg(function(t,n){n=n.length==1&&vt(n[0])?ie(n[0],vr(ot())):ie(We(n,1),vr(ot()));var o=n.length;return St(function(c){for(var l=-1,d=Fe(c.length,o);++l<d;)c[l]=n[l].call(this,c[l]);return $e(t,this,c)})}),Za=St(function(t,n){var o=In(n,mi(Za));return on(t,lt,r,n,o)}),Mh=St(function(t,n){var o=In(n,mi(Mh));return on(t,q,r,n,o)}),Tv=an(function(t,n){return on(t,G,r,r,r,n)});function xv(t,n){if(typeof t!="function")throw new Or(f);return n=n===r?n:bt(n),St(t,n)}function jv(t,n){if(typeof t!="function")throw new Or(f);return n=n==null?0:Me(bt(n),0),St(function(o){var c=o[n],l=An(o,0,n);return c&&En(l,c),$e(t,this,l)})}function Lv(t,n,o){var c=!0,l=!0;if(typeof t!="function")throw new Or(f);return ue(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Dh(t,n,{leading:c,maxWait:n,trailing:l})}function qv(t){return Th(t,1)}function Dv(t,n){return Za(Da(n),t)}function Mv(){if(!arguments.length)return[];var t=arguments[0];return vt(t)?t:[t]}function Uv(t){return Ar(t,$)}function $v(t,n){return n=typeof n=="function"?n:r,Ar(t,$,n)}function zv(t){return Ar(t,R|$)}function kv(t,n){return n=typeof n=="function"?n:r,Ar(t,R|$,n)}function Hv(t,n){return n==null||Su(t,n,ze(n))}function Ur(t,n){return t===n||t!==t&&n!==n}var Kv=oo(Sa),Vv=oo(function(t,n){return t>=n}),Fn=Cu(function(){return arguments}())?Cu:function(t){return ve(t)&&zt.call(t,"callee")&&!yu.call(t,"callee")},vt=T.isArray,Wv=Ze?vr(Ze):Xd;function ur(t){return t!=null&&yo(t.length)&&!un(t)}function _e(t){return ve(t)&&ur(t)}function Bv(t){return t===!0||t===!1||ve(t)&&Xe(t)==j}var Nn=od||uc,Fv=qr?vr(qr):tg;function Gv(t){return ve(t)&&t.nodeType===1&&!Qi(t)}function Jv(t){if(t==null)return!0;if(ur(t)&&(vt(t)||typeof t=="string"||typeof t.splice=="function"||Nn(t)||wi(t)||Fn(t)))return!t.length;var n=Ge(t);if(n==_t||n==Mt)return!t.size;if(Gi(t))return!Ra(t).length;for(var o in t)if(zt.call(t,o))return!1;return!0}function Qv(t,n){return Wi(t,n)}function Yv(t,n,o){o=typeof o=="function"?o:r;var c=o?o(t,n):r;return c===r?Wi(t,n,r,o):!!c}function Xa(t){if(!ve(t))return!1;var n=Xe(t);return n==I||n==u||typeof t.message=="string"&&typeof t.name=="string"&&!Qi(t)}function Zv(t){return typeof t=="number"&&mu(t)}function un(t){if(!ue(t))return!1;var n=Xe(t);return n==et||n==ft||n==L||n==me}function Uh(t){return typeof t=="number"&&t==bt(t)}function yo(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=B}function ue(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function ve(t){return t!=null&&typeof t=="object"}var $h=Sr?vr(Sr):rg;function Xv(t,n){return t===n||Oa(t,n,Ka(n))}function tm(t,n,o){return o=typeof o=="function"?o:r,Oa(t,n,Ka(n),o)}function em(t){return zh(t)&&t!=+t}function rm(t){if($g(t))throw new gt(h);return Tu(t)}function nm(t){return t===null}function im(t){return t==null}function zh(t){return typeof t=="number"||ve(t)&&Xe(t)==Tt}function Qi(t){if(!ve(t)||Xe(t)!=Ot)return!1;var n=Hs(t);if(n===null)return!0;var o=zt.call(n,"constructor")&&n.constructor;return typeof o=="function"&&o instanceof o&&Us.call(o)==td}var tc=Fr?vr(Fr):ng;function sm(t){return Uh(t)&&t>=-B&&t<=B}var kh=qi?vr(qi):ig;function vo(t){return typeof t=="string"||!vt(t)&&ve(t)&&Xe(t)==Yt}function wr(t){return typeof t=="symbol"||ve(t)&&Xe(t)==Zt}var wi=$n?vr($n):sg;function om(t){return t===r}function am(t){return ve(t)&&Ge(t)==kt}function cm(t){return ve(t)&&Xe(t)==Xt}var um=oo(Aa),hm=oo(function(t,n){return t<=n});function Hh(t){if(!t)return[];if(ur(t))return vo(t)?Dr(t):cr(t);if(Mi&&t[Mi])return Hp(t[Mi]());var n=Ge(t),o=n==_t?ga:n==Mt?qs:bi;return o(t)}function hn(t){if(!t)return t===0?t:0;if(t=Tr(t),t===dt||t===-dt){var n=t<0?-1:1;return n*k}return t===t?t:0}function bt(t){var n=hn(t),o=n%1;return n===n?o?n-o:n:0}function Kh(t){return t?Kn(bt(t),0,F):0}function Tr(t){if(typeof t=="number")return t;if(wr(t))return V;if(ue(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=ue(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=cu(t);var o=Vo.test(t);return o||Bo.test(t)?mt(t.slice(2),o?2:8):Ko.test(t)?V:+t}function Vh(t){return Jr(t,hr(t))}function lm(t){return t?Kn(bt(t),-B,B):t===0?t:0}function Ut(t){return t==null?"":mr(t)}var fm=yi(function(t,n){if(Gi(n)||ur(n)){Jr(n,ze(n),t);return}for(var o in n)zt.call(n,o)&&Hi(t,o,n[o])}),Wh=yi(function(t,n){Jr(n,hr(n),t)}),mo=yi(function(t,n,o,c){Jr(n,hr(n),t,c)}),pm=yi(function(t,n,o,c){Jr(n,ze(n),t,c)}),dm=an(_a);function gm(t,n){var o=gi(t);return n==null?o:Iu(o,n)}var ym=St(function(t,n){t=Gt(t);var o=-1,c=n.length,l=c>2?n[2]:r;for(l&&tr(n[0],n[1],l)&&(c=1);++o<c;)for(var d=n[o],w=hr(d),_=-1,A=w.length;++_<A;){var M=w[_],U=t[M];(U===r||Ur(U,fi[M])&&!zt.call(t,M))&&(t[M]=d[M])}return t}),vm=St(function(t){return t.push(r,ch),$e(Bh,r,t)});function mm(t,n){return iu(t,ot(n,3),Gr)}function wm(t,n){return iu(t,ot(n,3),Ia)}function bm(t,n){return t==null?t:Ea(t,ot(n,3),hr)}function _m(t,n){return t==null?t:Au(t,ot(n,3),hr)}function Em(t,n){return t&&Gr(t,ot(n,3))}function Im(t,n){return t&&Ia(t,ot(n,3))}function Sm(t){return t==null?[]:Zs(t,ze(t))}function Pm(t){return t==null?[]:Zs(t,hr(t))}function ec(t,n,o){var c=t==null?r:Vn(t,n);return c===r?o:c}function Om(t,n){return t!=null&&lh(t,n,Jd)}function rc(t,n){return t!=null&&lh(t,n,Qd)}var Rm=nh(function(t,n,o){n!=null&&typeof n.toString!="function"&&(n=$s.call(n)),t[n]=o},ic(lr)),Am=nh(function(t,n,o){n!=null&&typeof n.toString!="function"&&(n=$s.call(n)),zt.call(t,n)?t[n].push(o):t[n]=[o]},ot),Nm=St(Vi);function ze(t){return ur(t)?_u(t):Ra(t)}function hr(t){return ur(t)?_u(t,!0):og(t)}function Cm(t,n){var o={};return n=ot(n,3),Gr(t,function(c,l,d){sn(o,n(c,l,d),c)}),o}function Tm(t,n){var o={};return n=ot(n,3),Gr(t,function(c,l,d){sn(o,l,n(c,l,d))}),o}var xm=yi(function(t,n,o){Xs(t,n,o)}),Bh=yi(function(t,n,o,c){Xs(t,n,o,c)}),jm=an(function(t,n){var o={};if(t==null)return o;var c=!1;n=ie(n,function(d){return d=Rn(d,t),c||(c=d.length>1),d}),Jr(t,ka(t),o),c&&(o=Ar(o,R|x|$,Rg));for(var l=n.length;l--;)ja(o,n[l]);return o});function Lm(t,n){return Fh(t,go(ot(n)))}var qm=an(function(t,n){return t==null?{}:cg(t,n)});function Fh(t,n){if(t==null)return{};var o=ie(ka(t),function(c){return[c]});return n=ot(n),Uu(t,o,function(c,l){return n(c,l[0])})}function Dm(t,n,o){n=Rn(n,t);var c=-1,l=n.length;for(l||(l=1,t=r);++c<l;){var d=t==null?r:t[Qr(n[c])];d===r&&(c=l,d=o),t=un(d)?d.call(t):d}return t}function Mm(t,n,o){return t==null?t:Bi(t,n,o)}function Um(t,n,o,c){return c=typeof c=="function"?c:r,t==null?t:Bi(t,n,o,c)}var Gh=oh(ze),Jh=oh(hr);function $m(t,n,o){var c=vt(t),l=c||Nn(t)||wi(t);if(n=ot(n,4),o==null){var d=t&&t.constructor;l?o=c?new d:[]:ue(t)?o=un(d)?gi(Hs(t)):{}:o={}}return(l?Pr:Gr)(t,function(w,_,A){return n(o,w,_,A)}),o}function zm(t,n){return t==null?!0:ja(t,n)}function km(t,n,o){return t==null?t:Ku(t,n,Da(o))}function Hm(t,n,o,c){return c=typeof c=="function"?c:r,t==null?t:Ku(t,n,Da(o),c)}function bi(t){return t==null?[]:da(t,ze(t))}function Km(t){return t==null?[]:da(t,hr(t))}function Vm(t,n,o){return o===r&&(o=n,n=r),o!==r&&(o=Tr(o),o=o===o?o:0),n!==r&&(n=Tr(n),n=n===n?n:0),Kn(Tr(t),n,o)}function Wm(t,n,o){return n=hn(n),o===r?(o=n,n=0):o=hn(o),t=Tr(t),Yd(t,n,o)}function Bm(t,n,o){if(o&&typeof o!="boolean"&&tr(t,n,o)&&(n=o=r),o===r&&(typeof n=="boolean"?(o=n,n=r):typeof t=="boolean"&&(o=t,t=r)),t===r&&n===r?(t=0,n=1):(t=hn(t),n===r?(n=t,t=0):n=hn(n)),t>n){var c=t;t=n,n=c}if(o||t%1||n%1){var l=wu();return Fe(t+l*(n-t+Bt("1e-"+((l+"").length-1))),n)}return Ca(t,n)}var Fm=vi(function(t,n,o){return n=n.toLowerCase(),t+(o?Qh(n):n)});function Qh(t){return nc(Ut(t).toLowerCase())}function Yh(t){return t=Ut(t),t&&t.replace(tn,Mp).replace(sa,"")}function Gm(t,n,o){t=Ut(t),n=mr(n);var c=t.length;o=o===r?c:Kn(bt(o),0,c);var l=o;return o-=n.length,o>=0&&t.slice(o,l)==n}function Jm(t){return t=Ut(t),t&&re.test(t)?t.replace(Ln,Up):t}function Qm(t){return t=Ut(t),t&&Ne.test(t)?t.replace(de,"\\$&"):t}var Ym=vi(function(t,n,o){return t+(o?"-":"")+n.toLowerCase()}),Zm=vi(function(t,n,o){return t+(o?" ":"")+n.toLowerCase()}),Xm=th("toLowerCase");function tw(t,n,o){t=Ut(t),n=bt(n);var c=n?hi(t):0;if(!n||c>=n)return t;var l=(n-c)/2;return so(Bs(l),o)+t+so(Ws(l),o)}function ew(t,n,o){t=Ut(t),n=bt(n);var c=n?hi(t):0;return n&&c<n?t+so(n-c,o):t}function rw(t,n,o){t=Ut(t),n=bt(n);var c=n?hi(t):0;return n&&c<n?so(n-c,o)+t:t}function nw(t,n,o){return o||n==null?n=0:n&&(n=+n),hd(Ut(t).replace(ge,""),n||0)}function iw(t,n,o){return(o?tr(t,n,o):n===r)?n=1:n=bt(n),Ta(Ut(t),n)}function sw(){var t=arguments,n=Ut(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var ow=vi(function(t,n,o){return t+(o?"_":"")+n.toLowerCase()});function aw(t,n,o){return o&&typeof o!="number"&&tr(t,n,o)&&(n=o=r),o=o===r?F:o>>>0,o?(t=Ut(t),t&&(typeof n=="string"||n!=null&&!tc(n))&&(n=mr(n),!n&&ui(t))?An(Dr(t),0,o):t.split(n,o)):[]}var cw=vi(function(t,n,o){return t+(o?" ":"")+nc(n)});function uw(t,n,o){return t=Ut(t),o=o==null?0:Kn(bt(o),0,t.length),n=mr(n),t.slice(o,o+n.length)==n}function hw(t,n,o){var c=p.templateSettings;o&&tr(t,n,o)&&(n=r),t=Ut(t),n=mo({},n,c,ah);var l=mo({},n.imports,c.imports,ah),d=ze(l),w=da(l,d),_,A,M=0,U=n.interpolate||ei,K="__p += '",Q=ya((n.escape||ei).source+"|"+U.source+"|"+(U===ce?Ho:ei).source+"|"+(n.evaluate||ei).source+"|$","g"),rt="//# sourceURL="+(zt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++oa+"]")+`
`;t.replace(Q,function(ct,Pt,Nt,br,er,_r){return Nt||(Nt=br),K+=t.slice(M,_r).replace(Go,$p),Pt&&(_=!0,K+=`' +
__e(`+Pt+`) +
'`),er&&(A=!0,K+=`';
`+er+`;
__p += '`),Nt&&(K+=`' +
((__t = (`+Nt+`)) == null ? '' : __t) +
'`),M=_r+ct.length,ct}),K+=`';
`;var at=zt.call(n,"variable")&&n.variable;if(!at)K=`with (obj) {
`+K+`
}
`;else if(zo.test(at))throw new gt(g);K=(A?K.replace(Wr,""):K).replace(Ye,"$1").replace(Xr,"$1;"),K="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+K+`return __p
}`;var Et=Xh(function(){return Lt(d,rt+"return "+K).apply(r,w)});if(Et.source=K,Xa(Et))throw Et;return Et}function lw(t){return Ut(t).toLowerCase()}function fw(t){return Ut(t).toUpperCase()}function pw(t,n,o){if(t=Ut(t),t&&(o||n===r))return cu(t);if(!t||!(n=mr(n)))return t;var c=Dr(t),l=Dr(n),d=uu(c,l),w=hu(c,l)+1;return An(c,d,w).join("")}function dw(t,n,o){if(t=Ut(t),t&&(o||n===r))return t.slice(0,fu(t)+1);if(!t||!(n=mr(n)))return t;var c=Dr(t),l=hu(c,Dr(n))+1;return An(c,0,l).join("")}function gw(t,n,o){if(t=Ut(t),t&&(o||n===r))return t.replace(ge,"");if(!t||!(n=mr(n)))return t;var c=Dr(t),l=uu(c,Dr(n));return An(c,l).join("")}function yw(t,n){var o=nt,c=st;if(ue(n)){var l="separator"in n?n.separator:l;o="length"in n?bt(n.length):o,c="omission"in n?mr(n.omission):c}t=Ut(t);var d=t.length;if(ui(t)){var w=Dr(t);d=w.length}if(o>=d)return t;var _=o-hi(c);if(_<1)return c;var A=w?An(w,0,_).join(""):t.slice(0,_);if(l===r)return A+c;if(w&&(_+=A.length-_),tc(l)){if(t.slice(_).search(l)){var M,U=A;for(l.global||(l=ya(l.source,Ut(Ir.exec(l))+"g")),l.lastIndex=0;M=l.exec(U);)var K=M.index;A=A.slice(0,K===r?_:K)}}else if(t.indexOf(mr(l),_)!=_){var Q=A.lastIndexOf(l);Q>-1&&(A=A.slice(0,Q))}return A+c}function vw(t){return t=Ut(t),t&&le.test(t)?t.replace(wn,Bp):t}var mw=vi(function(t,n,o){return t+(o?" ":"")+n.toUpperCase()}),nc=th("toUpperCase");function Zh(t,n,o){return t=Ut(t),n=o?r:n,n===r?kp(t)?Jp(t):xp(t):t.match(n)||[]}var Xh=St(function(t,n){try{return $e(t,r,n)}catch(o){return Xa(o)?o:new gt(o)}}),ww=an(function(t,n){return Pr(n,function(o){o=Qr(o),sn(t,o,Ya(t[o],t))}),t});function bw(t){var n=t==null?0:t.length,o=ot();return t=n?ie(t,function(c){if(typeof c[1]!="function")throw new Or(f);return[o(c[0]),c[1]]}):[],St(function(c){for(var l=-1;++l<n;){var d=t[l];if($e(d[0],this,c))return $e(d[1],this,c)}})}function _w(t){return Bd(Ar(t,R))}function ic(t){return function(){return t}}function Ew(t,n){return t==null||t!==t?n:t}var Iw=rh(),Sw=rh(!0);function lr(t){return t}function sc(t){return xu(typeof t=="function"?t:Ar(t,R))}function Pw(t){return Lu(Ar(t,R))}function Ow(t,n){return qu(t,Ar(n,R))}var Rw=St(function(t,n){return function(o){return Vi(o,t,n)}}),Aw=St(function(t,n){return function(o){return Vi(t,o,n)}});function oc(t,n,o){var c=ze(n),l=Zs(n,c);o==null&&!(ue(n)&&(l.length||!c.length))&&(o=n,n=t,t=this,l=Zs(n,ze(n)));var d=!(ue(o)&&"chain"in o)||!!o.chain,w=un(t);return Pr(l,function(_){var A=n[_];t[_]=A,w&&(t.prototype[_]=function(){var M=this.__chain__;if(d||M){var U=t(this.__wrapped__),K=U.__actions__=cr(this.__actions__);return K.push({func:A,args:arguments,thisArg:t}),U.__chain__=M,U}return A.apply(t,En([this.value()],arguments))})}),t}function Nw(){return At._===this&&(At._=ed),this}function ac(){}function Cw(t){return t=bt(t),St(function(n){return Du(n,t)})}var Tw=Ua(ie),xw=Ua(nu),jw=Ua(ua);function tl(t){return Wa(t)?ha(Qr(t)):ug(t)}function Lw(t){return function(n){return t==null?r:Vn(t,n)}}var qw=ih(),Dw=ih(!0);function cc(){return[]}function uc(){return!1}function Mw(){return{}}function Uw(){return""}function $w(){return!0}function zw(t,n){if(t=bt(t),t<1||t>B)return[];var o=F,c=Fe(t,F);n=ot(n),t-=F;for(var l=pa(c,n);++o<t;)n(o);return l}function kw(t){return vt(t)?ie(t,Qr):wr(t)?[t]:cr(bh(Ut(t)))}function Hw(t){var n=++Xp;return Ut(t)+n}var Kw=io(function(t,n){return t+n},0),Vw=$a("ceil"),Ww=io(function(t,n){return t/n},1),Bw=$a("floor");function Fw(t){return t&&t.length?Ys(t,lr,Sa):r}function Gw(t,n){return t&&t.length?Ys(t,ot(n,2),Sa):r}function Jw(t){return ou(t,lr)}function Qw(t,n){return ou(t,ot(n,2))}function Yw(t){return t&&t.length?Ys(t,lr,Aa):r}function Zw(t,n){return t&&t.length?Ys(t,ot(n,2),Aa):r}var Xw=io(function(t,n){return t*n},1),tb=$a("round"),eb=io(function(t,n){return t-n},0);function rb(t){return t&&t.length?fa(t,lr):0}function nb(t,n){return t&&t.length?fa(t,ot(n,2)):0}return p.after=Pv,p.ary=Th,p.assign=fm,p.assignIn=Wh,p.assignInWith=mo,p.assignWith=pm,p.at=dm,p.before=xh,p.bind=Ya,p.bindAll=ww,p.bindKey=jh,p.castArray=Mv,p.chain=Ah,p.chunk=Bg,p.compact=Fg,p.concat=Gg,p.cond=bw,p.conforms=_w,p.constant=ic,p.countBy=rv,p.create=gm,p.curry=Lh,p.curryRight=qh,p.debounce=Dh,p.defaults=ym,p.defaultsDeep=vm,p.defer=Ov,p.delay=Rv,p.difference=Jg,p.differenceBy=Qg,p.differenceWith=Yg,p.drop=Zg,p.dropRight=Xg,p.dropRightWhile=ty,p.dropWhile=ey,p.fill=ry,p.filter=iv,p.flatMap=av,p.flatMapDeep=cv,p.flatMapDepth=uv,p.flatten=Sh,p.flattenDeep=ny,p.flattenDepth=iy,p.flip=Av,p.flow=Iw,p.flowRight=Sw,p.fromPairs=sy,p.functions=Sm,p.functionsIn=Pm,p.groupBy=hv,p.initial=ay,p.intersection=cy,p.intersectionBy=uy,p.intersectionWith=hy,p.invert=Rm,p.invertBy=Am,p.invokeMap=fv,p.iteratee=sc,p.keyBy=pv,p.keys=ze,p.keysIn=hr,p.map=lo,p.mapKeys=Cm,p.mapValues=Tm,p.matches=Pw,p.matchesProperty=Ow,p.memoize=po,p.merge=xm,p.mergeWith=Bh,p.method=Rw,p.methodOf=Aw,p.mixin=oc,p.negate=go,p.nthArg=Cw,p.omit=jm,p.omitBy=Lm,p.once=Nv,p.orderBy=dv,p.over=Tw,p.overArgs=Cv,p.overEvery=xw,p.overSome=jw,p.partial=Za,p.partialRight=Mh,p.partition=gv,p.pick=qm,p.pickBy=Fh,p.property=tl,p.propertyOf=Lw,p.pull=dy,p.pullAll=Oh,p.pullAllBy=gy,p.pullAllWith=yy,p.pullAt=vy,p.range=qw,p.rangeRight=Dw,p.rearg=Tv,p.reject=mv,p.remove=my,p.rest=xv,p.reverse=Ja,p.sampleSize=bv,p.set=Mm,p.setWith=Um,p.shuffle=_v,p.slice=wy,p.sortBy=Sv,p.sortedUniq=Oy,p.sortedUniqBy=Ry,p.split=aw,p.spread=jv,p.tail=Ay,p.take=Ny,p.takeRight=Cy,p.takeRightWhile=Ty,p.takeWhile=xy,p.tap=Fy,p.throttle=Lv,p.thru=ho,p.toArray=Hh,p.toPairs=Gh,p.toPairsIn=Jh,p.toPath=kw,p.toPlainObject=Vh,p.transform=$m,p.unary=qv,p.union=jy,p.unionBy=Ly,p.unionWith=qy,p.uniq=Dy,p.uniqBy=My,p.uniqWith=Uy,p.unset=zm,p.unzip=Qa,p.unzipWith=Rh,p.update=km,p.updateWith=Hm,p.values=bi,p.valuesIn=Km,p.without=$y,p.words=Zh,p.wrap=Dv,p.xor=zy,p.xorBy=ky,p.xorWith=Hy,p.zip=Ky,p.zipObject=Vy,p.zipObjectDeep=Wy,p.zipWith=By,p.entries=Gh,p.entriesIn=Jh,p.extend=Wh,p.extendWith=mo,oc(p,p),p.add=Kw,p.attempt=Xh,p.camelCase=Fm,p.capitalize=Qh,p.ceil=Vw,p.clamp=Vm,p.clone=Uv,p.cloneDeep=zv,p.cloneDeepWith=kv,p.cloneWith=$v,p.conformsTo=Hv,p.deburr=Yh,p.defaultTo=Ew,p.divide=Ww,p.endsWith=Gm,p.eq=Ur,p.escape=Jm,p.escapeRegExp=Qm,p.every=nv,p.find=sv,p.findIndex=Eh,p.findKey=mm,p.findLast=ov,p.findLastIndex=Ih,p.findLastKey=wm,p.floor=Bw,p.forEach=Nh,p.forEachRight=Ch,p.forIn=bm,p.forInRight=_m,p.forOwn=Em,p.forOwnRight=Im,p.get=ec,p.gt=Kv,p.gte=Vv,p.has=Om,p.hasIn=rc,p.head=Ph,p.identity=lr,p.includes=lv,p.indexOf=oy,p.inRange=Wm,p.invoke=Nm,p.isArguments=Fn,p.isArray=vt,p.isArrayBuffer=Wv,p.isArrayLike=ur,p.isArrayLikeObject=_e,p.isBoolean=Bv,p.isBuffer=Nn,p.isDate=Fv,p.isElement=Gv,p.isEmpty=Jv,p.isEqual=Qv,p.isEqualWith=Yv,p.isError=Xa,p.isFinite=Zv,p.isFunction=un,p.isInteger=Uh,p.isLength=yo,p.isMap=$h,p.isMatch=Xv,p.isMatchWith=tm,p.isNaN=em,p.isNative=rm,p.isNil=im,p.isNull=nm,p.isNumber=zh,p.isObject=ue,p.isObjectLike=ve,p.isPlainObject=Qi,p.isRegExp=tc,p.isSafeInteger=sm,p.isSet=kh,p.isString=vo,p.isSymbol=wr,p.isTypedArray=wi,p.isUndefined=om,p.isWeakMap=am,p.isWeakSet=cm,p.join=ly,p.kebabCase=Ym,p.last=Cr,p.lastIndexOf=fy,p.lowerCase=Zm,p.lowerFirst=Xm,p.lt=um,p.lte=hm,p.max=Fw,p.maxBy=Gw,p.mean=Jw,p.meanBy=Qw,p.min=Yw,p.minBy=Zw,p.stubArray=cc,p.stubFalse=uc,p.stubObject=Mw,p.stubString=Uw,p.stubTrue=$w,p.multiply=Xw,p.nth=py,p.noConflict=Nw,p.noop=ac,p.now=fo,p.pad=tw,p.padEnd=ew,p.padStart=rw,p.parseInt=nw,p.random=Bm,p.reduce=yv,p.reduceRight=vv,p.repeat=iw,p.replace=sw,p.result=Dm,p.round=tb,p.runInContext=P,p.sample=wv,p.size=Ev,p.snakeCase=ow,p.some=Iv,p.sortedIndex=by,p.sortedIndexBy=_y,p.sortedIndexOf=Ey,p.sortedLastIndex=Iy,p.sortedLastIndexBy=Sy,p.sortedLastIndexOf=Py,p.startCase=cw,p.startsWith=uw,p.subtract=eb,p.sum=rb,p.sumBy=nb,p.template=hw,p.times=zw,p.toFinite=hn,p.toInteger=bt,p.toLength=Kh,p.toLower=lw,p.toNumber=Tr,p.toSafeInteger=lm,p.toString=Ut,p.toUpper=fw,p.trim=pw,p.trimEnd=dw,p.trimStart=gw,p.truncate=yw,p.unescape=vw,p.uniqueId=Hw,p.upperCase=mw,p.upperFirst=nc,p.each=Nh,p.eachRight=Ch,p.first=Ph,oc(p,function(){var t={};return Gr(p,function(n,o){zt.call(p.prototype,o)||(t[o]=n)}),t}(),{chain:!1}),p.VERSION=s,Pr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){p[t].placeholder=p}),Pr(["drop","take"],function(t,n){Rt.prototype[t]=function(o){o=o===r?1:Me(bt(o),0);var c=this.__filtered__&&!n?new Rt(this):this.clone();return c.__filtered__?c.__takeCount__=Fe(o,c.__takeCount__):c.__views__.push({size:Fe(o,F),type:t+(c.__dir__<0?"Right":"")}),c},Rt.prototype[t+"Right"]=function(o){return this.reverse()[t](o).reverse()}}),Pr(["filter","map","takeWhile"],function(t,n){var o=n+1,c=o==m||o==Y;Rt.prototype[t]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ot(l,3),type:o}),d.__filtered__=d.__filtered__||c,d}}),Pr(["head","last"],function(t,n){var o="take"+(n?"Right":"");Rt.prototype[t]=function(){return this[o](1).value()[0]}}),Pr(["initial","tail"],function(t,n){var o="drop"+(n?"":"Right");Rt.prototype[t]=function(){return this.__filtered__?new Rt(this):this[o](1)}}),Rt.prototype.compact=function(){return this.filter(lr)},Rt.prototype.find=function(t){return this.filter(t).head()},Rt.prototype.findLast=function(t){return this.reverse().find(t)},Rt.prototype.invokeMap=St(function(t,n){return typeof t=="function"?new Rt(this):this.map(function(o){return Vi(o,t,n)})}),Rt.prototype.reject=function(t){return this.filter(go(ot(t)))},Rt.prototype.slice=function(t,n){t=bt(t);var o=this;return o.__filtered__&&(t>0||n<0)?new Rt(o):(t<0?o=o.takeRight(-t):t&&(o=o.drop(t)),n!==r&&(n=bt(n),o=n<0?o.dropRight(-n):o.take(n-t)),o)},Rt.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Rt.prototype.toArray=function(){return this.take(F)},Gr(Rt.prototype,function(t,n){var o=/^(?:filter|find|map|reject)|While$/.test(n),c=/^(?:head|last)$/.test(n),l=p[c?"take"+(n=="last"?"Right":""):n],d=c||/^find/.test(n);l&&(p.prototype[n]=function(){var w=this.__wrapped__,_=c?[1]:arguments,A=w instanceof Rt,M=_[0],U=A||vt(w),K=function(Pt){var Nt=l.apply(p,En([Pt],_));return c&&Q?Nt[0]:Nt};U&&o&&typeof M=="function"&&M.length!=1&&(A=U=!1);var Q=this.__chain__,rt=!!this.__actions__.length,at=d&&!Q,Et=A&&!rt;if(!d&&U){w=Et?w:new Rt(this);var ct=t.apply(w,_);return ct.__actions__.push({func:ho,args:[K],thisArg:r}),new Rr(ct,Q)}return at&&Et?t.apply(this,_):(ct=this.thru(K),at?c?ct.value()[0]:ct.value():ct)})}),Pr(["pop","push","shift","sort","splice","unshift"],function(t){var n=Ds[t],o=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",c=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return n.apply(vt(d)?d:[],l)}return this[o](function(w){return n.apply(vt(w)?w:[],l)})}}),Gr(Rt.prototype,function(t,n){var o=p[n];if(o){var c=o.name+"";zt.call(di,c)||(di[c]=[]),di[c].push({name:n,func:o})}}),di[no(r,yt).name]=[{name:"wrapper",func:r}],Rt.prototype.clone=vd,Rt.prototype.reverse=md,Rt.prototype.value=wd,p.prototype.at=Gy,p.prototype.chain=Jy,p.prototype.commit=Qy,p.prototype.next=Yy,p.prototype.plant=Xy,p.prototype.reverse=tv,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=ev,p.prototype.first=p.prototype.head,Mi&&(p.prototype[Mi]=Zy),p},li=Qp();be?((be.exports=li)._=li,Ft._=li):At._=li}).call(ns)})(Dc,Dc.exports);var A5=Object.defineProperty,N5=Object.defineProperties,C5=Object.getOwnPropertyDescriptors,mf=Object.getOwnPropertySymbols,T5=Object.prototype.hasOwnProperty,x5=Object.prototype.propertyIsEnumerable,wf=(i,e,r)=>e in i?A5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,Io=(i,e)=>{for(var r in e||(e={}))T5.call(e,r)&&wf(i,r,e[r]);if(mf)for(var r of mf(e))x5.call(e,r)&&wf(i,r,e[r]);return i},j5=(i,e)=>N5(i,C5(e));function xn(i,e,r){var s;const a=Mb(i);return((s=e.rpcMap)==null?void 0:s[a.reference])||`${R5}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function ti(i){return i.includes(":")?i.split(":")[1]:i}function Pp(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function L5(i,e){const r=Object.keys(e.namespaces).filter(a=>a.includes(i));if(!r.length)return[];const s=[];return r.forEach(a=>{const h=e.namespaces[a].accounts;s.push(...h)}),s}function q5(i={},e={}){const r=bf(i),s=bf(e);return Dc.exports.merge(r,s)}function bf(i){var e,r,s,a;const h={};if(!Pi(i))return h;for(const[f,g]of Object.entries(i)){const b=Wc(f)?[f]:g.chains,y=g.methods||[],E=g.events||[],R=g.rpcMap||{},x=is(f);h[x]=j5(Io(Io({},h[x]),g),{chains:lc(b,(e=h[x])==null?void 0:e.chains),methods:lc(y,(r=h[x])==null?void 0:r.methods),events:lc(E,(s=h[x])==null?void 0:s.events),rpcMap:Io(Io({},R),(a=h[x])==null?void 0:a.rpcMap)})}return h}function D5(i){return i.includes(":")?i.split(":")[2]:i}function M5(i){const e={};for(const[r,s]of Object.entries(i)){const a=s.methods||[],h=s.events||[],f=s.accounts||[],g=Wc(r)?[r]:s.chains?s.chains:Pp(s.accounts);e[r]={chains:g,methods:a,events:h,accounts:f}}return e}function Ec(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):i.includes(":")?Number(i.split(":")[1]):Number(i)}const Op={},se=i=>Op[i],Ic=(i,e)=>{Op[i]=e};class U5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=ti(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class $5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const s=r||xn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(ti(r));e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,s;let a=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class z5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=ti(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class k5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=ti(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class H5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=ti(r);e[a]=this.createHttpProvider(a,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class K5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=ti(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class V5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;const a=ti(r);e[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new vn(new jn(s,se("disableProviderPing")))}}class W5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=se("events"),this.client=se("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const s=r||xn(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(mn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var s;e[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const s=this.createHttpProvider(e,r);s&&(this.httpProviders[e]=s)}createHttpProvider(e,r){const s=r||xn(e,this.namespace);return typeof s>"u"?void 0:new vn(new jn(s,se("disableProviderPing")))}}var B5=Object.defineProperty,F5=Object.defineProperties,G5=Object.getOwnPropertyDescriptors,_f=Object.getOwnPropertySymbols,J5=Object.prototype.hasOwnProperty,Q5=Object.prototype.propertyIsEnumerable,Ef=(i,e,r)=>e in i?B5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,So=(i,e)=>{for(var r in e||(e={}))J5.call(e,r)&&Ef(i,r,e[r]);if(_f)for(var r of _f(e))Q5.call(e,r)&&Ef(i,r,e[r]);return i},Sc=(i,e)=>F5(i,G5(e));class eu{constructor(e){this.events=new $c,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Ct.pino(Ct.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||yf})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new eu(e);return await r.initialize(),r}async request(e,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:So({},e),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(e,r,s){this.request(e,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ie("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=M5(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Ip)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[s,a]=this.validateChain(e);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Zr(r)){for(const s of r)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await b5.init({logger:this.providerOpts.logger||yf,relayUrl:this.providerOpts.relayUrl||S5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>is(r)))];Ic("client",this.client),Ic("events",this.events),Ic("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const s=L5(r,this.session),a=Pp(s),h=q5(this.namespaces,this.optionalNamespaces),f=Sc(So({},h[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new $5({namespace:f});break;case"solana":this.rpcProviders[r]=new z5({namespace:f});break;case"cosmos":this.rpcProviders[r]=new k5({namespace:f});break;case"polkadot":this.rpcProviders[r]=new U5({namespace:f});break;case"cip34":this.rpcProviders[r]=new H5({namespace:f});break;case"elrond":this.rpcProviders[r]=new K5({namespace:f});break;case"multiversx":this.rpcProviders[r]=new V5({namespace:f});break;case"near":this.rpcProviders[r]=new W5({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Zr(a)&&this.events.emit("accountsChanged",a.map(D5))}else if(s.name==="chainChanged"){const a=r.chainId,h=r.event.data,f=is(a),g=Ec(a)!==Ec(h)?`${f}:${Ec(h)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var s;const{namespaces:a}=r,h=(s=this.client)==null?void 0:s.session.get(e);this.session=Sc(So({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Sc(So({},Ie("USER_DISCONNECTED")),{data:e.topic}))}),this.on(mn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=e;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(e){const[r,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>is(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=is(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){var s;if(!this.namespaces)return;const[a,h]=this.validateChain(e);r||this.getProvider(a).setDefaultChain(h),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${vf}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${vf}/${e}`)}}const Y5=eu,Z5="wc",X5="ethereum_provider",tS=`${Z5}@2:${X5}:`,eS="https://rpc.walletconnect.com/v1/",Mc=["eth_sendTransaction","personal_sign"],rS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Uc=["chainChanged","accountsChanged"],nS=["chainChanged","accountsChanged","message","disconnect","connect"];var iS=Object.defineProperty,sS=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,aS=Object.prototype.hasOwnProperty,cS=Object.prototype.propertyIsEnumerable,Sf=(i,e,r)=>e in i?iS(i,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[e]=r,os=(i,e)=>{for(var r in e||(e={}))aS.call(e,r)&&Sf(i,r,e[r]);if(If)for(var r of If(e))cS.call(e,r)&&Sf(i,r,e[r]);return i},Pf=(i,e)=>sS(i,oS(e));function Lo(i){return Number(i[0].split(":")[1])}function Pc(i){return`0x${i.toString(16)}`}function uS(i){const{chains:e,optionalChains:r,methods:s,optionalMethods:a,events:h,optionalEvents:f,rpcMap:g}=i;if(!Zr(e))throw new Error("Invalid chains");const b={chains:e,methods:s||Mc,events:h||Uc,rpcMap:os({},e.length?{[Lo(e)]:g[Lo(e)]}:{})},y=h==null?void 0:h.filter($=>!Uc.includes($)),E=s==null?void 0:s.filter($=>!Mc.includes($));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(E!=null&&E.length))return{required:e.length?b:void 0};const R=(y==null?void 0:y.length)&&(E==null?void 0:E.length)||!r,x={chains:[...new Set(R?b.chains.concat(r||[]):r)],methods:[...new Set(b.methods.concat(a!=null&&a.length?a:rS))],events:[...new Set(b.events.concat(f!=null&&f.length?f:nS))],rpcMap:g};return{required:e.length?b:void 0,optional:r.length?x:void 0}}class ru{constructor(){this.events=new jr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=tS,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new ru;return await r.initialize(e),r}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,r){this.signer.sendAsync(e,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:s}=uS(this.rpc);try{const a=await new Promise(async(f,g)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Pf(os({namespaces:os({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const h=Ub(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:Pc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Pc(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Pf(os({},Ie("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Pc(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,s,a]=e.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,s;const a=(r=e==null?void 0:e.chains)!=null?r:[],h=(s=e==null?void 0:e.optionalChains)!=null?s:[],f=a.concat(h);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(e==null?void 0:e.methods)||Mc:[],b=a.length?(e==null?void 0:e.events)||Uc:[],y=(e==null?void 0:e.optionalMethods)||[],E=(e==null?void 0:e.optionalEvents)||[],R=(e==null?void 0:e.rpcMap)||this.buildRpcMap(f,e.projectId),x=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map($=>this.formatChainId($)),optionalChains:h.map($=>this.formatChainId($)),methods:g,events:b,optionalMethods:y,optionalEvents:E,rpcMap:R,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:x,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const s={};return e.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?Lo(this.rpc.chains):Lo(this.rpc.optionalChains),this.signer=await Y5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await ib(()=>import("./index-VX7OL20Q-RAfhopwO.js"),__vite__mapDeps([0,1,2,3])).then(a=>a.i);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(os({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:s,rpcMap:a}=e;r&&Zr(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),s&&Zr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(e,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${eS}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const pS=ru;export{pS as EthereumProvider,nS as OPTIONAL_EVENTS,rS as OPTIONAL_METHODS,Uc as REQUIRED_EVENTS,Mc as REQUIRED_METHODS,ru as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-VX7OL20Q-RAfhopwO.js","assets/index-4Y4c3ejC.js","assets/vendor-aecOC4Ab.js","assets/index-KZQ6x1uu.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}